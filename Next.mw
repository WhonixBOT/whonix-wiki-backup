{{Header}}
{{#seo:
|description=Documentation for the NEXT Whonix version! ONLY for developers! No guarantee it really makes into the next Whonix version.
}}

= Warning =
'''Documentation for the NEXT Whonix version! ONLY for developers! No guarantee it really makes into the next Whonix version.'''

= Qubes =
== Torified dom0 Updates ==
Go to {{Code2|Qubes VM Manager -> System -> Global Settings}}. See the {{Code2|UpdateVM}} setting. Choose your desired Whonix-Gateway ProxyVM from the list. For example: sys-whonix.

<pre>
Qubes VM Manager -> System -> Global Settings -> UpdateVM -> sys-whonix
</pre>

<ref>
implement dom0 -> right click -> VM settings / easy way to configure updatevm setting:<br />
https://github.com/QubesOS/qubes-issues/issues/1165
</ref> <ref>
Or by cli:
<pre>
qubes-prefs --get updatevm
</pre>

<pre>
qubes-prefs --set updatevm sys-whonix
</pre>
</ref>

= ricochet =
'''Unfinished!''' See also: <br />
https://github.com/ricochet-im/ricochet/issues/30

Doesn't work yet, because Control Port Filter Proxy<ref>[[Dev/CPFP]]</ref> does not support wildcards yet. Might also not work for other reasons yet.

Security implications not researched yet.

On Whonix-Gateway, Control Port Filter Proxy needs some adjustments.

Create a file {{Code|/etc/cpfpy.d/50_ricochet}}.

<pre>
kdesudo kwrite /etc/cpfpy.d/50_torsion
</pre>

Add the following content.

<pre>
## Keep existing contents of variable CONTROL_PORT_FILTER_WHITELIST
## and extend it with control port commands required by torsion as per:
## "Documentation request for Whonix setup"
## https://github.com/special/torsion/issues/30
CONTROL_PORT_FILTER_WHITELIST=GETINFO status/circuit-established,SETCONF HiddenServiceDir,SETCONF HiddenServicePort,SETEVENTS STATUS_CLIENT
</pre>

Restart Control Port Filter Proxy.

<pre>
sudo service control-port-filter-python restart
</pre>

= onionshare =
'''Unfinished!''' Work in progress! See also:

* https://www.whonix.org/forum/index.php/topic,316.0.html
* https://github.com/micahflee/onionshare/issues/27
* Most likely we need to wait until Tor 0.2.7 gets stable: https://github.com/micahflee/onionshare/issues/178

Security implications not researched yet.

On Whonix-Gateway, Control Port Filter Proxy<ref>[[Dev/CPFP]]</ref> needs some adjustments.

Create a file {{Code|/etc/cpfpy.d/50_onionshare}}.

<pre>
kdesudo kwrite /etc/cpfpy.d/50_onionshare
</pre>

Add the following content.

<pre>
## Keep existing contents of variable CONTROL_PORT_FILTER_WHITELIST
## and extend it with control port commands required by onionshare as per:
## https://github.com/micahflee/onionshare/blob/master/onionshare/onionshare.py
CONTROL_PORT_FILTER_WHITELIST=PROTOCOLINFO 1,SETCONF HiddenServiceDir,SETCONF HiddenServicePort
</pre>

Restart Control Port Filter Proxy.

<pre>
sudo service control-port-filter-python restart
</pre>

= whonixcheck SSL Certificate Pinning =
== How ==
'''UNFINISHED!''' See: https://github.com/Whonix/Whonix/issues/24

'''Advanced users only!'''

In Whonix-Gateway and Whonix-Workstation.

You need {{Code2|torbrowser-launcher}} installed. <ref>Because torbrowser-launcher ships The Tor Projects SSL certificate</ref> Currently only available from {{Code2|wheezy-backports}}.

To enable this on a by case base, use the --pin-tpo-cert command line option. Example.

<pre>
whonixcheck --pin-tpo-cert
</pre>

Or to permanently enable this.

Create a file {{Code2|/etc/whonix.d/50_user.conf}}.

<pre>
sudo nano /etc/whonix.d/50_user.conf
</pre>

Add.

<pre>
PIN_TPO_CERT="true"
</pre>

= Footnotes =
<references/>

{{Footer}}

[[Category:Documentation]]
