{{#seo:
|description=NAT Traversal using Tor without anonymity
}}
{{Header}}

{{mbox
| image   = [[File:Ambox_warning_pn.svg.png|40px]]
| text       = 
Not anonymous!
}}

'''UNFINISHED!'''

= Server Side =
{{Open_/etc/tor/torrc}}

Add.

{{CodeSelect|code=
HiddenServiceNonAnonymousMode 1
HiddenServiceSingleHopMode 1
SocksPort 0

HiddenServiceDir /var/lib/tor/hidden_service/
HiddenServicePort 22 127.0.0.1:22
HiddenServicePort 5900 127.0.0.1:5900
## syntax:
## HiddenServiceAuthorizeClient auth-type client-name,client-name,â€¦
## The auth-type can either be 'basic' for a general-purpose authorization protocol or 'stealth' for a less scalable protocol that also hides service activity from unauthorized clients.
## Valid client names are 1 to 16 characters long and only use characters in A-Za-z0-9+-_ (no spaces). 
HiddenServiceAuthorizeClient stealth 1234567890123456
}}

Save and exit.

= Client Side =
{{Update}}

{{CodeSelect|code=
sudo apt-get update
}}

Install Tor's build dependencies.

{{CodeSelect|code=
sudo apt-get build-dep tor
}}

<ref>
{{CodeSelect|code=
sudo apt-get install zlib1g-dev libevent-dev asciidoc xmlto libsystemd-dev
}}
</ref>

Create directory <code>~/tor-src</code>.

{{CodeSelect|code=
mkdir ~/tor-src
}}

Change directory to <code>~/tor-src</code>.

{{CodeSelect|code=
cd tor-src
}}

Download the Tor source package.

{{CodeSelect|code=
apt-get source tor
}}

Change directory to Tor source directory.

{{CodeSelect|code=
cd tor-*/
}}

{{Open_File|filename=
debian/rules
}}

Change:

{{CodeSelect|code=
dh_auto_configure \
        $(confflags) \
        --prefix=/usr \
        --mandir=\$${prefix}/share/man \
        --infodir=\$${prefix}/share/info \
        --localstatedir=/var \
        --sysconfdir=/etc \
        --disable-silent-rules \
        --enable-gcc-warnings-advisory
}}

To:

{{CodeSelect|code=
dh_auto_configure \
        $(confflags) \
        --prefix=/usr \
        --mandir=\$${prefix}/share/man \
        --infodir=\$${prefix}/share/info \
        --localstatedir=/var \
        --sysconfdir=/etc \
        --disable-silent-rules \
        --enable-gcc-warnings-advisory \
        --enable-tor2web-mode
}}

{{Open_File|filename=
src/or/config.c
}}

Change

{{CodeSelect|code=
V(Tor2webMode,                 BOOL,     "0"),
}}

To

{{CodeSelect|code=
V(Tor2webMode,                 BOOL,     "1"),
}}

Build the Tor package.

{{CodeSelect|code=
debuild
}}

<ref>
* https://github.com/globaleaks/Tor2web/wiki/Installation-Guide
* https://github.com/globaleaks/Tor2web/issues/327
</ref>

= Footnotes =

{{Footer}}

[[Category:Documentation]]
