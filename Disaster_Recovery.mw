{{Header}}
{{DISPLAYTITLE:Disaster Recovery after Compromise
{{#seo:
|description=Disaster Recovery after Compromise
}}

0. Machines are expendable, but data is precious. Consider your current machine and everything attached to it compromised. Do not use it any longer it's only good for salvaging data. Understand what's done is done. Your private data has been seized, copied, scrutinized and maliciously altered. Continuing using data from compromised VMs or compromised hosts in clean places risks reinfection.

The goal is to protect others and to re-establish a trusted environment from which future activities will be made private once again. Assuming you are still whole in life and limb and have regained access to your digital property, you can now move forward.

1. Acquire a new laptop in cash from a store. Setup Debian with Whonix, enabling USB support.

2. Connect any external USB or HDDs and mirror everything from them to the Workstation's shared folder. Disconnect and permanently discard the suspected storage. 

3. Revert the Workstation (WS) to a clean snapshot. Connect new storage and encrypt it following our guidelines. Move the files back onto it without opening them. Files are innocuous if not opened and so you can add them normally, however after executing/opening them you should consider the VM compromised. Since you cannot be sure if some types of files were infected (PDFs, media) it is always recommended you copy only the data you will be working on into the WS and disconnect the new HDD. Only ever connect the storage to a trusted machine to do backups, such as a VM in a known good state. 

4. Consider any and all passwords compromised. Immediately change them using recommended means as per our password page.

5. Revoke all keys and generate new pairs then announce to all contacts your key migration and the reason behind it. Put notices on your code repos to alert potential users so they can inspect them for foul play and take precautions. 

6. Study your failures to prevent similar situations in the future. The next time you may not be so lucky to realize that security has been broken. Knowing why your cover was blown is one of the most pieces of information you can gather and share with others. If you follow everything on this wiki diligently and have not left your stuff unattended, then you are down to software vulnerabilities as the only plausible possibility. Post your Tor logs and report what Tor guard you were connected to so the community can piece together if it was part of a coordinated attack on the network. Disclose what hypervisor you used to the upstream security team and explain the situation in detail to bring it to their attention.

= Footnotes =
{{reflist|close=1}}

{{Footer}}

[[Category:Documentation]]
