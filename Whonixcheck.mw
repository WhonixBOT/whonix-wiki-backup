{{Header}}

{{Stable}}
= Introduction =
''whonixcheck'' ([https://github.com/Whonix/Whonix/blob/stable/whonix_shared/usr/local/bin/whonixcheck on github]) is a bash script, checking many important things. Supports to be run in console and also has a grapical progress meter and graphical info popup for the results. It's stored in ''/usr/local/bin/whonixcheck''. Whonix will also work without that script. Nothing is compiled, it's just a script and anyone can read the source code.

[[Image:whonixcheck_gui.png|thumb|whonixcheck done]]

[[Image:whonixcheck_progress.png|thumb|whonixcheck in progress]]

[[Image:whonixcheck_cli.png|thumb|whonixcheck in Konsole]]

[[Image:writing to tty1 by adrelanos.png|thumb|[[Desktop#whonixcheck.2Ftimesync_writing_to_tty1|Automatically started whonixcheck writing to tty1.]]]]

= Whonixcheck checks =

* Status of Network Time Synchronization
** see above
** Only the status of the logfiles is read, there is no actual network traffic, that is done before.
** <s>{{Whonix6}} and above: Checks status of Boot Clock Randomization, Time Sanity Check</s> (Checked by timesync.)
** Check status of tails_htp
* Tor connection
** downloads https://check.torproject.org with curl through extra SocksPort
** downloads https://check.torproject.org with curl through TransPort
* Tor Browser version
** downloads https://check.torproject.org/RecommendedTBBVersions with curl through extra SocksPort
* operating system updates
** Run ''apt-get update'' through apt-get SocksPort and inform about the system being up to date or requiring updates.
* Whonix version and Whonix news
** Downloads http://sourceforge.net/projects/whonix/files/news/whonix_news.asc/download with curl through extra whonix news SocksPort.
** Is supposed to reflect most important news for people not even following Whonix Important Blog. In theory, if an IP leak in Whonix where found or exit nodes activly exploiting apt-get traffic, this would be used to briefly inform users about the danger.
** [[Dev/News|Whonix News Format]]
** Whonix version and news file must be signed by Whonix developer adrelanos.
** Adrelanos gpg key got copied to /usr/share/whonix/adrelanos.asc at build time.
** Warns if the file can not be gpg verified with adrelanos gpg key. In that case version and news is ignored.
** Also see [[Trust]].
** An adversary with (temporary) control over the sourceforge.net server could replace that file with any other message ever signed by adrelanos. There is no defense against this attack, but a defense wouldn't be useful anyway. <ref>An adversary in that position could run even more powerful attacks, such as malicious website news and documentation, malicious downloads</ref>

The whonixcheck script was inspired by https://check.torproject.org. In past when people were still recommended to use proxy settings to torify web browsers, it was an important check. While manual torification of web browsers is nowadays recommended against, the Tor Browser Bundle, which is securely pre-configured, still visits check.tpo and checks if everything is okay. Check.tpo also checks if the Tor Browser Bundle version is up to date (technically Tor Button downloads version information and checks locally).

While check.tpo just checks the browser, Whonix is more than a browser. It's a complete operating system. Therefore when the browser starts, it's already too late. It has to be checked earlier, because the user might not start the browser. That's why whonixcheck will be automatically started after boot/login.

The Whonix design ensures, that never the users real IP can be detected. Why check it anyway? Sometimes check.tpo reports false positives and fails to detect Tor exit nodes. The user should be informed about that possibility. That reduces support requests and bad press. It's fine to investigate if the Tor exit node could not be detected, but we're quite confident, that the outcome will be, that it's a Tor exit node IP. Some users may do dangerous and/or unsupported things, such as changing Whonix-Workstation's network interface from {{Code|internal}} network {{Code|"Whonix"}} to {{Code|bridged}} or {{Code|NAT}} or other creative and adventurous things, such as using virtualizers which are entirely unsupported and untested by Whonix developers. Last but not least, users can and are encouraged to install upgrades using {{Code|apt-get}} and free to install arbitrary packages on Whonix-Workstation. In a totally unexpected case, that may open up for a leak and whonixcheck is Whonix's last layer of defenses against such leaks.

''/etc/cron.daily/'' should run it once every day, even if the system is not restarted (TODO) but that feature appears to be broken and needs fixing. The motivation behind that is also to inform long running systems.

The ''ca-certificates'' Debian package is installed on Whonix. Curl will verify the SSL certificate and aborts if the certificate is not valid.

Attack surface for this script includes at least curl, apt-get, gpg, grep, sed, bash, uwt, torsocks, zenity, pgrep, htpdate logs. Adrelanos believes, that benefits outweigh the risks not running those checks. The user is free to ''sudo chmod -x /usr/local/bin/whonixcheck'' and adrelanos remains as always open for reviews and suggestions.

Also see [[SSL]].

= Testing =
{{Testing}}

* If run either on bare metal ([[Physical Isolation]]) or inside VirtualBox. Warns when using an unsupported (by Whonix developers) virtualizer.
* Check the validity of Tor's config files by using "sudo tor --verify-config". Whonix-Gateway only. Reports only error. Otherwise quite.

= Footnotes =
<references/>

{{Footer}}

[[Category:Documentation]] [[Category:Design]]
