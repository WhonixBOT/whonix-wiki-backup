{{Header}}

{{#seo:
|description=How to refactor Whonix's firewall.
}}

~/iptables-dump script.

inspired by: http://unix.stackexchange.com/a/206057/49297

Can we have it drop packages and bytes counter to make the diff simpler?

http://unix.stackexchange.com/questions/254419/how-to-get-a-deterministic-complete-dump-of-all-iptables-rules

https://github.com/Whonix/usability-misc/blob/master/sbin/iptables-save-deterministic

<pre>
#/bin/bash
set -x
set -e
iptables -vL -t filter
iptables -vL -t nat
iptables -vL -t mangle
iptables -vL -t raw
iptables -vL -t security
true $?
</pre>

Store current iptables rules to file a.

<pre>
sudo ./iptables-dump > a
</pre>

Refactor the code.

{{Reload Firewall}}

Store current iptables rules to file b.

<pre>
sudo ./iptables-dump > b
</pre>

Compare files a and b.

<pre>
diff a b
</pre>

There should be no diff.

{{Footer}}

[[Category:Development]]
