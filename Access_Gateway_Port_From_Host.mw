{{Header}}
{{#seo:
|description=Access Whonix-Gateway Port From Host (Esoteric Documentation)
|image=https://www.whonix.org/w/images/c/ce/Accessgateway.jpg
}}

= Access Whonix-Gateway Port From Host =

'''This is very esoteric and you probably don't need it!''' '''Advanced users only!'''

'''Only tested with {{project name}} 0.5.6. Will need changes for later versions.'''

== Example: Make port 9050 accessible from the host. ==

On the host...

In the Whonix-Gateway VM network settings. Set up Port Forwarding: within the "Adapter 1" tab click "Advanced", then Port Forwarding. Insert a new rule as follows.

<pre>
Name: 9050
Protocol: TCP
Host IP: 127.0.0.1
Host Port: 9050
Guest IP: leave blank
Guest Port: 9050
</pre>

Or the same as command line.

{{CodeSelect|code=
VBoxManage modifyvm "Whonix-Gateway" --natpf1 "9050",tcp,127.0.0.1,9050,,9050
}}

Inside {{gateway_product_name}}...

Add to {{Code2|/usr/local/etc/torrc.d/50_user.conf}}.

{{CodeSelect|code=
## 10.0.2.15 is usually obtained from VirtualBox's DHCP server.
## Hope this always works, otherwise you have to edit network config.
## and use a static virtual LAN IP.
SocksPort 10.0.2.15:9050

## The next line is not strictly required, neat for debugging.
SocksPort 127.0.0.1:9050
}}

([[Template:Network_Config]])

{{Reload Tor}}

Look at {{Code|/etc/whonix_firewall.d/30_default.conf}}.

<pre>
GATEWAY_ALLOW_INCOMING_FLASHPROXY=1
FLASHPROXY_PORT=9050
</pre>

== Debugging ==

Inside {{gateway_product_name}}...

Switch to clearnet user.

{{CodeSelect|code=
su clearnet
}}

{{Default_Passwords}}

Test if the port you want to make available on the host is available from inside Whonix-Workstation. (If that's not the case, something is fundamentally wrong and you need to fix this first.)

Circumventing uwt curl wrapper.

{{CodeSelect|code=
/usr/bin/curl 127.0.0.1:9050
}}

Circumventing uwt curl wrapper.

{{CodeSelect|code=
/usr/bin/curl 10.0.2.15:9050
}}

It should answer "Tor is not a http proxy".

== Testing ==

On the host...

{{CodeSelect|code=
/usr/bin/curl 127.0.0.1:9050
}}
It should answer "Tor is not a http proxy". If you see that, that indicates that Tor is, which runs inside Whonix-Gateway is accessible on the host as well.

== Forwarding that port to LAN ==

On the host...

This is untested, but should work.

You can use something like socat or systemd-socket-proxyd to redirect that port 127.0.0.1:9050 to a different network interface. Otherwise you could experiment with the Whonix-Gateway VM network settings.

= See Also =
* [[Hosting a %28private%29 %28obfuscated%29 bridge or %28exit%29 relay|Hosting a (private) (obfuscated) bridge or (exit) relay]]
* [[Ports]]

{{Footer}}

[[Category:Documentation]]
