{{Header}}
{{#seo:
|description=How to open a Port in {{workstation_product_name}} Firewall
|image=https://www.whonix.org/w/images/9/9e/Firewall-34227640.png
}}
[[image:Firewall-34227640.png|250px|thumb]]
<ref>
https://github.com/{{project_name_short}}/whonix-ws-firewall/blob/{{project_name_short}}13/man/whonix_firewall.8.ronn
</ref> <ref>
{{CodeSelect|code=
man whonix_firewall
}}
</ref>

= How to open a Port in {{workstation_product_name}} Firewall =
== How to open an Incoming Port in {{workstation_product_name}} Firewall ==
For purpose of allowing an incoming connection from {{Gateway product name}} such as for example to make [[Onion Services]] reachable.

'''1.''' {{Firewall Settings Workstation}}

'''2.''' Add. Replace <code>80</code> with the actual port you would like to open.

{{CodeSelect|code=
EXTERNAL_OPEN_PORTS+=" 80 "
}}

'''3.''' Save.

'''4.''' {{Reload_Firewall_ws}}

'''5.''' Done.

== How to open an Outgoing Port in {{workstation_product_name}} Firewall ==
For purpose of allowing an outgoing connection to {{Gateway product name}}.

Might be useful for [[Tor#Additional_SocksPorts|Tor additional <code>SocksPort</code>s]].

'''1.''' {{Firewall Custom}}

'''2.''' {{Firewall Settings Workstation}}

'''3.''' Add.

Note: Replace <code>9230</code> with the actual port you would like to open. Replace <code>SOCKS_PORT_CUSTOM</code> with <code>SOCKS_PORT_ANOTHER</code> when using multiple. Replace word <code>ANOTHER</code> with another unique word.

{{CodeSelect|code=
SOCKS_PORT_CUSTOM=" 9230 "
}}

'''4.''' Save.

'''5.''' {{Reload_Firewall_ws}}

'''6.''' Done.

= How to open All Ports in {{workstation_product_name}} Firewall =
For purpose of allowing an incoming connection from {{Gateway product name}} such as for example to make [[Onion Services]] reachable.

This is usually not required and should be avoided.

{{Firewall Settings Workstation}}

Add.

{{CodeSelect|code=
EXTERNAL_OPEN_ALL=true
}}

Save.

{{Reload_Firewall_ws}}

= Disable {{workstation_product_name}} Firewall Until Reboot =
Inside {{Workstation product name}}.

See [[Dev/Firewall_Unload]].

= Permanently Disable {{workstation_product_name}} Firewall =
Inside {{Workstation product name}}.

{{CodeSelect|code=
sudo systemctl mask whonix-firewall
}}

No firewall rules will load after rebooting.

= ping =
Ping commands should NOT work for external addresses from your {{workstation_product_name}}; ICMP traffic <ref>http://en.wikipedia.org/wiki/Internet_Control_Message_Protocol</ref> is not proxied, and filtered by {{project name}} Firewall (<code>{{W_Firewall}}</code>) because [[Tor#UDP|Tor does not support UDP]]. For example, <code>ping google.com</code> will not work. To make ping work, see chapter [[#Allow UDP|Allow UDP]].

When [[SUID Disabler and Permission Hardener]] gets enabled (not enabled by default at time of writing but will be enabled in by default in future), the <code>CAP_NET_RAW</code> capability will be removed from <code>ping</code> to reduce attack surface since it wold not work anyway. <ref>
https://github.com/Whonix/anon-apps-config/blob/master/etc/permission-hardening.d/30_ping.conf
</ref> When that will happen, to re-enable <code>ping</code> this, chapter [[SUID_Disabler_and_Permission_Hardener#Whitelist_Specific_Capability_Binaries|Whitelist Specific Capability Binaries]].

Forum discussion: <br />
https://forums.whonix.org/t/ping-operation-permitted/11056/

= Allow UDP =
{{Tor_UDP}}

To allow allow UDP, follow the following steps.

{{Firewall Settings Workstation}}

Add. <ref>
* https://forums.whonix.org/t/does-whonix-have-torrents-available/10046/8
* https://forums.whonix.org/t/whonix-15-0-1-5-1-for-virtualbox-point-release/10294
</ref>

{{CodeSelect|code=
firewall_allow_udp=true
}}

Save.

{{Reload_Firewall_ws}}

Done, {{Workstation product name}} firewall does now permit UDP.

= Purpose =
https://github.com/Whonix/whonix-firewall/blob/master/man/whonix_firewall.8.ronn#whonix-workstation-firewall-design-notes

= See Also =
* [[Install_Software#{{workstation_product_name}}_is_Firewalled|{{workstation_product_name}} is Firewalled]]
* [[Ports|Open a Port(s) in {{project name}} and Port Forwarding]]
* [[Whonix_Configuration_Files#Configuration_Drop-In_Folders|{{project_name}} Configuration Drop-In Folders]]
* https://github.com/Whonix/whonix-firewall/blob/master/etc/whonix_firewall.d/30_whonix_workstation_default.conf
* https://github.com/Whonix/whonix-firewall/blob/master/usr/bin/whonix-workstation-firewall
* https://github.com/Whonix/whonix-firewall
* [[{{gateway product name short}}_Firewall|{{gateway_product_name}} Firewall]]

= Footnotes =
{{reflist|close=1}}

{{Footer}}

[[Category:Documentation]]
