{{Header}}
{{#seo:
|description=Overview of Advanced Deanonymization Attacks and their development status in Whonix
}}

=Introduction=
This page aims to track and document advanced attacks<ref>https://phabricator.whonix.org/T540</ref> that also affect virtualized and anonymous systems like Whonix. Attacks discussed here tend to have very high accuracy and are easily feasible to devastating effect. They are mostly about abusing the underlying hardware design to undermine isolation barriers imposed by the software stack above. Exploiting buggy software remains the lowest hanging fruit for network adversaries, however we expect to see them expand their toolbox to include vectors like these because of the low to none chances of discovery.

Some definitions: Side Channels allow a malicious process to spy on events/data outside the VM. Local Covert Channels require collaboration between a malicious VM and an infected victim VM to leak confidential data. Network Covert Channels only require that a compromised VM induce identifiable changes in network traffic that are immediately identifiable to adversaries that surveil the network. Behavioral tracking (also called biometric tracking) relies on spying on how you interact with your devices<ref>https://www.whonix.org/blog/biometric-fingerprinting</ref> rather than looking at the unique identifiers at the device, protocol or application levels.

=Attacks=
{| class="wikitable" style="text-align: center; background-color: #fff"
|- style="background-color: #f9f9f9"
| style="height: 35px;width: 170px"|
| '''CPU-induced network latency'''<ref>https://phabricator.whonix.org/T530</ref>
| '''TCP ISNs and temperature induced clock skews'''<ref>https://phabricator.whonix.org/T543</ref>
| '''DRAMA Cross-CPU attacks'''<ref>https://phabricator.whonix.org/T541</ref>
| '''Cross-VM CPU cache attacks'''<ref>https://phabricator.whonix.org/T539</ref>
| '''Keyboard/Mouse input fingerprinting'''<ref>https://phabricator.whonix.org/T542</ref>
|-
| style="height: 27px;background-color: #f9f9f9"| Attack Type
| Covert Channel (network)
| Covert Channel (network)
| Covert (local) and Side Channel
| Side Channel
| Behavioral Tracking
|-
| style="height: 27px;background-color: #f9f9f9"| requires local compromise
| No
| No
| Yes
| Yes
| No
|-
| style="height: 27px;background-color: #f9f9f9"| Attack Summary
| CPU load induces notice-able latency in network packets.
| CPU load skews clock crystal frequency. Changes detectable in TCP ISN field.
| Timing shared memory bank accesses allows data leaks also snooping on keystrokes.
| Shared CPU cache access latency leaks timing data of crypto processes.
| Timing of/between keystrokes and mouse movement speed/angles create individually unique patterns.
|-
| style="height: 27px;background-color: #f9f9f9"| Mitigation
| Queue and release packets randomly with Netfilter.
| Rewrite TCP ISNs to conceal timer skews.
| Block clflush and tsc instructions. Remove all timers. Avoid multi-threading VMs. Alternatively use non-interleaved NUMA with pinned vCPUs.
| Pin vCPUs to separate pCPUs. Block tsc instructions. Remove all timers.
| Abstract keyboard/mouse input into a network layer and inject random delays.<ref>Removing fine-grained timers helps here too.</ref>
|-
| style="height: 27px;background-color: #f9f9f9"| Fix Stage - Whonix [[KVM]]
| style="background-color: {{Green}}"| Near Production
| style="background-color: {{BlueBackground}} Planning
| style="background-color: {{Green}}"| Production
| style="background-color: {{Green}}"| Production
| style="background-color: {{BlueBackground}} Planning
|-
| style="height: 27px;background-color: #f9f9f9"| Fix Stage - Whonix [[VirtualBox]]
| style="background-color: {{Green}}"| Near Production
| style="background-color: {{BlueBackground}} Planning
| style="background-color: {{Red}}"| -
| style="background-color: {{Red}}"| -
| style="background-color: {{BlueBackground}} Planning
|-
| style="height: 27px;background-color: #f9f9f9"| Fix Stage - [[Qubes-Whonix]]
| style="background-color: {{Green}}"| Near Production
| style="background-color: {{BlueBackground}} Planning
| style="background-color: {{Red}}"| -
| style="background-color: {{Red}}"| -
| style="background-color: {{BlueBackground}} Planning
|}

[[Time_Attacks|Time related attacks]] are a large class of their own, documented separately with some overlap here.

=Footnotes=
<references />
{{Footer}}
[[Category:Documentation]]
