{{Header}}
{{#seo:
|description=Instructions for installing VirtualBox Guest Additions in Whonix. Shared Folders, Mouse Integration, etc.
}}

== Installing VirtualBox Guest Additions ==
=== New Instructions for Debian Wheezy ===
==== Installation from Debian apt repository ====
Inside your VirtualBox virtual machine.

Very simple.

Searching<ref>http://packages.debian.org/search?searchon=names&keywords=virtualbox</ref> for Debian packages containing VirtualBox was a wise thing. In past it was sometimes a real pain to install the guest additions. The search brought up, that honorable people created a debian package with the tools.

1. [[Security_Guide#Updates|Update]] your operating system.

2. Install. Easy:

<pre>
sudo apt-get install virtualbox-guest-x11
</pre>

Advanced security? See footnote or skip: <ref>
If you only want Shared Folder, mouse integration, for improved security, you can try using only the next line, but not the line after next.
You need kernel headers to be able to compile the kernel module.

<pre>
sudo apt-get install --no-install-recommends virtualbox-guest-dkms virtualbox-guest-utils
</pre>

If you want all features, such as dynamic resolution and shared clipboard
<pre>
sudo apt-get install virtualbox-guest-x11
</pre>
</ref>

3. Reboot.

4. NOTE: Sometimes after reboot the Workstation guest fails to pick up a new resolution. Try to change the screen resolution manually a few times, from KDE settings. Once it succeeds to change to fullscreen, the change will stay persistent across reboots.

==== Installing using VirtualBox Instructions ====
Alternatively, above [[#Installation from Debian apt repository]] fails, which should not, you could also refer to the upstream documentation, [https://www.virtualbox.org/manual/ch04.html VirtualBox: Chapter 4. Guest Additions].

=== Instructions for Debian Jessie ===
<div class="toccolours mw-collapsible mw-collapsed" style="width:800px">
Whonix 9 is based on Debian Wheezy. So unless you are using a Whonix-Custom-Workstation based on Debian Jessie, you most likely want to use above instructions. Otherwise press expand on the right side.
<div class="mw-collapsible-content">
'''Not sure if the jessie instructions are still up to date. Maybe the ones for wheezy also work for jessie just fine.

Inside your VirtualBox virtual machine.

This version is difficult to get working with guest additions and vbox shares. Debian Jessie has the issue that Whonix installs with Kernel 3.10 and the distro is at 3.12, and the 3.10 headers are not available. Therefore, it is dangerous (and unsafe) to get the Kernel headers on a different repository. Additionally, there are reports that updating the kernel can cause issues (and is also unsafe).

NoteÀê It has been reported that reverting Virtualbox 2 versions back with 3.10 can also solve issues. Update this wiki with your results.
</div>
</div>

=== Old instructions for Ubuntu Precise ===
Moved to [[Ubuntu]].

== Shared Folder ==
As an alternative to Shared Folders provided by VirtualBox Guest Additions, you could also have a look at the [[File Transfer]] page.

And if you want to use the shared folder read ahead... Go to VirtualBox -> machine -> change -> shared folder -> choose a folder -> use folder name '''shared'''. Choose mount automatically and create permanently. Press ok. Use the following commands to mount to folder.

<pre>
#sudo mkdir -p /mnt/shared
#sudo chmod 777 /mnt/shared
sudo mount -t vboxsf -o uid=1000,gid=1000 shared /mnt/shared
</pre>

If you run into a '''Protocol Error''' try using a different name, do not use ''share'', use something else, anything, for example, '''shared'''. 

=== Permanently mount Shared Folder ===

After reboot, you have to repeat the mount command. If you want to mount the folder automatically, have a look at the [https://help.ubuntu.com/community/VirtualBox/SharedFolders source] of that information or simply add '''before''' ''exit 0'' in your /etc/rc.local:

<pre>
sudo mount -t vboxsf -o uid=1000,gid=1000 shared /mnt/shared
</pre>

<ref>
The steps.

<pre>
sudo mkdir -p /mnt/shared
sudo chmod 777 /mnt/shared
</pre>

have already been applied by {{Code|/usr/share/whonix/postinst.d/70_shared_folder}} for your convenience.
</ref>

== Warning ==
'''Warning: Not recommended?'''

* Weakens security in general as per [[Security_Guide#VirtualBox_Hardening|VirtualBox Hardening]]?
* <s>See article, [http://www.phoronix.com/scan.php?page=news_item&px=OTk5Mw The VirtualBox Kernel Driver Is Tainted Crap] <ref>http://www.webcitation.org/6HqJVN0br</ref></s> <font size="-3"><-- Was a misconception. It's talking about the kernel driven (on the host), not guest additions.</font>
* Opposite statements: [http://lists.debian.org/debian-devel/2013/08/msg00112.html one] / [http://lists.debian.org/debian-devel/2013/08/msg00116.html two]
* Clipboard sharing is disabled by default in the VirtualBox VM settings for Whonix-Gateway and Whonix-Workstation. Enable it only temporarily in case you really need it. Go to VirtualBox machine settings -> General -> Advanced -> Shared Clipboard -> Bidirectional -> ok.

== Alternatives ==
* For file exchange with Whonix without installing guest additions, see [[File Transfer]].
* To get a higher screen resolution without installing guest additions, see [[Higher Screen Resolution]]
* To get mouse integration without installing guest additions, use USB tablet in VirtualBox settings. Recommended against, because it requires adding USB controller to VirtualBox. (VirtualBox -> Right click on Virtual Machine -> Settings -> System -> Enable absolute pointing device)

== Temporary disable Guest Additions ==
'''This solution is incomplete!''' In case you want to temporarily disable VirtualBox guest additions, you can try this. A safer solution would be to uninstall them.

Find out which VirtualBox kernel modules are load.

<pre>cat /proc/modules | grep vbox</pre>

Create a new config file for module blacklisting.

<pre>sudo nano /etc/modprobe.d/vbox.conf</pre>

And add:

<pre>
blacklist vboxvideo
blacklist vboxsf
blacklist vboxguest
</pre>

Safe and reboot. Done.

= Footnotes =
<references/>

{{Footer}}

[[Category:Documentation]]
