{{Header}}

== Warning ==
'''Warning: Not recommended!'''

* '''Weakens security in general as per [[Security Guide]] (Harden Virtualbox).'''
* Also see article, [http://www.phoronix.com/scan.php?page=news_item&px=OTk5Mw The VirtualBox Kernel Driver Is Tainted Crap] <ref>http://www.webcitation.org/6HqJVN0br</ref> | Opposite statements: <ref>http://lists.debian.org/debian-devel/2013/08/msg00112.html</ref>, <ref>http://lists.debian.org/debian-devel/2013/08/msg00116.html</ref>
* Clipboard sharing is disabled by default in the Virtual Box VM settings for Whonix-Gateway and Whonix-Workstation. Enable it only temporarily in case you really need it. Go to VirtualBox machine settings -> General -> Advanced -> Shared Clipboard -> Enable -> ok.


* <s>Additionally they give the Virtual Machine access to the host's (built-in) microphone. Many notebooks have a built-in microphone. In case you install Guest Additions anyway, better cover it up or remove your microphone. Forum question: [https://forums.virtualbox.org/viewtopic.php?f=1&t=56820 VirtualBox Forum: How disable microphone when guest additions are installed?] Feature Request: [https://www.virtualbox.org/ticket/12023 disable microphone when guest additions are installed]</s>

== Alternatives ==
* For file exchange with Whonix without installing guest additions, see [[File Transfer]].
* To get a higher screen resolution without installing guest additions, see [[Higher Screen Resolution]]

== Installing VirtualBox Guest Additions ==
=== Instructions for Whonix 7.7.8.6 (Debian Wheezy) ===

Follow instructions for Debian Wheezy below.

=== Instructions for Debian Jessie ===

Recommend avoid for Guest Additionsǃ This version is difficult to get working with guest additions and vbox shares. Debian Jessie has the issue that Whonix installs with Kernel 3.10 and the distro is at 3.12, and the 3.10 headers are not available. Therefore, it is dangerous (and unsafe) to get the Kernel headers on a different repository. Additionally, there are reports that updating the kernel can cause issues (and is also unsafe). Therefore, instead install experimental version 7.7.8.6 located at https://www.whonix.org/blog/

Noteː It has been reported that reverting Virtualbox 2 versions back with 3.10 can also solve issues. Update this wiki with your results.

=== New Instructions for Debian Wheezy ===
Very simple.

Searching<ref>http://packages.debian.org/search?searchon=names&keywords=virtualbox</ref> for Debian packages containing VirtualBox was a wise thing. In past it was sometimes a real pain to install the guest additions. The search brought up, that honorable people created a debian package with the tools. Simply do:

<pre>sudo apt-get update && sudo apt-get dist-upgrade</pre>

Followed by.

<pre>
## If you only want Shared Folder, for improved security,
## you can try using only the next line, but not the line after next.
sudo apt-get install --no-install-recommends virtualbox-guest-dkms virtualbox-guest-utils

## If you want all features, such as dynamic resolution
## and mouse integration.
sudo apt-get install virtualbox-guest-x11
</pre>

Reboot. And you're done.

Alternatively, if this fails, you could also refer to the upstream documentation, [https://www.virtualbox.org/manual/ch04.html VirtualBox: Chapter 4. Guest Additions].

NOTE: Sometimes after reboot the Workstation guest fails to pick up a new resolution. Try to change the screen resolution manually a few times, from KDE settings. Once it succeeds to change to fullscreen, the change will stay persistent across reboots.

NOTE: If installation of virtualbox-guest-dkms finishes without error, but there is no kernel module generated you're probably missing the kernel-headers. 
Do the following:
In 
<pre>/etc/apt/sources.list #uncomment the two lines starting with "deb-src"</pre> 
This will make linux sources available in apt-get.
<pre>
sudo apt-get install linux-headers-$(uname -r)
sudo apt-get install --reinstall virtualbox-guest-dkms
</pre>
Restart VM (to make the kernel module available)

=== Old instructions for Ubuntu Precise ===
Moved to [[Ubuntu]].

== Shared Folder ==
As an alternative to Shared Folders provided by VirtualBox Guest Additions, you could also have a look at the [[File Transfer]] page for alternatives.

And if you want to use the shared folder read ahead... Go to VirtualBox -> machine -> change -> shared folder -> choose a folder -> use folder name '''shared'''. Choose mount automatically and create permanently. Press ok. Use the following commands to mount to folder.

<pre>
#sudo mkdir -p /mnt/shared
#sudo chmod 777 /mnt/shared
sudo mount -t vboxsf -o uid=1000,gid=1000 shared /mnt/shared
</pre>

If you run into a '''Protocol Error''' try using a different name, do not use ''share'', use something else, anything, for example, '''shared'''. 

=== Permanently mount Shared Folder ===

After reboot, you have to repeat the mount command. If you want to mount the folder automatically, have a look at the [https://help.ubuntu.com/community/VirtualBox/SharedFolders source] of that information or simply add '''before''' ''exit 0'' in your /etc/rc.local:

<pre>
sudo mount -t vboxsf -o uid=1000,gid=1000 shared /mnt/shared
</pre>

<ref>
The steps.

<pre>
sudo mkdir -p /mnt/shared
sudo chmod 777 /mnt/shared
</pre>

have already been applied by {{Code|/usr/share/whonix/postinst.d/70_shared_folder}} for your convenience.
</ref>

== Temporary disable Guest Additions ==
'''This solution is incomplete!''' In case you want to temporarily disable VirtualBox guest additions, you can try this. A safer solution would be to uninstall them.

Find out which VirtualBox kernel modules are load.

<pre>cat /proc/modules | grep vbox</pre>

Create a new config file for module blacklisting.

<pre>sudo nano /etc/modprobe.d/vbox.conf</pre>

And add:

<pre>
blacklist vboxvideo
blacklist vboxsf
blacklist vboxguest
</pre>

Safe and reboot. Done.

= Footnotes =
<references/>

{{Footer}}

[[Category:Documentation]]
