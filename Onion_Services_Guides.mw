{{Header}}
{{#seo:
|description=Collection of various Onion Services Guides
|og:image=https://www.whonix.org/w/images/3/3a/Onionservice.jpg
}}

{{Maintainer|
|status=stable
|about=About this {{Code2|{{PAGENAME}}}} Page
|difficulty=medium
|maintainer=[https://forums.whonix.org/users/hulahoop HulaHoop]
|support=[[Support]]
}}

==Introduction==
Whonix handles the anonymity aspect safely and transparently allowing you to concentrate on running and managing your service.

Here are guides for some interesting use cases.

To make your service better known you can list it on [https://ahmia.fi ahmia.fi] - a public directory of Onion sites that works closely with the Tor Project.

==Tips==
Some very useful info on scaling Onion sites was recently published in an article series on the Tor blog. <ref>https://blog.torproject.org/blog/cooking-onions-finding-onionbalance</ref>

For making a production level Onion mirror of you clearnet site, look over some [https://lists.torproject.org/pipermail/tor-talk/2016-September/042225.html tips].

== GlobaLeaks ==
[https://globaleaks.org/ Project main site]

{{Third Party Repository}}

[https://github.com/globaleaks/GlobaLeaks/wiki/Installation-guide Install Guide from GlobaLeaks third party repository]

This is a guide to help you set up your own secure and anonymous whistle blowing platform. Note that this is a standalone node and not part of a network, although you can optionally list yourself in the [http://leakdirectory.org/ Leaks Directory].

To decide between GlobaLeaks and SecureDrop read [https://yawnbox.com/index.php/2016/01/21/globaleaks-and-securedrop-which-is-right-for-you/ this] detailed comparison written by a Tor Project developer.

== SecureDrop ==
SecureDrop is another widely used whistle-blowing platform installed at many news organizations. To set it up please refer to the [https://github.com/freedomofpress/securedrop/blob/develop/docs/install.md official guide]. To use SecureDrop as a source, refer to this [https://github.com/freedomofpress/securedrop/blob/develop/docs/source_user_manual.md documentation] and for using SecureDrop as a journalist go [https://github.com/freedomofpress/securedrop/blob/develop/docs/journalist_user_manual.md here]. For general information and project code go to their main [https://github.com/freedomofpress/securedrop Github page].

If you are a news or whistle-blowing site operator you may be interested in having your Onion Service address listed at the [https://freedom.press/securedrop/directory Freedom of The Press Foundation].

== Sparkleshare ==
For a private and anonymous DropBox alternative you can run [https://guardianproject.info/2013/11/12/your-own-private-dropbox-with-free-software/ Sparkleshare as a Onion Service]. To ensure that only you and the intended parties can access the service you need to set up Onion Service Authentication, see [https://www.whonix.org/wiki/Onion_Services#Onion_Service_Authentication instructions].

== SSH ==
Secure Shell is the dominant protocol for secure remote login and system administration. It is a critical component of server and internet infrastructure. Recent revelations from the Snowden documents and further analysis<ref>https://stribika.github.io/2015/01/04/secure-secure-shell.html</ref> has uncovered weaknesses in some of the included cipher-suites, allowing abuses by resourceful Nation-State adversaries. If you run SSH in this day and age, it should be done from behind a Tor Onion Service.

Advantages:

*Protection by Tor
*Robust access control provided by Onion Services authentication<ref>Shields SSH from brute-force attacks and exploit attacks against the SSH server daemon.</ref>
*NAT traversal
*No need for services like DynDNS
 
1. Setup [https://www.whonix.org/wiki/Onion_Services#Onion_Service_Authentication Onion Service Authentication]

2. Run SSH like normal or follow this [https://wiki.debian.org/SSH guide] if you are a beginner

== Stormy ==
Stormy is a simple Onion Service blog setup script. The developer hopes to have it packaged for Debian at some point. You can see it on [https://github.com/glamrock/Stormy Github].

= Multiplayer .onion Games =
{| role="presentation" class="wikitable mw-collapsible mw-collapsed"
| Click on Expand to see the '''Multiplayer .onion Games''' Gaming section
|-
| 

Whether they be libre or non-libre, add the guide for your multiplayer .onion game here. For now there is only one game server + client guide that is being worked on, for a game called TEG.

== TEG ==
This guide was made for Whonix 14. If you are only a player you might not even need Whonix to play, this guide is mostly about how to host a TEG server and how to manage it and the players that connect and preventing DDOS attacks.

TEG or "Tenes Empanadas Graciela" is a [https://www.wikidata.org/wiki/Q335874 turn-based strategy video game] which is played through a server / client system.

=== CONNECTING TO THE GAME - standard Whonix 14 ===
Here starts the guide regarding how to connect to the game server that supports standard authentication(what most Tor users are used to). 

This is the section for when the game server uses standard onion services(the .onion addresses that most people are used to, connecting just by entering the address, ie. 3g2upl4pq6kufc4m.onion) this is how you will connect to the game server in this case:

* Start by installing the game
 
 sudo apt-get install teg
(if it asks for a password type “changeme” if you haven’t changed it already and hit enter)

After it’s installed open up the game from the system menu “K” => Applications => Games => Tactics & Strategy => Tenes Empanadas Graciela client or type this in a terminal window:
 tegclient

When it starts it should open a “Connect to server” window. Otherwise open it from the menu “Game” => “Connect” or press “Connect”.

If it already says “2000” in the Server port field leave it as is.
Where it says “Server name” add the onion address, ie.
 w7jnpxhu3re5qarr.onion
Then choose a “Name” in the field for your playername and you’re good to go, press OK if you want to join the server.

In case you only want to observe the game and not play check the checkbox “Dont play, just observe” and then hit the OK button.

=== CONNECTING TO THE GAME - stealth auth Whonix 14 ===
This section is going to be written. If you can't wait until the "main editor" adds it you are free to add on this section yourself.

=== TEG SERVER - standard ===
These are instructions for hosting a game server for TEG. That you are using Whonix 14 is assumed.

The initial setup is heavily based on and inspired by instructions from the Whonix Wiki called “[http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/wiki/Onion_Services Onion Services]”

==== Go to the VirtualBox Whonix '''Gateway''' ... ====
...and open up a terminal and type
 sudo kwrite /usr/local/etc/torrc.d/50_user.conf
(after which you type your password which if not changed from the original is “changeme”)
and modify that file so it looks
like this:
 HiddenServiceDir /var/lib/tor/hidden_service/
 HiddenServicePort 2000 10.152.152.11:2000
 HiddenServiceVersion 3
 
 DisableNetwork 0
Save and close the file. For the changes to take effect open a terminal and type this command:
 sudo service tor@default reload
(enter the password mentioned previously if it asks for it)

To check if everything is ok type this command in a terminal:
 sudo service tor@default status
(enter the password if it asks for it)

If it says
 Active: active (running) since
where
 active (running)
should be in green, that means everything is just fine. If something went wrong please [http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/wiki/Onion_Services#Step_3:_make_changes_to_Tor_config_take_effect troubleshoot].

Now it’s time to find out which .onion address you can share with your friends so open up a terminal and type the command:
 sudo cat /var/lib/tor/hidden_service/hostname
(might ask for password)

The output of that command should be an .onion address with alphanumeric characters like this example that you can share with your friends so they can play on your server:
 w7jnpxhu3re5qarr.onion
 
Everything you did here was in Whonix Gateway. Now it is time to go to Whonix Workstation to edit the firewall!

==== Go to the VirtualBox Whonix '''Workstation''' ====
Open a terminal and type this command:
 sudo kwrite /etc/whonix_firewall.d/50_user.conf
(enter the password if it asks for one)

then enter this:
 EXTERNAL_OPEN_PORTS+=" 2000 "
and save.

In case you already have a webserver on port 80 and you also want to have this
game server then just change it to
 EXTERNAL_OPEN_PORTS+=" 80 2000 "

Now time to reload the firewall so type this command for that:
 sudo whonix_firewall
(enter the password if it asks for it)

Ok…now we are ready to begin starting the actual game server software because most of the previous section was related to setting up your whonix gateway so let’s begin!

Still in the Whonix Workstation open a console and type:
 tegserver
 
 The server is running now and you can share the .onion address that you got earlier.
In this example it is
 w7jnpxhu3re5qarr.onion
but for you it will(most probably) be different. If you do these instructions too quickly the link that was generated for you might not work…in such a case you need to be patient and wait until the time it works. If it doesn't work maybe ask somebody else to verify if the instructions still work.

=== TEG SERVER - stealth auth ===
Very basic protection against DDOS attacks done versus your server so follow this guide if you want to abandon the ‘single point of failure’ that is your only .onion address that all your players know(as of the previous “standard guide”). This section is to protect you against at least 1 bad player who wants to ddos your game server(regardless of reason). Let’s get to how this extra protection is gonna be enabled in practice:

==== Go to the VirtualBox Whonix '''Gateway''' ====
and open up a terminal and type
 sudo kwrite /usr/local/etc/torrc.d/50_user.conf
(after which you type your password which if not changed from the original is “changeme”)
and modify that file so it looks
like this:
 HiddenServiceDir /var/lib/tor/hidden_service/
 HiddenServicePort 2000 10.152.152.11:2000
 HiddenServiceVersion 3
 
 #1234567890123400 ends with 00 because this I plan to be the 'public address'
 #In the event the server gets a ddos attack the public address should be disabled
 #and if not done already give individual players that you trust
 #the addresses that are generated from the numbers ending with 01,02 etc.
 #max amount of addresses is until 1234567890123415 is reached because that amount+00
 #means 16 different .onion addresses which is the current max 
 #on this specific anti ddos design
 HiddenServiceAuthorizeClient stealth 1234567890123400,1234567890123401,1234567890123402,1234567890123403,1234567890123404,1234567890123405,1234567890123406,1234567890123407,1234567890123408,1234567890123409,1234567890123410,1234567890123411,1234567890123412,1234567890123413,1234567890123414,1234567890123415
 
 #The above long line is a total of 16 numbers. If you add another number 
 #Tor will refuse to reload so stick with 16.
 
 #not sure if we really need "DisableNetwork 0" but let's leave it as is. I didn't have it before but I re-added it just in case it is needed.
 DisableNetwork 0
Save and close the file. For the changes to take effect open a terminal and type this command:
 sudo service tor@default reload
(enter the password mentioned previously if it asks for it) '''or open the K menu, search for reload and click on “Reload Tor”(this is basically ''sudo service tor@default reload'' + ''sudo service tor@default status'' in one go)'''

Now it’s time to find out which .onion addresses you can share with your friends so open up a terminal and type the command:
 sudo cat /var/lib/tor/hidden_service/hostname
(might ask for password)

Since I’m going to regenerate all my .onion addresses by making new ones I’m posting what this might actually look like when you try it yourself. Your ‘player invites’ will look something like this:

 aokofajrpe4g2zrf.onion QlQlXlPdXyTUf6WIOf1tfR # client: 1234567890123400
 3wsajgpzqxytcsjo.onion Whi+D0Y/352YqMK3uTJNWx # client: 1234567890123401
 umaenixqbqevdk5a.onion TE1Biv1JFjveN/mQqWOmSh # client: 1234567890123402
 gwumcsrrfkc3kne5.onion VYzN3LVk9DVhbp3TRQuDXB # client: 1234567890123403
 vuhiosfqgegorbkh.onion P5ns2xtCC+VJAVeW3FrC+x # client: 1234567890123404
 jye4cftpe6xq2eka.onion vnCPwf6RWWMkv9iCKDZHlh # client: 1234567890123405
 gvzl37orywkzxtr7.onion H+izJm1pwnt+FMdJnL2MWh # client: 1234567890123406
 hdtjcfdpcnnnxws3.onion H6XIO5+ts0mz2AtBcbEJOx # client: 1234567890123407
 gdgj2p5k7jqgv3k7.onion RvnG94Blww6jDLSpQSZW1B # client: 1234567890123408
 6np4ynkdqg7e2cmx.onion X1st9nX4486nwJ9LmbJDNx # client: 1234567890123409
 ywabarc6ziuwdhbl.onion ym9me7GXGUctLJwTgyWhgh # client: 1234567890123410
 agyinmgx7qeodrx2.onion 6YUDbaghoXr0LWSoso7MeR # client: 1234567890123411
 6xsjhpgrmf2rbnka.onion JP7giIIzLmhhn2r3EcbWWB # client: 1234567890123412
 5fixfx3mvvj5cu7u.onion wmxp4ZoPmFb31WoCS2d/8B # client: 1234567890123413
 rczg4s5reivwhd7p.onion pl/3phzLLB4hHsknnfOOxB # client: 1234567890123414
 yl6ulm2lzvtsvdfx.onion G0v/YtNeaCgBuvFw6QfTTR # client: 1234567890123415
 
I posted the above because I’ve already changed the client numbers for all my 16 addresses already to begin with and reloading Tor after changing something in your client numbers makes Tor regenerating a new address for each of those 16 possible clients/‘groups of players’ where you changed an id. Right now I don’t have the above addresses so I took the step to post how it actually looked like when I followed the guide myself and that’s what you see above. Also when Tor generates new addresses it also generates the ‘gibberish’ that you see right next to each .onion address, let’s take the .onion address yl6ulm2lzvtsvdfx.onion as an example. To the right of that address there is this number “G0v/YtNeaCgBuvFw6QfTTR” which is going to be explained later in this guide.
 
 ''Credits''
This guide wouldn’t be possible without [http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/wiki/Onion_Services#Tor_Onion_Services_-_EASY Tor Onion Services - EASY guide]

|}

= See Also =
* [[Hosting_Location_Hidden_Services|Hosting Location Hidden Services]]
* [[Onion_Services|Onion Services]]

= References =
{{reflist|close=1}}

{{Footer}}

[[Category:Documentation]]
