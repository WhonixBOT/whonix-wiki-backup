{{Header}}
{{#seo:
|description=Hosting a bridge, private bridge, or obfuscated bridge in Whonix. Hosting a middle or exit Tor relay in Whonix
|image=https://www.{{project_clearnet}}/w/images/5/58/Moving-stairs-918559640.jpg
}}
[[image:Moving-stairs-918559640.jpg|thumb]]
__FORCETOC__

= Introduction =

You can still volunteer to Tor and host a bridge, private bridge, obfuscated bridge, private obfuscated bridge, middle node or exit relay when you are using {{project_name}}. Either inside the {{gateway_product_name}} or directly on the host.

= Rationale =
Hosting a Tor relay and/or bridge and using it to mix one's own traffic <u>might</u> be beneficial for anonymity. Advanced users only! Please refer to the write-ups by The Tor Project, the developers of the Tor software.

Quote The Tor Project [https://blog.torproject.org/new-low-cost-traffic-analysis-attacks-mitigations New low cost traffic analysis attacks and mitigations]:

<blockquote>In terms of mitigating the use of these vectors in attacks against Tor, here's our recommendations for various groups in our community:

Users: Do multiple things at once with your Tor client
Because Tor uses encrypted TLS connections to carry multiple circuits, an adversary that externally observes Tor client traffic to a Tor Guard node will have a significantly harder time performing classification if that Tor client is doing multiple things at the same time. This was studied in [http://cacr.uwaterloo.ca/techreports/2015/cacr2015-09.pdf section 6.3 of this paper] by Tao Wang and Ian Goldberg. A similar argument can be made for mixing your client traffic with your own Tor Relay or Tor Bridge that you run, but that is [https://github.com/mikeperry-tor/vanguards/blob/master/README_SECURITY.md#the-best-way-to-run-tor-relays-or-bridges-with-your-service very tricky to do correctly] for it to actually help.</blockquote>

= Configuration =
== Outside the {{gateway_product_name}} ==
[[Undocumented]].

== Inside the {{gateway_product_name}} ==
=== Introduction ===
This chapter hasn't been tested for a long time. Get in contact if you are interested in this configuration.

This is non-trivial for reasons outside of {{project name}} control. For a large part [[Unspecific|unspecific to {{project name}}]]. It requires an open port to permit acceptance of unsolicited incoming connections. See [[Ports]] for explanation.

=== Prerequisite Knowledge ===
Various learning exercises are recommended before attempting to this set this up:

'''A)''' Set up web server reachable on PC. For example:

internet &rarr; home router &rarr; PC &rarr; web server

'''B)''' web server reachable in VM. i.e.
internet &rarr; home router &rarr; PC &rarr; Debian (not {{project name}}) VM &rarr; web server

'''C)''' Only then try to do the same with {{project name}} with Tor.

=== Instructions ===
On the {{gateway_product_name}}.

'''1.''' Simply follow all the usual instructions given on torproject.org inside the {{gateway_product_name}} just as you would, if Tor wouldn't run inside a virtual machine.

'''2.''' Set up a port forwarding from the host to the virtual machine.

* [[KVM]]: Follow the [http://wiki.libvirt.org/page/Networking#Forwarding_Incoming_Connections NAT port forwarding instructions] for {{gateway_product_name}}.
* [[VirtualBox]]: You can also do this with the VirtualBox graphical user interface.

Go to {{gateway_product_name}} &rarr; Settings &rarr; Network Interface &rarr; Port Forwarding.

'''3.''' Look at [https://github.com/Whonix/whonix-firewall/blob/master/etc/whonix_firewall.d/30_whonix_gateway_default.conf <code>/etc/whonix_firewall/30_default.conf</code>].

'''4.''' Read the introduction comment about [[Configuration_Files|flexible modular configuration files]].

'''5.''' Read the comment about Tor Relay Settings.

'''6.''' Close the file.

'''7.''' {{Firewall Settings}}

'''8.''' Paste the following content. Adjust if necessary.

{{CodeSelect|code=
## Allow incoming DIRPORT connections for an optional Tor relay.
GATEWAY_ALLOW_INCOMING_DIR_PORT=1

## Allow incoming ORPORT connections for an optional Tor relay.
GATEWAY_ALLOW_INCOMING_OR_PORT=1

## DIRPORT incoming port.
DIR_PORT=80

## ORPORT incoming port.
OR_PORT=443
}}

'''9.''' {{Reload Firewall}}

'''10.''' Done.

= Other Easy Options =
As a Firefox or Chrome browser / Chromium user, install an add-on to create a "flash" proxy bridge. "Flash" as in flashing proxy, not as in Adobe Flash. This has nothing to do with Adobe Flash.

For Chrome browser / Chromium, there is [https://chrome.google.com/webstore/detail/cupcake/dajjbehmbnbppjkcnpdkaniapgdppdnc cupcake]. Simply click to install the add-on and you're done.

For Firefox browser, there is [https://addons.mozilla.org/firefox/addon/tor-flashproxy-badge/ Tor Flashproxy Badge]. Simply click to install the add-on and you're done.

{{Footer}}

[[Category:Documentation]]
