{{Header}}
{{#seo:
|description=Hosting a bridge, private bridge, or obfuscated bridge in Whonix. Hosting a middle or exit Tor relay in {{project_name}} |image=https://www.{{project_clearnet}}/w/images/5/58/Moving-stairs-918559640.jpg
}}
[[image:Moving-stairs-918559640.jpg|thumb]]
__FORCETOC__

= Introduction =

When using {{project_name}}, it is still possible to volunteer to Tor by hosting a bridge, private bridge, obfuscated bridge, private obfuscated bridge, middle node or exit relay. This configuration is set up either inside {{gateway_product_name}} or directly on the host.

= Rationale =

{{mbox
| type    = notice
| image   = [[File:Ambox_notice.png|40px|alt=Info]]
| text    = This configuration is recommended for advanced users.
}}

Anonymity <u>might</u> be improved by hosting a Tor relay and/or bridge and using it to mix personal client Tor traffic. The reason is adversaries observing traffic will need to perform classification of both traffic generated by the Tor relay or bridge and your personal client traffic. To learn more about this topic, refer to posts by The Tor Project (developers of the Tor software). <ref>Also see: [https://cacr.uwaterloo.ca/techreports/2015/cacr2015-09.pdf On Realistically Attacking Tor with Website Fingerprinting].</ref>

Quote The Tor Project [https://blog.torproject.org/new-low-cost-traffic-analysis-attacks-mitigations New low cost traffic analysis attacks and mitigations]:

<blockquote>In terms of mitigating the use of these vectors in attacks against Tor, here's our recommendations for various groups in our community:

Users: Do multiple things at once with your Tor client
Because Tor uses encrypted TLS connections to carry multiple circuits, an adversary that externally observes Tor client traffic to a Tor Guard node will have a significantly harder time performing classification if that Tor client is doing multiple things at the same time. This was studied in [https://cacr.uwaterloo.ca/techreports/2015/cacr2015-09.pdf section 6.3 of this paper] by Tao Wang and Ian Goldberg. A similar argument can be made for mixing your client traffic with your own Tor Relay or Tor Bridge that you run, but that is [https://github.com/mikeperry-tor/vanguards/blob/master/README_SECURITY.md#the-best-way-to-run-tor-relays-or-bridges-with-your-service very tricky to do correctly] for it to actually help.</blockquote>

= Configuration =
== Outside the {{gateway_product_name}} ==
[[Undocumented]].

== Inside the {{gateway_product_name}} ==
=== Introduction ===
This chapter hasn't been tested for a long time. Get in contact if you are interested in this configuration.

This is non-trivial for reasons outside of {{project name}} control. For a large part [[Unspecific|unspecific to {{project name}}]]. It requires an open port to permit acceptance of unsolicited incoming connections. See [[Ports]] for explanation.

=== Prerequisite Knowledge ===
Various learning exercises are recommended before attempting to this set this up:

'''A)''' Set up web server reachable on PC. For example:

internet &rarr; home router &rarr; PC &rarr; web server

'''B)''' web server reachable in VM. i.e.
internet &rarr; home router &rarr; PC &rarr; Debian (not {{project name}}) VM &rarr; web server

'''C)''' Only then try to do the same with {{project name}} with Tor.

=== Instructions ===

{{Box|text=
Perform these steps in {{gateway_product_name}} (<code>sys-whonix</code>).

'''1.''' Follow all the usual instructions on the <code>torproject.org</code> website inside  {{gateway_product_name}}; the fact that Tor is being run inside a virtual machine does not change the procedure.

'''2.''' Set up a port forwarding from the host to the virtual machine.

* [[KVM]]: Follow the [https://wiki.libvirt.org/page/Networking#Forwarding_Incoming_Connections NAT port forwarding instructions] for {{gateway_product_name}}.
* [[VirtualBox]]: Port forwarding can also be set using the VirtualBox GUI.

Navigate to <code>{{gateway_product_name}}</code> &rarr; <code>Settings</code> &rarr; <code>Network Interface</code> &rarr; <code>Port Forwarding</code>

'''3.''' Inspect [https://github.com/Whonix/whonix-firewall/blob/master/etc/whonix_firewall.d/30_whonix_gateway_default.conf <code>/etc/whonix_firewall/30_default.conf</code>].

'''4.''' Read the introductory comment about [[Configuration_Files|flexible modular configuration files]].

'''5.''' Read the comment about Tor Relay Settings.

'''6.''' Close the file.

'''7.''' {{Firewall Settings}}

'''8.''' Paste the following content and make adjustments if necessary.

{{CodeSelect|code=
## Allow incoming DIRPORT connections for an optional Tor relay.
GATEWAY_ALLOW_INCOMING_DIR_PORT=1

## Allow incoming ORPORT connections for an optional Tor relay.
GATEWAY_ALLOW_INCOMING_OR_PORT=1

## DIRPORT incoming port.
DIR_PORT=80

## ORPORT incoming port.
OR_PORT=443
}}

'''9.''' {{Reload Firewall}}

'''10.''' The procedure is complete.
}}

= Other Easy Options =
As a Firefox or Chrome browser / Chromium user, install an add-on to create a "flash" proxy bridge. "Flash" as in flashing proxy, not as in Adobe Flash. This has nothing to do with Adobe Flash.

For Chrome browser / Chromium, there is [https://chrome.google.com/webstore/detail/cupcake/dajjbehmbnbppjkcnpdkaniapgdppdnc cupcake]. Simply click to install the add-on and you're done.

For Firefox browser, there is [https://addons.mozilla.org/firefox/addon/tor-flashproxy-badge/ Tor Flashproxy Badge]. Simply click to install the add-on and you're done.

{{Footer}}

[[Category:Documentation]]
