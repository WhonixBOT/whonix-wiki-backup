{{Title|
title=HowTo: Install the Stable Version of Qubes-Whonix {{VersionShort}}
}}
{{Header}}
{{#seo:
|description=How to Install Qubes-Whonix {{VersionShort}}
|image=https://www.whonix.org/w/images/5/55/Qubes-logo-icon.png
}}
__NOTOC__
== Introduction ==
{{Template:Qubes}}

'''First time user?'''<br />
{{First_Time_User}}

'''Installation'''<br />
These instructions apply to Qubes R3.2 and above.

== Remove Old Versions ==

Users who are already running any version of Qubes-Whonix must [[Qubes/Uninstall|uninstall it]] before performing a complete (re-)installation. This applies to:

* Users who selected Qubes-Whonix auto-configuration when Qubes was installed.
* Users who installed Qubes-Whonix after installing the Qubes platform.

Re-installation will destroy any existing user data stored in Whonix VMs, unless it is backed up first. To avoid this scenario, it is possible to [[Upgrading Whonix 13 to Whonix 14|upgrade Whonix 13 to 14]] instead of following these instructions.

== Update dom0 ==
=== All Qubes Versions ===
To launch a dom0 terminal, click the Qubes App Launcher (blue/grey "Q") and then open the Terminal Emulator (Xfce Terminal).

[[File:qubes-whonix1.png]]

Update Qubes dom0.

{{CodeSelect|code=
sudo qubes-dom0-update
}}

== Configure sys-whonix and anon-whonix ==

To use <code>salt</code> to set up <code>sys-whonix</code> and <code>anon-whonix</code>, run. <ref>
[[Dev/Qubes#salt]]</ref> <ref>
https://github.com/QubesOS/qubes-mgmt-salt-dom0-virtual-machines/blob/master/qvm/anon-whonix.sls
</ref>

{{CodeSelect|code=
sudo qubesctl state.sls qvm.anon-whonix
}}

If an error message appears stating that qubesctl does not exist or the command is not recognized, then it is necessary to enable the testing repository and install <code>salt</code>.

{{CodeSelect|code=
sudo qubes-dom0-update --enablerepo=qubes-dom0-current-testing qubes-mgmt-salt-dom0-virtual-machines
}}

Sometimes the Qubes Community Templates repository must also be enabled by editing <code>/etc/yum.repos.d/qubes-templates.repo</code> and setting <code>enabled = 1</code> in the <code>[qubes-templates-community]</code> section.

If qubesctl still does not work, try shutting down Qubes OS and rebooting the machine.

== Qubes R4 Only: Optional Whonix DVM Template VM ==

In Qubes R4 and above, users can choose to set up a <code>whonix-ws-dvm</code> DVM Template as a base for [[Qubes/Disposable_VM|Disposable VMs]]. <ref>https://github.com/QubesOS/qubes-mgmt-salt-dom0-virtual-machines/blob/master/qvm/whonix-ws-dvm.sls
</ref>

{{CodeSelect|code=
sudo qubesctl state.sls qvm.whonix-ws-dvm
}}

== Optional: Updates over Tor ==

=== TemplateVMs ===

To force all TemplateVM updates over Tor: <ref>https://github.com/QubesOS/qubes-mgmt-salt-dom0-virtual-machines/blob/master/qvm/updates-via-whonix.sls
</ref>

* '''R3.2:''' For each template, manually open VM settings and set NetVM to <code>sys-whonix</code>.
* '''R4:''' The following salt command can be used:
** {{CodeSelect|code=
sudo qubesctl state.sls qvm.updates-via-whonix
}}

=== dom0 ===

To force dom0 updates over Tor, set Qubes dom0 UpdateVM to <code>sys-whonix</code>.

{{CodeSelect|code=
qubes-prefs updatevm sys-whonix
}}

== Optional: Enable AppArmor ==
{{Qubes_AppArmor}}

== Update and Launch Applications ==
 
Users can now [[Qubes/Update|update both Whonix-Gateway and Whonix-Workstation TemplateVMs]], before starting applications in the Whonix-Workstation AppVM. For example, to start [[Tor Browser|Tor browser]]:

<code>
Qubes App Launcher (blue/grey "Q") -> {{Code2|Domain: anon-whonix}} -> Privacy Browser
</code>

To learn about known bugs affecting this release, see [[Known_Issues#Missing_anon-whonix_Qubes_Appmenu_Entries|here]].

== Additional Information ==  
<div class="toccolours mw-collapsible mw-collapsed" style="width:800px">
If you are interested, click on Expand on the right.
<div class="mw-collapsible-content">
* {{Post Install Advice}}
* [[#Stay tuned|Stay tuned]]!

== Known Bugs ==
{{Known_bugs}}

==  Stay Tuned ==
{{Stay_tuned}}
</div>
</div>
== Footnotes ==
{{reflist|close=1}}
{{Template:Qubes}}
{{Footer}}
[[Category:Documentation]]
