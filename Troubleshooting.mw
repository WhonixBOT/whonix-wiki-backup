{{Header}}
{{#seo:
|description=Troubleshooting Installation and Network Issues with Whonix
|image=https://www.whonix.org/w/images/8/81/Troubleshooting-114197640.jpg
}}

= Introduction =

The following steps summarize basic troubleshooting instructions, which are described in greater detail below. In basic terms:

# [[{{non q project name short}}|{{non q project name}}]] only: [[Verify_the_{{project_name_short}}_images|Verify the {{project_name}} virtual machine images]] if this has step has not previously been completed.
# Ensure the virtual machine images have been imported into a supported virtualizer.
# Check if [https://www.torproject.org/download/download-easy.html.en Tor Browser] works on the host.
# Check if other virtual machines have Internet connectivity, such as newly created ones or those from a different vendor.

Information pertaining to these points should be included in any support request or bug report.

= Troubleshooting Steps =

== General ==

It is recommended to first test if the host Internet connection is functional by using ping. <ref>For example, ping 8.8.8.8, ping google.com and so on.</ref> On the host, run.

{{CodeSelect|code=
ping google.com
}}

Check the date and time.

{{CodeSelect|code=
date
}}

The following command should not show any errors. <ref name=lengthy_test>This process can be lengthy.</ref>

{{CodeSelect|code=
sudo dpkg-reconfigure -a
}}

The following command should be silent and not show any errors or output at all. <ref name=lengthy_test />

{{CodeSelect|code=
sudo dpkg --configure -a
}}

Next attempt to retrieve all available updates.

{{CodeSelect|code=
sudo apt-get update
}}
{{CodeSelect|code=
sudo apt-get dist-upgrade
}}

Download the Tor Browser Bundle from [https://www.torproject.org/download/download-easy.html.en torproject.org] and test if it is working on the host; follow one of the methods outlined in [[Install_Tor_Browser_Outside_of_Whonix|Non-{{project_name}} Tor Browser]].

If the Tor Browser Bundle is not functional on the host, then {{project_name}} is unlikely to work either. It is recommended to have a recent Tor Browser Bundle version installed at all times. This way users can test if they live in a censored area or not and whether Tor is blocked by the ISP. Further, if (private) (obfuscated) bridges are necessary for Tor Browser Bundle functionality on the host, then {{project_name}} will similarly require them.

== {{project_name}} Network Connectivity Problems ==

If networking is unavailable inside {{project_name}}, then try:

# Installing an operating system in a non-{{project_name}} virtual machine or downloading a regular image without Tor enforcement.
# Testing network functionality in a freshly downloaded non-{{project_name}} virtual machine.

If networking is still not functional, then {{project_name}} will not work either. The user must first resolve this issue, which might require re-installation of the virtualizer, followed by a reboot and further connectivity test(s).

If networking is functional, then users should note that networking is working in non-{{project_name}} VMs as part of the support request or bug report.

== whonixcheck ==

Run [[whonixcheck]] to verify that the {{project_name}} system is up-to-date and that everything is in proper working order.

== Clock Fix ==

The first step should be completed on the host to ensure the host clock is set to the correct time.

On the host ([[{{q project name short}}|{{q project name}}]]: <code>dom0</code>), run the following command to report the time in UTC.

<pre>
date -u
</pre>

The output should be similar to the following.

<pre>
Mon Apr 22 04:30:44 UTC 2019
</pre>

To set the correct time in {{gateway_product_name}} (<code>sys-whonix</code>), run the following command with the correct date and time parameters.

<pre>
sudo date --set "Mon Apr 22 04:30:44 UTC 2019"
</pre>

Tor should work once correct clock values are set, but that can be manually tested with [[whonixcheck]].

Next restart sdwdate.

<pre>
sudo service sdwdate restart
</pre>

If Tor is still not functional, try restarting Tor.

<pre>
sudo service tor restart
</pre>

== Clearnet Connectivity Test ==

{{mbox
| image   = [[File:Ambox_warning_pn.svg.png|40px]]
| text       = '''Warning:''' The following test might reveal the {{project_name}} platform is in use. If that is a valid concern, then omit this step.
}}


Users can check if a non-torified, non-anonyomus, direct connection to check.torproject.org is functional. <ref>This test only uses TCP and not DNS.</ref>

On {{gateway_product_name}}, run.

{{CodeSelect|code=
sudo -u clearnet {{Curl Plain}} {{Curl Secure}} -H 'Host: check.torproject.org' -k https://{{Check.torproject.org IP}} | grep IP
}}

== Qubes-specific ==

=== Connectivity Issue ===

Complete the following steps:

# Shut down <code>sys-whonix</code>. 
# Change the <code>sys-whonix</code> NetVM setting from <code>sys-firewall</code> to <code>sys-net</code>.
# Restart </code>sys-whonix</code>. 

This procedure might help, but should not be considered a final solution. <ref>This procedure was useful for [[{{q_project_name_short}}|{{q_project_name}}]] R3.2 users, although the Qubes bug report is now resolved: https://github.com/QubesOS/qubes-issues/issues/2141</ref>

== Low RAM Issues ==

When inadequate RAM is available to meet the {{project_name}} VM requirements, problems can emerge which make the VM(s) unusable. Factors that commonly contribute to low RAM issues in {{project_name}} include: 

* Unnecessary processes running and/or multi-tasking on the host OS.
* Multiple browser tabs being open.
* Unnecessary processes running in the {{project_name}} VM(s).
* Allocating more RAM to the {{project_name}} VM than is available; this prevents the VM from booting. 
* Insufficient RAM allocated to the {{project_name}} VM(s).
* Other non-{{project_name}} VMs running in parallel.

While insufficient RAM can cause a host of issues, behaviors most commonly seen with low memory resources include:

* Applications are slow or unresponsive.
* The virtual machine, mouse and/or keyboard freeze.
* Scrolling causes window staggers or jumps.
* Issues become worse when additional browser tabs or processes are spawned.
* Overall performance is poor.

=== Free up Additional Memory Resources ===

If additional memory is needed for the virtual machine, users can free up resources and/or add more RAM to the virtual machine:

* Terminate any non-essential processes on the host.
* Shutdown any non-essential VMs.
* Shutdown and/or close non-essential processes and browser tabs in {{project_name}} VMs. 
* [[{{non q project name short}}|{{non q project name}}]] only: If users are experiencing low memory issues in {{workstation_product_name}}, additional resources can be freed by reducing RAM in {{gateway_product_name}} with [[RAM_Adjusted_Desktop_Starter|rads]].

To add additional RAM to the {{project_name}} VM(s), follow the platform-specific advice below.

=== KVM ===

# Shutdown the virtual machine(s). {{CodeSelect|code=
virsh -c qemu:///system shutdown <vm_name>
}}
# Increase maximum memory. {{CodeSelect|code=
virsh setmaxmem <vm_name> <memsize> --config
}}
# Set actual memory. {{CodeSelect|code=
virsh setmem <vm_name> <memsize> --config
}}
# Restart the virtual machine(s). {{CodeSelect|code=
virsh -c qemu:///system start <vm_name>
}}

=== [[{{q_project_name_short}}|{{q_project_name}}]] ===

Utilize Qube Manager: <br />
* <code>Qube Manager</code> -> <code>VM_name</code> -> <code>Qubes s<u>e</u>ttings</code> -> <code>Advanced</code> -> <code>Max memory:</code> <code><i>mem_size</i></code>

=== VirtualBox ===

# To add RAM in VirtualBox the VM <u>must</u> first be powered down. 
# <code>Virtual machine</code> -> <code>Menu</code> -> <code>Settings</code> -> <code><i>Adjust</i></code> <code>Memory slider</code> -> <code><i>Hit:</i> OK</code>

= Footnotes =
{{reflist|close=1}}

{{Footer}}

[[Category:Documentation]]
