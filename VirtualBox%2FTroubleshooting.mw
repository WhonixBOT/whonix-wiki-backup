{{Header}}
{{#seo:
|description=VT-x is disabled in the BIOS. / VERR_VMX_MSR_VMXON_DISABLED / VERR_SSM_FIELD_NOT_CONSECUTIVE / supR3HardenedWinReSpawn / Enable VT-x in BIOS / Aborted Status / Guru Mediation
|image=https://www.whonix.org/w/images/8/81/Troubleshooting-114197640.jpg
}}
{{title|title=
{{project_name}} in VirtualBox - Troubleshooting - {{project_name}} does not Start?
}}
{| class="wikitable" style="background-color:#fff;text-align:center"
|- style="background-color: #f9f9f9"
| [[#BIOS|<code>VERR_VMX_MSR_VMXON_DISABLED</code> / <code>VERR_NEM_NOT_AVAILABLE</code> &rarr; Enable <code>VT-x</code> in BIOS settings.]]
|}
{| class="wikitable" style="background-color:#fff;text-align:center"
|- style="background-color: #f9f9f9"
| Black screen? &rarr; [[#Black Screen|See this]].
| Aborted Status? &rarr; [[#Aborted Status|See this]].
| Guru Mediation? &rarr; [[#Guru Mediation|See this]].
|}
Topics on this page are sorted roughly in order of issue prevalence. More common issues are on top.
__TOC__
= General VirtualBox Troubleshooting Steps =
[[File:Ambox_notice.png|25px|link=]] In many situations, the following steps will fix VirtualBox issues.
{{Box|text=
# [[File:{{project_name_short}}_old_logo.png|25px|link=]] Use the stable version of [[VirtualBox|{{Project name}} for VirtualBox]] <code>{{VersionNew}}</code>.
# [[File:Computer_n_screen.png|25px|link=]] [[File:Virtualbox_logo.png|25px|link=]] Use the [[VirtualBox/Recommended_Version|recommended]] VirtualBox <u>host</u> software version {{VirtualBox_Version}}.
# [[File:cli3.png|25px|link=]] [[File:Virtualbox_logo.png|25px|link=]] To ensure the recommended version of VirtualBox guest additions is installed in {{Project name}}, in both {{gateway_product_name}} <u>VM</u> and {{workstation_product_name}} <u>VM</u> run. {{CodeSelect|code=
sudo apt-get update && sudo apt-get dist-upgrade
}}
# [[File:Cd-699786640.jpg|25px|link=]] [[File:Virtualbox_logo.png|25px|link=]] Do <u>not</u> use [[VirtualBox/Guest_Additions#VirtualBox_Guest_Additions_CD|VirtualBox guest additions from CD]]. <ref>
[https://forums.whonix.org/t/virtualbox-guest-additions/8998/3 Installation of VirtualBox guest additions from CD might also cause issues.]
</ref>
# [[File:Tux.png|15px|link=]] Linux users only: use the recommended host Linux kernel version. That the same version as Debian <code>{{Stable project version based on Debian codename}}</code> is using [https://packages.debian.org/buster/linux-image-amd64 <code>linux-image-amd64</code>]. <ref>
Host freezing reported with newer kernel version: https://forums.whonix.org/t/recommended-specs/9679/14
</ref>
# [[File:Tux.png|15px|link=]] Linux users only: use the [[Host_Operating_System_Selection#Recommended_Linux_Distribution|recommended]] Linux distribution [https://www.debian.org/ Debian Linux] version <code>{{Stable project version based on Debian codename}}</code> as host operating system.
# [[File:Tux.png|15px|link=]] Linux users only: Add your current user to group <code>vboxusers</code>. <ref>
Optional: See: https://www.virtualbox.org/manual/ch02.html#install-linux-vboxusers

Also spams <code>~/.config/VirtualBox/VBoxSVC.log</code> log if not done.
</ref> {{CodeSelect|code=
sudo adduser $(whoami) vboxusers
}}
# [[File:Windows_logo_-_2012.svg.png|15px|link=]] Windows users only: consider running {{Project name}} from a Linux computer rather than Windows computer, see [[Host Operating System Selection]]. <ref>
[https://forums.whonix.org/t/gateway-startup-error-not-syncing-no-working-init-found/9481/13 A user reported issues which were gone once switching to Linux].
</ref>
# Do you have virtualizers other than VirtualBox installed at the same time such as [[image:Vmware.jpeg|15px|link=]] VMware, VirtualPC or [[Image:Kvmbanner-logo26.png|15px|link=]] KVM? If you never heard of this product names or don't know what that means then this probably is not your issue. Otherwise don't. See footnote for more information. <ref>
Virtualizers are incompatible with co-installation of other virtualizers at the same time. This is virtualizer specific, not {{project name}} specific limitation. Uninstall any other virtualizers and perhaps re-install VirtualBox if still not functional.

https://forums.whonix.org/t/starting-xcfe-virtualbox-give-guru-meditation/10378/6
</ref>
# Perhaps a [[Troubleshooting#Low_RAM_Issues|Low RAM issue]]? [[Troubleshooting#Free_up_Additional_Memory_Resources|Free up Additional Memory Resources]] and try {{gateway_product_name}} CLI RAM Saving Mode as per [[RAM|Advice for Systems with Low RAM]].
# Exclude basic [[Troubleshooting#Hardware Issues|hardware issues]].
# Run <code>memtestx86+</code>.
# [[#Try a non-Whonix VM|Try a non-Whonix VM]].
# [[File:Windows_logo_-_2012.svg.png|15px|link=]] Windows <u>10</u> users only: [https://forums.whonix.org/t/hash-sum-mismatch-downloads-all-fail-since-win10-2004-update/9740/2 Hash Sum mismatch?]
}}

= VT-x =

== VERR_SSM_FIELD_NOT_CONSECUTIVE ==

If the "{{Code2|Failed to load unit 'PATM' (VERR_SSM_FIELD_NOT_CONSECUTIVE).}}" error appears, <code>VT-x</code> must be enabled in BIOS settings, see [[#BIOS|instructions]].

{{Anchor|VT-x_is_disabled_in_the_BIOS.}}
{{Anchor|VT-x}}

== VT-x is disabled in BIOS ==
[[File:VERR_VMX_MSR_VMXON_DISABLED.png|<code>VERR_VMX_MSR_VMXON_DISABLED</code><br/><code>VERR_NEM_NOT_AVAILABLE</code>|thumb]]

If the following error message appears.

<pre>
Failed to open a session for the virtual machine Whonix-Gateway-XFCE.

VT-x is disabled in the BIOS.
(VERR_VMX_MSR_VMXON_DISABLED).
</pre>

Or.

<pre>
AMD-V is disabled in the BIOS (or by the host OS).
(VERR_SVM_DISABLED).
</pre>

Then [[#BIOS|enable]] <code>VT-x</code> in BIOS settings.

{{Anchor|BIOS}}

== Enable VT-x in BIOS ==

Go to your BIOS settings. For basic instructions, see: [https://www.wikihow.com/Change-Computer-BIOS-Settings How to Change Computer BIOS Settings].

Then enable <code>VT-x</code>. This is sometimes also called <code>AMD-V</code>, <code>virtualization</code>, <code>SVM mode</code> or <code>MIT</code> perhaps under <code>Advanced Core</code> settings.

= Updating/Upgrading while VMs are Running =

== Error In supR3HardenedWinReSpawn ==

[[File:VirtualBox_supR3HardenedWinReSpawn.png|400px]]<br />
Do not update whilst the VMs are running, otherwise [[VirtualBox]] must be reinstalled.

== VMMR0InitVM: Revision mismatch ==

<pre>
debian kernel: VMMR0InitVM: Revision mismatch, r3=132055 r0=130347
</pre>

This happens when upgrading VirtualBox on the host while existing VMs are still running. The solution is to shut down and restart all VMs.

= Disk Space =

== E_INVALIDARG (0x80070057) ==

This might relate to a low disk space issue -- research the issue further with search engines.

= Non-functional Shared Clipboard and Drag and Drop =

If the shared clipboard and drag’n’drop to/from host is non-functional, this can relate to the version of guest additions installed in Whonix and/or the version of VirtualBox running on the host. <ref>
* http://forums.whonix.org/t/whonix-15-shared-clipboard-and-dragndrop-not-working/7723
* Upstream bug report: [https://www.virtualbox.org/ticket/19336 Linux guest: shared clipboard doesn't work (on fresh VirtualBox-6.1.4-136177) => fixed in 6.1.6]
</ref>

# Apply [[#General_VirtualBox_Troubleshooting_Steps|General VirtualBox Troubleshooting Steps]].
# <code>VirtualBox</code> &rarr; <code>Settings</code> &rarr; <code>General</code> &rarr; <code>Advanced tab</code> &rarr; <code>'Check' shared clipboard and drag and drop</code>

It might still not work, see: [[Dev/VirtualBox#VirtualBox_Guest_Additions_Bugs|VirtualBox Guest Additions Bugs Reporting]].

= Screen Issues =

== Screen Resolution Bug ==

{{Anchor|VirtualBox Screen Resolution Bug}}

[[File:cli4.png|thumb|VirtualBox Screen Resolution Bug]]
[[File:cli3.png|thumb|Normal presentation]]

If the display presents like the image on the right-hand side, then you are affected by a screen resolution bug which only occurs in VirtualBox.

To correct the resolution, first apply the [[VirtualBox/Troubleshooting#General_VirtualBox_Troubleshooting_Steps|General VirtualBox Troubleshooting Steps]].

If the issue still persists, try one of the following workarounds to correct the resolution.

'''VirtualBox Virtual Screen Menu Workaround'''

# Power off the VM.
# Restart the VM.
# Maximize the VM window after start of the VM as soon as possible.
# <code>VirtualBox VM Window</code> &rarr; <code>View</code> &rarr; <code>Virtual Screen 1</code> &rarr; <code>Choose any, resize to another resolution</code>
# <code>VirtualBox VM Window</code> &rarr; <code>View</code> &rarr; <code>Auto-resize Guest Display</code>
-----
'''Desktop Resolution Settings Workaround'''

If the method above did not work, another option is the following. Inside the virtual machine:

<code>XFCE Start Menu</code> &rarr; <code>Settings</code> &rarr; <code>Display</code> &rarr; <code>Resolution:</code> &rarr; <code>Choose a higher resolution resolution</code> &rarr; <code>Apply</code>
-----
'''VirtualBox VMSVGA Graphics Controller Setting Workaround'''

If it still does not work, a final option is the following.

Inside the virtual machine <ref>
VirtualBox VMSVGA graphics controller is based on the VMware graphics controller.
</ref>:

On the host:

# Power off the VM.
# <code>VirtualBox</code> &rarr; <code>click a VM</code> &rarr; <code>Settings</code> &rarr; <code>Display</code> &rarr; <code>Graphics Controller</code> &rarr; <code>VMSVGA</code> &rarr; <code>OK</code> (This is already the case in newer Whonix ™ versions.)
# <code>VirtualBox</code> &rarr; <code>click a VM</code> &rarr; <code>Settings</code> &rarr; <code>Display</code> &rarr; <code>Graphics Controller</code> &rarr; <code>increase slider for Video Memory to 128</code> &rarr; <code>OK</code> (This is already the case in newer {{Project name}} versions.)
# Restart the VM.
# Maximize the VM window after start of the VM as soon as possible.
# If necessary, try again one of above workarounds.
-----
'''VirtualBox Guest Additions Bugs Reporting'''

Occasionally screen resolution problems might still persist, see: [[Dev/VirtualBox#VirtualBox_Guest_Additions_Bugs|VirtualBox Guest Additions Bugs Reporting]].

== Black Screen ==

If a black screen appears, try the following possible solutions.

# Install the [[VirtualBox/Recommended_Version|recommended]] version of the VirtualBox host software.
# Apply the [[#General_VirtualBox_Troubleshooting_Steps|General VirtualBox Troubleshooting Steps]].
# Reboot.
# If the issue persists, try the following workarounds.

If this solution or any of the workarounds worked for you, please report this in [https://forums.whonix.org {{project name}} forums].

-----
'''Workaround 1: Try Other VirtualBox Virtual Graphics Controller Settings'''
# Power off the VM.
# <code>VirtualBox</code> &rarr; <code>click a VM</code> &rarr; <code>Settings</code> &rarr; <code>Display</code> &rarr; <code>Graphics Controller</code> &rarr; <code>VMSVGA</code> &rarr; <code>OK</code> (Or try other settings there.) <ref>

{{CodeSelect|code=
VBoxManage modifyvm Whonix-Gateway-XFCE --graphicscontroller vmsvga
}}

{{CodeSelect|code=
VBoxManage modifyvm Whonix-Gateway-XFCE --graphicscontroller vboxvga
}}

{{CodeSelect|code=
VBoxManage modifyvm Whonix-Gateway-XFCE --graphicscontroller vboxsvga
}}
</ref>
# <code>VirtualBox</code> &rarr; <code>click a VM</code> &rarr; <code>Settings</code> &rarr; <code>Display</code> &rarr; <code>Graphics Controller</code> &rarr; <code>increase slider for Video Memory to 128</code> &rarr; <code>OK</code> (This is already the case in newer {{Project name}} versions.)
# Restart the VM.

-----
'''Workaround 2:  Boot Once Without Virtual Graphics Adapter'''
This Workaround has been reported functional on a Windows 10 host with both Intel and nVidia GPU capabilities. It is OK to try this workaround on any host operating system.

# Power off the VM.
# <code>VirtualBox</code> &rarr; <code>click a VM</code> &rarr; <code>Settings</code> &rarr; <code>Display</code> &rarr; <code>Graphics Controller</code> &rarr; <code>None</code> &rarr; <code>OK</code>
# Start the VM. Wait 2-3 minutes. ''(Since you've disabled the display, you will see nothing happening)''
# Click the VirtualBox pane's <code>[X]</code> button. VirtualBox will offer a dialog with 3 options. If <code>Send Shutdown signal</code> is greyed out, cancel the dialog and try this step again every 10-20 seconds.
# Send Shutdown signal. If it doesn't shut down immediately, wait a short time and try again.
# Once the VM shuts down, restore the Graphics Controller to <code>VMSVGA</code>.
# Restart the VM.

''If this workaround works, the screen will again be black for 2-3 minutes, but then <code>chkdsk</code> will run and the VM should start normally.''

-----
'''Workaround 3: nomodeset Kernel Parameter'''

Try to [[Grub#Kernel_Boot_Parameter_Change|boot with the <code>nomodeset</code> kernel parameter]]. If that works, please post a forum report and then [[Grub#Permanent_Configuration_Changes|make the change permanent]]. <ref>
http://forums.whonix.org/t/whonix-cli-15-0-0-9-4-gateway-shows-a-black-screen/9174/2
</ref>

-----
'''Workaround 4: Virtual Console'''

If it is possible to switch to a [[Desktop#Virtual_Consoles|virtual console]], this can help with debugging.

== Slow Video Playback ==
Options:

* Try download video using [[youtube-dl]] and then play the video in VLC. Untested. Does that help?
* Consider [[Tuning]], specifically [[Tuning#Hardware-accelerated_graphics|enable hardware-accelerated graphics]]. Tested. Bad for security.
* Consider [[Tuning#Disable_CPU_Mitigations|disabling CPU mitigations]]. Untested. Also bad for security.

What's better or worse for security, enable VirtualBox hardware-accelerated graphics (3D Acceleration) or disabling CPU mitigations? Please consider resolving that question through [[Free Support Principle]] and let us know what you found out. Please use a dedicated forum thread for that.

= Miscellaneous =
== Host Crash ==
Same as below [[#Aborted Status|Aborted Status]].

== Aborted Status ==

If the virtual machine ever shows an <code>aborted</code> status, perform these steps:

# Try to [[#Assign Less Virtual CPUs|Assign Less Virtual CPUs]]; this may help to avoid the issue.
# Apply [[#General_VirtualBox_Troubleshooting_Steps|General VirtualBox Troubleshooting Steps]].
# Consider reporting a bug against upstream [https://www.virtualbox.org VirtualBox] -- [https://www.virtualbox.org/wiki/Bugtracker VirtualBox bugtracker] / [https://forums.virtualbox.org VirtualBox forums]. Logs are useful for developers to isolate the problem. <ref>
[https://forums.virtualbox.org/viewtopic.php?f=7&t=77663#p361694 Reasons of vm to get into "aborted" state]:

<blockquote>
Would you mind sharing with us one of those logs so that we can judge for ourselves? From a machine that got aborted? ZIP it before using the "Upload attachment" at the bottom of your reply form.
</blockquote>
</ref>

{{Project name}} provides VM images that operate inside of the VM. Whatever occurs inside a VM should never lead to a crash (status aborted) of the host virtualization software, VirtualBox.

To capture the VirtualBox log:

# <code>VirtualBox</code> &rarr; <code>right click a VM</code> &rarr; <code>Show Log...</code> &rarr; <code>Log</code> &rarr; <code>Save</code> &rarr; <code>OK</code>
# Zip the log.
# Report to VirtualBox support.

== Guru Mediation ==

{{Project name}} provides VM images that operate inside of the VM. Whatever occurs inside a VM should never lead to a Guru Mediation of the host virtualization software, VirtualBox.

Posting a screenshot of the Guru Mediation screen is probably not required since these all look very similar. <ref>
http://www.fixedbyvonnie.com/wp-content/uploads/2014/09/fixedbyvonnie-virtualbox-guru-meditation.png
</ref>

<blockquote>
VirtualBox Guru Meditation

A critical error has occurred while running the virtual machine and the machine execution has been stopped.

For help, please see the Community section on https://www.virtualbox.org or your support contract. Please provide the contents of the log file VBox.log and the image file VBox.png, which you can find in the /home/sk/VirtualBox VMs/Ubuntu 20.04 Server/Logs directory, as well as a description of what you were doing when this error happened. Note that you can also access the above files by selecting Show Log from the Machine menu of the main VirtualBox window.

Press OK if you want to power off the machine or press Ignore if you want to leave it as is for debugging. Please note that debugging requires special knowledge and tools, so it is recommended to press OK now.
</blockquote>

The above text does not contain any technical details which would help to advise how to fix the issue since VirtualBox Guru Meditation can happen for a wide variety of reasons.

Without the contents of the log, probably nobody will be able to help.

# Apply [[#General_VirtualBox_Troubleshooting_Steps|General VirtualBox Troubleshooting Steps]].
# Consider looking through the log for yourself. Use search engines to search for any error messages if you can identify any. Likely the issue has already been discussed by others and likely there is already a solution for the issue described in the same place. Specifically useful it might be to search the offical VirtualBox website since that is presumed the place where most VirtualBox developers and experts are. Try the following search term to limit search results to the VirtualBox website (this is a feature which most search engines support), <code>site:virtualbox.org error message here</code>. Replace <code>error message here</code> with the text you actually want to investigate.
# Consider reporting a bug against upstream [https://www.virtualbox.org VirtualBox] -- [https://www.virtualbox.org/wiki/Bugtracker VirtualBox bugtracker] / [https://forums.virtualbox.org VirtualBox forums]. Log is required by VirtualBox  developers to be able to isolate the problem.

To capture the VirtualBox log:

# <code>VirtualBox</code> &rarr; <code>right click a VM</code> &rarr; <code>Show Log...</code> &rarr; <code>Log</code> &rarr; <code>Save</code> &rarr; <code>OK</code>
# Zip the log.
# Report to VirtualBox support.

== NS_ERROR_FAILURE ==
<pre>
NS_ERROR_FAILURE (0x80004005)
</pre>

[https://forums.virtualbox.org/viewtopic.php?f=8&t=87306 Quote VirtualBox forum moderator]

<blockquote>NS_ERROR_FAILURE (0x80004005) is a general failure message when loading a VM. Subsequent lines in the error dialog will give the exact cause of the error. You do NOT have the same error just because you see the generic leader. If you don't provide a log or the supplemental error description then we can't help you.</blockquote>

While this is not the same error as Guru Mediation, all the same information and advice from that chapter applies. Therefore please follow chapter [[#Guru Mediation|Guru Mediation]].

== Kernel driver not installed =
Kernel driver not installed (rc=-1908)

TODO

== Assign Less Virtual CPUs ==

Try assigning less virtual CPUs. <ref>
VirtualBox ticket: [https://www.virtualbox.org/ticket/19500 VirtualBox should now prohibit assigning all physical CPUs to a VM and/or fix VirtualBox CPU assignment manual].
</ref>

In {{Project name}} <code>15.0.1.3.4</code> and above <code>3</code> virtual CPUs is now the default setting; <code>4</code> were previously used. As a result, this workaround should no longer be required for most users.

# Power off the VM.
# <code>VirtualBox</code> &rarr; <code>click a VM</code> &rarr; <code>Settings</code> &rarr; <code>System</code> &rarr; <code>Processor</code> &rarr; <code>Reduce to 3</code> &rarr; <code>OK</code>

== INCONSISTENCY BETWEEN GRAIN TABLE AND BACKUP GRAIN TABLE ==

If this error appears, sometimes it helps to:

# Try and convert the <code>vmdk</code> to <code>vdi</code>.
# Remove the old <code>vmdk</code> from the VM.
# Attach the new <code>vdi</code>.

== Import {{project_name}} Images ==

Using the VirtualBox GUI to import {{project_name}} images should work well in most cases. If not, follow the steps below. 
{{Box|text=
'''1.''' Check if there is enough free disk space. 

'''2.''' Refer to the {{project_name}} installation screenshots ([[VirtualBox/XFCE]] and click expand button) and/or [[Videos|Video Tutorials]].

'''3.''' Delete any half-imported or otherwise broken virtual machine images.

'''4.''' Use the VBoxManage command line tool and copy the output.

{{CodeSelect|code=
VBoxManage unregistervm "{{gateway_product_name_short}}-XFCE" --delete
}}

{{CodeSelect|code=
VBoxManage unregistervm "{{workstation_product_name_short}}-XFCE" --delete
}}

'''5.''' Navigate to the folder where {{project_name}} was downloaded and import {{gateway_product_name}} and {{workstation_product_name}} by using the VBoxManage command line tool.

{{CodeSelect|code=
VBoxManage import {{gateway_product_name_short}}-XFCE-{{VersionNew}}.ova
}}

'''6.''' Clean (anonymize) the output.

Remove operating system user name or any problematic paths.

'''7.''' [[Contact|Contact lead {{project_name}} developer]] Patrick Schleizer and send the output.
}}

= Try a non-Whonix VM =
# "Forget" about {{Project name}} for a moment and imagine you had never heard of the platform. Test the VirtualBox host software first.
# Try a VM other than {{Project name}} such as for example Debian <code>{{Stable project version based on Debian codename}}</code>.
# If that does not fix the issue, that means the root issue is not caused by {{project name}}. Therefore it is recommended to attempt to resolve the issue as per [[Free Support Principle]].

= Submit a Bug Report =

When reporting an issue in the [https://forums.whonix.org/ {{Project name}} forums], please add the exact steps which led to the problem. Also include as much relevant information as possible; see below.

* Does the problem resolve itself if {{Gateway product name}} is launched without starting {{Workstation product name}}?
* Which {{project name}} version was downloaded and from where?
* Do both {{Gateway product name}} and {{Workstation product name}} have this issue?
* Did you: 
** Only download, import {{project name}} VMs and start {{project name}}?; or
** Did you start {{project name}}, use {{project name}}, install more software and perform other activities before the black screen issues emerged?
* Have you previously used older versions of {{project name}} that worked?
* What is the host operating system and version?
* What is the VirtualBox version?
* Can you switch to a [[Desktop#Virtual_Consoles|virtual console]]? This can help with debugging.
* How much RAM does the host have?

Bugs can also be reported against upstream [https://www.virtualbox.org VirtualBox]: [https://www.virtualbox.org/wiki/Bugtracker VirtualBox bugtracker] / [https://forums.virtualbox.org VirtualBox forums]. Bug reports must be thorough otherwise it will not lead to a solution, see: [https://forums.virtualbox.org/viewtopic.php?f=3&t=87130#p416223 bug reporting instructions].

= See Also =
* [[Troubleshooting]]
* [[RAM|Advice for Systems with Low RAM]]
* [[Support]]
* [[Reporting Bugs]]

= Footnotes =
{{reflist|close=1}}

{{Footer}}

[[Category:Documentation]]
