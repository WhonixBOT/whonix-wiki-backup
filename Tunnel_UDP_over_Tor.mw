{{Header}}
{{#seo:
|description=Workaround for Tunneling UDP over Tor. Connection Scheme: User -> Tor -> Destination
|image=https://www.whonix.org/w/images/c/cf/Book-2869640.jpg
}}

= Introduction =

{{mbox
| image   = [[File:Ambox_notice.png|40px]]
| text       =
The Tor software does not yet support UDP, <ref>https://trac.torproject.org/projects/tor/ticket/7830</ref> although Tor provides a DnsPort.

If UDP is urgently required in Whonix, a limited workaround is provided - see the [[#VPN_Method|VPN Method]] below.
}}

= VPN Method =

This tutorial uses OpenVPN and works well inside Whonix. Additional VPN implementations like PPTP might be useful -- as well as other VPN protocols which are free and support UDP -- but further research is required.

Before setting up the VPN:

* Refer to related VPN documentation: [[Tunnels/Connecting to Tor before a VPN|How to connect to Tor before a VPN (User -> Tor -> VPN -> Internet)]].
* Familiarize yourself with curl and rdate. The rdate command line switch <code>-p</code> results in just showing the date and time, without setting it. <code>-u</code> uses UDP instead of TCP (the default).
{{Box|text=
'''1.''' Test the Whonix setup is generally working. <ref>While enforcing SSL.</ref> <ref>Alternatively the test can be run without enforcing SSL because some VPN services appear to block it.

{{CodeSelect|code=
{{Curl_Plain}} http://check.torproject.org
}}
</ref>

{{CodeSelect|code=
{{Curl_Plain}} {{Curl Secure}} https://check.torproject.org
}}

This should output "Congratulations. Your browser is configured to use Tor."

'''2.''' Install rdate for UDP and TCP testing.

{{CodeSelect|code=
sudo apt-get update
}}
{{CodeSelect|code=
sudo apt-get install rdate
}}

'''3.''' Run commands for TCP testing.

{{CodeSelect|code=
rdate -p time.u.washington.edu
}}
{{CodeSelect|code=
rdate -p time.nist.gov
}}
{{CodeSelect|code=
rdate -p ptbtime1.ptb.de
}}

'''4.''' Run commands for UDP testing.

{{CodeSelect|code=
rdate -u -p time.u.washington.edu
}}
{{CodeSelect|code=
rdate -u -p time.nist.gov
}}
{{CodeSelect|code=
rdate -u -p ptbtime1.ptb.de
}}

The tests should reveal that without a VPN, TCP works over Tor, but not UDP.

'''5.''' Configure a VPN tunnel link in Whonix.

Obviously a VPN provider that does not block UDP is required. Follow the setup instructions on the [[TestVPN|VPN Tunnel Setup Examples]] page; the [[TestVPN#Riseup.net|riseup]] and [[TestVPN#usaip.eu|usaip]] examples are functional for this purpose.

Afterwards test rdate again, first in TCP mode and then in UDP mode -- both should work correctly.
}}

= SSH Method =

This method is currently undocumented. In theory, SSH servers could be utilized to tunnel UDP over Tor. Instructions for this procedure cannot be provided because free SSH services are rarely available, making a solution near impossible. Also, the existing free SSH services block certain ports, which poses another obstacle. 

Even though SSH can provide a SOCKS5 proxy, it is not capable of providing [http://zarb.org/~gc/html/udp-in-ssh-tunneling.html tunneling support for UDP itself]. Extra software needs to be installed on both the client and (even worse) the server with root access. Most administrators will not allow this configuration. Provided links will only be useful if you have your own server, but even then the VPN method is usually preferable.

= SOCKS5 Proxy Method =

Attempts to tunnel UDP with this configuration have failed. See the [[Dev]] Archive for full details: [https://trac.torproject.org/projects/tor/wiki/doc/TorBOX/Dev/ArchivedDiscussion/OPTIONALFEATURE#TunnelingUDPoverTorOPTIONALFEATUREDONE Tunneling UDP over Tor] ([http://www.webcitation.org/6dbdZTaU6 w]).

= Footnotes / References =
{{reflist|close=1}}

{{Footer}}

[[Category:Documentation]]
