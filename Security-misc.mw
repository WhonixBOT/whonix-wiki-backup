{{Header}}
{{#seo:
|description=Documentation for package security-misc.
|image=https://www.whonix.org/w/images/7/71/Securitymisc.jpg
}}
{{title|title=
security-misc - Enhances Miscellaneous Security Settings
}}
[[image:Securitymisc.jpg|thumb]]

= Stable Features =
[https://github.com/Whonix/security-misc#enhances-misc-security-settings Described here].

= Testing Features =
== Restrict Hardware Information to Root ==
* security impact: There are many of hardware, kernel, debug information, etc. in <code>/sys</code>, which is especially problematic and has been the cause of many infoleaks such as kernel pointer leaks.
* privacy/anonymity impact: Details about your hardware can be used for identification.

Therefore security-misc includes the <code>hide-hardware-info.service</code> systemd unit that restricts access to <code>/sys</code>, <code>/proc/cpuinfo</code>, <code>/proc/bus</code>, and <code>/proc/scsi</code> to the root user only. This hides most hardware identifiers.

This setting is disabled by default because it might break many applications. It can optionally be enabled by running the following command.

{{CodeSelect|code=
sudo systemctl enable hide-hardware-info.service
}}

A whitelist that allows specific applications to access <code>/sys</code> and <code>/proc/cpuinfo</code> is enabled by default to maintain basic functionality. For example, this allows the launching of applications like XFCE.

forum discussion: [https://forums.whonix.org/t/restrict-hardware-information-to-root-testers-wanted/8618 Restrict Hardware Information to Root - Testers Wanted!]

=== Whitelisting Applications ===

To whitelist applications, they must be run under the <code>sysfs</code> group (if allowing access to <code>/sys</code>) or the <code>cpuinfo</code> group (if allowing access to <code>/proc/cpuinfo</code>).

For example, to run a systemd service as the <code>sysfs</code> group, create a [[Configuration_Files#Configuration_Drop-In_Folders|drop-in directory]] and add the following.

{{CodeSelect|code=
[Service]
SupplementaryGroups=sysfs
}}

To run a specific binary as the <code>sysfs</code> group, the binary must be owned by the <code>sysfs</code> group and be made setgid. To achieve this, change the ownership of the binary by running the following.

{{CodeSelect|code=
sudo chgrp sysfs /path/to/binary
}}

Then make the binary setgid.

{{CodeSelect|code=
sudo chmod g+s /path/to/binary
}}

The binary will now run with the permissions of the <code>sysfs</code> group and have access to <code>/sys</code>.

All of these steps can also be applied to the <code>cpuinfo</code> group.

Remember that any whitelisted applications add to the attack surface. An attacker can attempt to exploit a vulnerability in the whitelisted application(s) to gain access to hardware information.

=== Disable the Whitelist ===

In order to reduce the attack surface as much as possible, optionally the whitelist can be disabled entirely.

{{Open with root rights|filename=
/etc/hide-hardware-info.d/30_whitelist.conf
}}

Uncomment the <code>sysfs_whitelist=0</code> and <code>cpuinfo_whitelist=0</code> sections to disable the whitelist.

Note that this setting will break many applications; for example, the desktop environment will not even start. Do not perform this action unless you understand the implications and can reverse the change.

== SUID Disabler and Permission Hardener ==
See [[SUID Disabler and Permission Hardener]].

== hidepid ==
TODO: document

= Experimental Features =
Unreleased. (Developers only.) Will flow into other repositories as per usual.

{{anchor|suid}}
== Remount Secure ==
Feature not ready!

* https://forums.whonix.org/t/re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707/27
* https://github.com/Whonix/security-misc/blob/master/lib/systemd/system/remount-secure.service
* https://github.com/Whonix/security-misc/blob/master/usr/lib/security-misc/remount-secure
* [[Dev/remount-secure]]

{{CodeSelect|code=
sudo touch /etc/noexec
}}

{{Anchor|install}}

= Installation of security-misc =
{{mbox
| image   = [[File:Ambox_notice.png|40px|alt=Whonix / Kicksecure default admin password is: changeme]]
| text    =
This chapter is only required for users which aren't users of Whonix or Kicksecure. That is because security-misc is installed by default in Whonix and Kicksecure.
}}

Prerequisites:

{{Kicksecure Prerequisites}}

{{Project-APT-Repository-Add}}

{{Box|text=
Install <code>security-misc</code>.

{{Install Package|package=
security-misc
}}
}}

= selinux =
{{Community Support}}

* https://github.com/Whonix/security-misc/pull/100
* https://forums.whonix.org/t/restrict-hardware-information-to-root/7329/88

= References =
{{reflist|close=1}}

{{Footer}}

[[Category:Documentation]]
