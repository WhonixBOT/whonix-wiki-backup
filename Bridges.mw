{{Header}}
<!--
Copyright:

   Whonix Bridges wiki page Copyright (C) Amnesia <amnesia at boum dot org>
   Whonix Bridges wiki page Copyright (C) 2012 -2014 Patrick Schleizer <adrelanos@riseup.net>
   
   This program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 3 of the License, or
   (at your option) any later version.
         
   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.
      
   You should have received a copy of the GNU General Public License
   along with this program; if not, write to:

    Free Software Foundation, Inc. 
    51 Franklin St, Fifth Floor
    Boston, MA 02110-1301, USA.

On Debian GNU/Linux systems, the complete text of the GNU General Public
License can be found in the /usr/share/common-licenses' directory.
The complete text of the GNU General Public License can also be found online on gnu.org <https://www.gnu.org/licenses/gpl.html>, in Whonix virtual machine images in /usr/share/common-licenses/GPL-3 file or on Github <https://github.com/Whonix/Whonix/blob/master/GPLv3>.
-->
<!--
This wiki page is a fork of the Tails Tor Bridge Mode page, from this exact source <http://git.immerda.ch/?p=amnesia.git;a=blob;f=wiki/src/doc/first_steps/startup_options/bridge_mode.mdwn;hb=b4c1868fc9d59b6a1cb6d0e956ece5c92059c653>.
-->
{{#seo:
|description=Censorship Circumvention. Get around network bans. Using Whonix with (private) (obfuscated) bridges.
}}
= What bridges are and when to use them =
When using Tor with Whonix in its default configuration, anyone who can observe the traffic of your Internet connection (for example your Internet Service Provider and perhaps your government and law enforcement agencies) can know that you are using Tor.

This may be an issue if you are in a country where the following applies:

# '''Using Tor is blocked by censorship:''' since all connections to the Internet are forced to go through Tor, this would render Whonix useless for everything except for working offline on documents, etc.
# '''Using Tor is dangerous or considered suspicious:''' in this case starting Whonix in its default configuration might get you into serious trouble.

Tor bridges, also called Tor bridge relays, are alternative entry points to the Tor network that are not all listed publicly. Using a bridge makes it harder, but not impossible, for your Internet Service Provider to know that you are using Tor.

If you are in one of the situations described above you might want to use Tor bridges in Whonix. Please also read The Tor Project's [https://www.torproject.org/docs/bridges dedicated page about bridges] to get a general idea about what bridges are.

In order to use bridges, you must know in advance the address of at least one bridge. The Tor Project distributes bridge addresses in several ways, for example from their [https://bridges.torproject.org/ website] and via email.

''Bridges are less reliable and tend to have lower performance than other entry points. If you life in a uncensored are, they are not necessarily more secure than entry guards.'' ''Source: [https://trac.torproject.org/projects/tor/wiki/doc/TorFAQ#bridgevsnon-bridgeusersanonymity bridge vs non-bridge users anonymity].''

= If using Tor is dangerous in your country =
The Tor Project's [https://www.torproject.org/docs/bridges documentation on bridges] mainly focuses on censorship circumvention, this means when the usage of Tor is blocked by censorship. If using Tor is dangerous or considered suspicious in your country, then there are some extra rules that you should follow in order to prevent you from being identified as a Tor user.

''Bridges are important tools that work in many cases but'' '''they are not an absolute protection''' ''against the technical progress that an adversary could do to identify Tor users.''

1. When Whonix starts for the first time, it won't automatically connect to the public Tor network, which is good. whonixsetup, which is automatically started, will guide you.

2. Only use [https://www.torproject.org/docs/bridges#PluggableTransports {{Code|obfuscated bridges}}] since they are harder to identify than other bridges.

3. The less publicly known the bridges are, the better. Unfortunately, since some bridge addresses can be obtained by anyone from the Tor website or by email, it is also possible for an adversary to get the same bridge information by the same means. The Tor Project has some protection against that, but they are far from being perfect.

So the best is if you can find a trusted friend or an organization in a different country who runs a {{Code|private obfuscated bridge}} for you. In this case "private" means that the bridge is configured with the option {{Code|PublishServerDescriptor 0}}. Without this option The Tor Project can learn about the bridge and may distribute its address to others and so it could end up in the hands of your adversary.

See also [[Hide Tor and Whonix from your ISP]]!

= How to use bridges in Whonix =
== Using obfuscated, (private) and/or ordinary bridges ==
Whonix does not yet include a wizard that guides you through the process of setting up bridges before connecting to Tor. You must add bridges manually to {{Code2|/etc/tor/torrc}}.

({{Code|Private}}) Ordinary, {{Code|obfs2}}, {{Code|obfs3}} and {{Code|obfs4}} bridges can currently be configured on Whonix-Gateway the same way, they would be configured when not using Whonix, i.e. just like on a server without graphical user interface. Have a look at {{Code2|/etc/tor/torrc}} <ref>[https://github.com/Whonix/Whonix/blob/stable/whonix_gateway/etc/tor/torrc /etc/tor/torrc on github].</ref>.

If you are using a graphical Whonix-Gateway, for more documentation and examples, see:

<pre>
Start Menu -> Applications -> Settings -> /etc/tor/torrc.examples
</pre>

To edit your {{Code2|/etc/tor/torrc}}.

<pre>
Start Menu -> Applications -> Settings -> /etc/tor/torrc
</pre>

After editing your {{Code2|/etc/tor/torrc}} you must reload Tor so your changes take effect.

<pre>
Start Menu -> Applications -> Settings -> Reload Tor
</pre>

If you are using a terminal-only Whonix-Gateway, click on expand on the right side.
<div class="toccolours mw-collapsible mw-collapsed" style="width:800px">
<div class="mw-collapsible-content">
For more documentation and examples, see:

<pre>
nano /etc/tor/torrc.examples
</pre>

To edit your {{Code2|/etc/tor/torrc}}.

<pre>
sudo nano /etc/tor/torrc
</pre>

After editing your {{Code2|/etc/tor/torrc}} you must reload Tor so your changes take effect.

<pre>
sudo service tor reload
</pre>

</div>
</div>

If you would like to see an example using {{Code|obfs3}} bridges, click on exland on the right.
<div class="toccolours mw-collapsible mw-collapsed" style="width:800px">
<div class="mw-collapsible-content">
You cannot use the example bridge {{Code2|141.201.27.48:420}} below, because it's only an example. You still need to find your own bridges as explained in {{Code2|[https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/etc/tor/torrc.examples /etc/tor/torrc.examples]}}.
<pre>
UseBridges 1
ClientTransportPlugin obfs2,obfs3 exec /usr/bin/obfsproxy managed
bridge obfs3 141.201.27.48:420 4352e58420e68f5e40bf7c74faddccd9d1349413
</pre>
</div>
</div>

= Flash Proxy Bridges =
<div class="toccolours mw-collapsible mw-collapsed" style="width:800px">
'''Untested!'''

'''Unfinished!'''

This has NOTHING to do with Adobe Flash.

If you would like to see the unfinished documentation, please press on expand on the right.
<div class="mw-collapsible-content">
Should work in Whonix-Gateway as well, but require some fiddling. See also [https://sourceforge.net/p/whonix/discussion/general/thread/729ba238/ Forum topic].

1. Enable port forwarding from your host operating system to Whonix-Gateway. Enter this command in a terminal on the host.

<pre>VBoxManage modifyvm "Whonix-Gateway" --natpf1 "9000",tcp,127.0.0.1,9000,,9000</pre>

2. Create a file /etc/whonix_firewall.d/50_user (Or if you using a graphical Whonix-Gateway, you can use the desktop shortcut.)

<pre>kdesudo kwrite /etc/whonix_firewall.d/50_user</pre>

3. Add the following content.

<pre>
GATEWAY_ALLOW_INCOMING_FLASHPROXY=1
FLASHPROXY_PORT=9000
</pre>

4. Reload Whonix Firewall. (Or if you using a graphical Whonix-Gateway, you can use the desktop shortcut.)

<pre>sudo whonix_firewall</pre>

5. Install flashproxy.

Ok, this is a bit tricky, since there is no Debian package with the flashproxy-client. <ref>feature request: [https://trac.torproject.org/projects/tor/ticket/8092 make a deb of flashproxy and get into Debian]</ref>

Either get it from here:
https://crypto.stanford.edu/flashproxy/#how-to

Or...

Go to the [https://blog.torproject.org/ Tor Blog] and look for the latest pluggable transports bundle. This has not been documented yet:
https://github.com/Whonix/Whonix/issues/53

6. Set up a Port Forwarding from your Router to your Computer

https://trac.torproject.org/projects/tor/wiki/FlashProxyHowto#Settingupportforwarding
</div>
</div>

= Using Tor / Pluggable Transports from the Tor Browser Bundle =
'''Untested!'''

'''Unfinished!'''

https://phabricator.whonix.org/T116

Install the Tor Browser Updater by Whonix developers ({{Code2|tb-updater}}). <ref>https://github.com/Whonix/tb-updater</ref> <ref>[[Tor Browser]]</ref> <ref>
Using <code>--no-install-recommends</code> to prevent installing {{Code2|[https://github.com/Whonix/tb-starter tb-starter]}} and {{Code2|[https://github.com/Whonix/tb-default-browser tb-default-browser]}}.
</ref>

<pre>
sudo apt-get install --no-install-recommends tb-updater
</pre>

Download and install Tor Browser. <ref>
In meanwhile, before Whonix 10, we could also append <code>--noaskstart</code>.
</ref>
<pre>
update-torbrowser
</pre>

Do not start Tor Browser. (Do not use Whonix-Gateway for any purpose other than configuring Tor and Whonix. Use Whonix-Workstation to browse the web using [[Tor Browser]].)

<pre>
sudo mkdir /home/user/debian-tor
</pre>

<pre>
sudo chown --recursive debian-tor:debian-tor /home/user/debian-tor
</pre>

<pre>
sudo usermod debian-tor -s /bin/bash
</pre>

<pre>
sudo su debian-tor
</pre>

Change directory into /home/debian-tor/tor-browser_en-US. (Do not use {{Code|~}}. <ref>Because that is set to /var/lib/tor for user debian-tor.</ref>)

<pre>
cd /home/debian-tor/tor-browser_en-US
</pre>

TODO for developers:

* Install tb-updater by default on Whonix-Gateway?
* Install Tor Browser by default on Whonix-Gateway?

= Footnotes =
<references />

= License =
<pre>Whonix Bridges wiki page Copyright (C) Amnesia <amnesia at boum dot org>
Whonix Bridges wiki page Copyright (C) 2012 -2014 Patrick Schleizer <adrelanos@riseup.net>

This program comes with ABSOLUTELY NO WARRANTY; for details see the wiki source code.
This is free software, and you are welcome to redistribute it
under certain conditions; see the wiki source code for details.</pre>

{{Footer}}

[[Category:Documentation]]
