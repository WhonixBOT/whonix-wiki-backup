{{Header}}
<!--
Copyright:

   Whonix Chat wiki page Copyright (C) Amnesia <amnesia at boum dot org>
   Whonix Chat wiki page Copyright (C) 2012 - 2018 ENCRYPTED SUPPORT LP <adrelanos@riseup.net>
   
   This program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 3 of the License, or
   (at your option) any later version.
         
   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.
      
   You should have received a copy of the GNU General Public License
   along with this program; if not, write to:

    Free Software Foundation, Inc. 
    51 Franklin St, Fifth Floor
    Boston, MA 02110-1301, USA.

On Debian GNU/Linux systems, the complete text of the GNU General Public
License can be found in the /usr/share/common-licenses' directory.

The complete text of the GNU General Public License can also be found online on gnu.org <https://www.gnu.org/licenses/gpl.html>, in Whonix virtual machine images in /usr/share/common-licenses/GPL-3 file or on Github <https://github.com/Whonix/Whonix/blob/master/GPLv3>.
-->
<!--
This Chat page is a fork of the Tails Pidgin page, from this exact source <http://git.immerda.ch/?p=amnesia.git;a=blob;f=wiki/src/doc/anonymous_internet/pidgin.mdwn;hb=96c45f5ed786f3d24c51e1a2ef8ecedf5f2644d8>.
-->
{{DISPLAYTITLE:Instant Messenger Chat}}
{{#seo:
|description=Anonymous Chat, IRC, XMPP. Tor Messenger/RicochetIM in Whonix without Tor over Tor.
|image=https://www.whonix.org/w/images/9/92/Balloons-874841640.jpg
}}
= General Safety Advice =
{{mbox
| type      = notice
| image   = [[File:Ambox_notice.png|40px|alt=Info]]
| text       = '''Tip:''' Most existing instant messenger protocols are unsafe from a privacy point of view. This is not a Whonix-specific problem, but a general problem with instant messengers.
}}
{{PQCrypto}}


It is recommended to review the [[DoNot#Mix_Anonymity_Modes|Do not Mix Anonymity Modes]] section in conjunction with this entry. For a comprehensive comparison of instant messengers, [https://en.wikipedia.org/wiki/Comparison_of_instant_messaging_clients see here].

== Encryption ==

[[Warning#Tor_Exit_Relays_can_Eavesdrop_on_Communications|Tor exit relays can eavesdrop]] on communications if encryption to the server is disabled. Depending on the protocol, encryption might be disabled by default or not even supported. Tails has noted that without encryption, the exit relay can see the contact list, all messages, file transfers, and audio/video. <ref>See: https://tails.boum.org/todo/Pidgin_Protocol_Review/ for an overview of Pidgin protocols and associated encryption features.</ref> While encryption to the server prevents exit relay eavesdropping, it still leaves one problem unresolved: server logging. 

== Server Logging ==

Encrypted server connections do not prevent the server gathering interesting information about users, such as common contacts and the regularity of communications. An example list includes: 

* Account names.
* Buddy list (list of contacts).
* The exact date and time of logins.
* Message timestamps.
* Communication patterns like common contacts.
** If the recipient knows the sender and has ever used a non-anonymous account or logged in without Tor, this information can be used to try and determine the sender's identity.

The content of messages will only be protected by using end-to-end encryption, for example [https://en.wikipedia.org/wiki/Off-the-Record_Messaging Off-the-Record (OTR) encryption]. To completely remove the threat of server logging, prefer decentralized (server-less) instant messengers like [[#Tox|Tox]] and [[#RetroShare|Retroshare]].

== Jabber / XMPP ==

[https://xmpp.org/ Jabber/XMPP] is a free server-federation-based protocol designed with openness in mind: "''... All of the existing XMPP servers, clients, and programming libraries support the key features of an IM system, such as one-to-one and multi-party messaging, presence subscriptions and notifications, and contact lists.''" 

The system is decentralized because there is no central authoritative server; anyone can run a server. Some users are confused on this point because there are a number of large and popular public XMPP servers (like jabber.org), to which many have subscribed. <ref>Other popular public servers are listed [https://xmpp.org/getting-started/ here].</ref> Each network user has a unique XMPP address called a JID (Jabber ID). The JID is similar to an email address insofar as it has a username and domain name like username@example.com <ref name=Xmpp>https://en.wikipedia.org/wiki/Xmpp</ref> 

Safely using the protocol requires proper use of OTR, because it is unwise to trust server connections are properly encrypted between each other. Jabber privacy is also limited, as various adversaries are capable of observing which accounts are communicating. Jabber and Tor combined only guarantee pseudonymous communications, as while the user's current location is hidden, the social graph can still expose their true identity. For tips on operational security when chatting anonymously, see this [https://archive.is/n116i article] by [https://theintercept.com/2015/07/14/communicating-secret-watched/ The Intercept]. Also see: [https://forums.whonix.org/t/why-is-icq-considered-unsafe-through-tor/1096 Why prefer open protocols such as Jabber/XMPP over proprietary ones such as ICQ?]

== IRC ==

When using IRC inside Whonix-Workstation, the [https://en.wikipedia.org/wiki/Ident_protocol Ident Protocol] is automatically blocked because Whonix-Workstation is firewalled. Therefore the associated daemon will not identify the username which is linked with a particular TCP connection, as is normally the case.

The Tor Project [https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO/IRC Internet Relay Chat] page contains a number of important recommendations and tips for safe IRC use:

* Use onion services when available.
** Check self-signed certificates have the correct SSL/TLS certificate.
* Cycle Tor circuits to evade censorship bans.
* Chain VPNs and Tor for registration.
* Use OTR for end-to-end encryption.
* Distrust users and servers in general.
* Avoid personally identifiable information in chats.
* Check the user fingerprint before using IRC.
* Harden the IRC client.
* And more.

== Recommendation ==
Applications below will in future be listed in order of recommendation with respect to best usability.

[[#Ricochet IM|Ricochet IM]] is decentralized (server-less) but uses "only" onion encryption and does not provide yet OTR or OMEMO grade encryption. <ref>
https://github.com/ricochet-im/ricochet/issues/72
</ref> Also lacks usability.

[[#Gajim|Gajim]] requires a jabber server but can provide OTR or OMEMO grade encryption.

= Gajim =

== Overview ==

Ubuntu provides a succinct overview of Gajim: <ref>https://help.ubuntu.com/community/Gajim</ref>

<blockquote>Gajim is a free software, instant messaging client for the Jabber (XMPP) protocol which uses the GTK+ toolkit. It runs on GNU/Linux, BSD and Windows. The name Gajim is a recursive acronym for Gajim (is) a jabber instant messenger.

The goal of Gajim is to provide a full featured and easy to use Jabber client. Gajim works nicely with GNOME, but does not require it to run. It is released under the GNU General Public License. </blockquote>

Gajim has various features, including: <ref>https://gajim.org/</ref>
* Chat client synchronization.
* Group chats.
* Sending of pictures, videos and other files to friends or groups.
* Secure end-to-end encryption via OMEMO or PGP.
* The option to keep and manage all chat history.
* Connection compatibility with other messengers via transports, such as IRC.
* Various other features are available via plugins.

In late-2018, audio/video is reportedly not functional in Gajim. Further, OTR support was dropped in Gajim release 1.0, but the [https://dev.gajim.org/gajim/gajim-plugins/wikis/OmemoGajimPlugin OMEMO plugin] is an encryption alternative. <ref>https://dev.gajim.org/gajim/gajim/wikis/help/gajimfaq</ref> Note that Debian stretch has [https://packages.debian.org/search?keywords=gajim&searchon=names&suite=all&section=all v0.16 of the Gajim package] available, so optionally the [https://dev.gajim.org/gajim/gajim-plugins/wikis/OffTheRecordPlugin OTR plugin] can still be used instead of OMEMO (stretch-backports has v1.1 available).

== Installation ==

{{mbox
| type      = notice
| image   = [[File:Ambox_notice.png|40px|alt=Info]]
| text       = '''Tip:''' Gajim dependencies and Debian instructions are always available [https://dev.gajim.org/gajim/gajim/blob/master/README.md here].
}}


The steps below install Gajim, along with the OMEMO encryption plugin and [https://dev.gajim.org/gajim/gajim-plugins/wikis/HttpUploadPlugin HTTP Upload plugin] (which is required for file transfers). <ref>Note this feature can be combined with OMEMO for encrypted file transfers.</ref> The latter plugin is fully integrated into the core Gajim software as of v1.0. Upon first launch of the program, users can use an existing [[#Jabber_.2F_XMPP|XMPP account]] or create a new one. 

{{Update}}

{{CodeSelect|code=
sudo apt-get update
}}

Install gajim, gajim-omemo and gajim-httpupload.

{{CodeSelect|code=
sudo apt-get install gajim gajim-omemo gajim-httpupload
}}

Start Gajim from the start menu or type in konsole.

{{CodeSelect|code=
gajim
}}

<ref>
[https://github.com/Whonix/anon-apps-config anon-apps-config] which is installed by default will [https://github.com/Whonix/anon-apps-config/blob/master/debian/anon-apps-config.hide deactivate gajim plugin installer / updater] because it is not secure.
</ref>

== Configuration ==

=== Account ===

On first launch, an Account Creation Wizard Dialog will appear. Use the wizard to either create a new account to connect to the jabber network or use an existing account. For new accounts, there are multiple jabber servers available and only a username and password is required to join. <ref>A new account can always be added with: <code>Edit</code> -> <code>Accounts</code> -> <code>New</code></ref>

=== Gajim Settings ===

The following changes are recommended for better security and privacy.

<u>Logs:</u> 
* <code>Edit</code> -> <code>Accounts</code> -> <u>'''un'''check</u> <code>Save conversation logs for all contacts</code> <br />
<u>Activity settings:</u>
* <code>Preferences</code> -> <code>Status</code> -> <u>'''un'''check</u> <code>Away after</code> <ref>To prevent needlessly leaking your activity to the server.</ref>
* <code>Preferences</code> -> <code>Status</code> -> <u>'''un'''check</u> <code>Not available after</code>
<u>Privacy settings:</u>
* <code>Preferences</code> -> <code>Advanced</code>-> <code>Privacy</code> -> <u>'''un'''check</u>
** <code>Allow client / OS information to be sent</code>
** <code>Allow local system time information to be sent</code>
** <code>Log encrypted chat session</code>
** <code>Allow my idle time to be sent</code>
<u>Prevent auto-start:</u>
* <code>Preferences</code> -> <code>Advanced</code>-> <code>applications</code> -> <code>Custom</code> -> <u>clear fields</u> for: <ref>For better security, this prevents the automatic start of these applications from the chat client.</ref>
** <code>Browser</code>
** <code>Mail Client</code>
** <code>File Browser</code> 
<u>Network settings:</u> <ref>To set use of the Tor network, along with [[Stream Isolation]].</ref>
* <code>Preferences</code> -> <code>Advanced</code> -> <code>global proxy</code> -> <code>Tor</code>
* <code>Preferences</code> -> <code>Advanced</code> -> <code>global proxy</code> -> <code>mange</code> -> <code>Tor</code> -> <u>check</u> <code>Use proxy authentication</code> -> <u>set</u> <code>username</code> to <code>gajim</code> -> <u>set</u> <code>password</code> to <code>gajim</code>

Gajim cannot be installed by default in Whonix yet, as there is more development work TODO; see [[Dev/Gajim]].

= IRC Client HexChat =

See [[HexChat]].

= RetroShare =

See [[RetroShare]].

= Ricochet IM =
Ricochet IM<ref>https://ricochet.im/</ref> is a new successor of the unmaintained TorChat. <ref>
https://github.com/ricochet-im/ricochet/issues/30
</ref>

It is a portable P2P python chat application that does not save chat history. It relies on Tor onion services for creating identities. Its encryption and authentication properties are as strong as Tor's. No metadata is ever collected because it is server-less. An OTF sponsored audit in early 2016 shows that there were a few minor problems (fixed since).<ref>https://ricochet.im/files/ricochet-ncc-audit-2016-01.pdf</ref><ref>https://en.wikipedia.org/wiki/Ricochet_(software)</ref>

Should work. Please test and [https://phabricator.whonix.org/T444 report] if it's working.

On Whonix-Gateway, onion-grater needs some adjustments.

{{Control_Port_Filter_Python_Profile_Add|
filename=/usr/share/onion-grater-merger/examples/40_ricochet.yml
}}

{{Firewall Settings Workstation}}

Add.

{{CodeSelect|code=
EXTERNAL_OPEN_ALL=true
}}

Save.

{{Reload_Firewall_Whonix-Workstation}}

On Whonix-Workstation, start ricochet. Either through start menu or from the command line.

{{CodeSelect|code=
ricochet
}}

= Tox =
{{Template:Tox}}

= Deprecated Chat Clients =

== Pidgin ==
Pidgin supports most protocols. However do not use it. It has a very bad security track record with many remotely exploitable bugs -  a result of being written in C and containing many legacy protocols. <ref>
https://pidgin.im/news/security/
</ref>

== TorChat ==
Unfortunately, since time of writing (September 2015) TorChat can not be recommended. This is because the TorChat developer currently does not respond to other people, see [https://github.com/prof7bit/TorChat/issues TorChat issues]. Communication and support is crucial for anonymity related projects. TorChat is an unofficial project. Unaffiliated with The Tor Project. A modern and maintained alternative is Ricochet IM.

In 2015 security analysis<ref>[http://kodu.ut.ee/~arnis/torchat_thesis.pdf Security Analysis of Instant Messenger TorChat]</ref> of TorChat protocol and its Python implementation was conducted. It was found that although the design of TorChat is sound, its implementation has several flaws, which make TorChat users vulnerable to impersonation, communication confirmation and denial-of-service attacks.<ref>https://en.wikipedia.org/wiki/TorChat#Security</ref>

== Tor Messenger ==
No longer use! Deprecated by upstream developers. <ref>
* https://blog.torproject.org/sunsetting-tor-messenger
* [[Deprecated#Tor_Messenger]]
* http://forums.whonix.org/t/tor-messenger-is-no-longer-maintained-as-of-march-2018
</ref>

= Other Software =
If it is not listed here, it for now is recommended against. You can search [https://forums.whonix.org/ Whonix forums] to see if that chat client has been discussed in past or if you think a privacy respecting chat client is missing on this page.

https://forums.whonix.org/t/client-server-instant-messengers-im-oct-2016

= Footnotes / References =

{{reflist|close=1}}

= License =

<pre>
Whonix Chat wiki page Copyright (C) Amnesia <amnesia at boum dot org>
Whonix Chat wiki page Copyright (C) 2012 - 2018 ENCRYPTED SUPPORT LP <adrelanos@riseup.net>

This program comes with ABSOLUTELY NO WARRANTY; for details see the wiki source code.
This is free software, and you are welcome to redistribute it
under certain conditions; see the wiki source code for details.
</pre>

{{Footer}}

[[Category:Documentation]]
