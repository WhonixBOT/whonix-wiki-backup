{{Header}}
<!--
Copyright:

   Whonix Chat wiki page Copyright (C) Amnesia <amnesia at boum dot org>
   Whonix Chat wiki page Copyright (C) 2012 -2014 Patrick Schleizer <adrelanos@riseup.net>
   
   This program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 3 of the License, or
   (at your option) any later version.
         
   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.
      
   You should have received a copy of the GNU General Public License
   along with this program; if not, write to:

    Free Software Foundation, Inc. 
    51 Franklin St, Fifth Floor
    Boston, MA 02110-1301, USA.

On Debian GNU/Linux systems, the complete text of the GNU General Public
License can be found in the /usr/share/common-licenses' directory.

The complete text of the GNU General Public License can also be found online on gnu.org <https://www.gnu.org/licenses/gpl.html>, in Whonix virtual machine images in /usr/share/common-licenses/GPL-3 file or on Github <https://github.com/Whonix/Whonix/blob/master/GPLv3>.
-->
<!--
This Chat page is a fork of the Tails Pidgin page, from this exact source <http://git.immerda.ch/?p=amnesia.git;a=blob;f=wiki/src/doc/anonymous_internet/pidgin.mdwn;hb=96c45f5ed786f3d24c51e1a2ef8ecedf5f2644d8>.
-->
{{#seo:
|description=Anonymous Chat, IRC, XMPP. Tor Messenger/RicochetIM in Whonix without Tor over Tor.
|og:image=https://www.whonix.org/w/images/9/92/Balloons-874841640.jpg
}}
= General Safety Advice =

Recommended knowledge: [[DoNot#Do_not_mix_Modes_of_Anonymity.21|Modes of Anonymity]].

'''Note: Most existing instant messenger protocols are unsafe from a privacy point of view. This is not a Whonix specific problem. It is a general problem with instant messengers.'''

[[Warning#Tor_exit_nodes_can_eavesdrop_on_communications|Tor Exit Node eavesdropping]] can happen if no encryption to the server is enabled. Some protocols have encryption disabled by default, some do not support encryption at all. See also [https://tails.boum.org/todo/Pidgin_Protocol_Review/ Overview about Pidgin protocols and their encryption features]<ref>http://archive.is/8w0Zf</ref>. If encryption to the server is enabled, the Tor Exit Node can no longer eavesdrop. This fixes one problem, however it also leaves another problem unresolved.

Even with encryption to the server enabled, the server could still gather interesting information.
For example:
* Account names
* Buddy list (list of contacts)
* Log login dates and times
* Timestamp of messages
* Who communicates with whom
** If the recipient knows the sender and the recipient uses a non-anonymous account or the recipient ever logged in without Tor, this can be used as a hint for determining who the sender is.
* Content of messages - Can be prevented using end-to-end encryption. This is covered in [[Chat#OTR_encryption|OTR encryption]] below.


Jabber/XMPP is a server-federation-based protocol designed with openness in mind. Its security depends on you making good use of OTR as you can never be sure if servers are properly encrypted between each other. Privacy with Jabber is limited, as it is visible to various kinds of attackers who your account is talking to. Tor only helps to pseudonymize your account and hide your current location, but your social graph may still expose your identity. For a good operational security guide on chatting anonymously see [https://theintercept.com/2015/07/14/communicating-secret-watched/ The Intercept's] [https://archive.is/n116i article].

Systems which do not require a server by design, i.e. serverless instant messengers are likely better from a privacy point of view. Such systems are [[Chat#TorChat|TorChat]], [[Chat#RetroShare|RetroShare]] and [[VoIP#Tox|Tox]].

For IRC inside Whonix-Workstation, the [https://en.wikipedia.org/wiki/Ident Ident Protocol] is automatically blocked because Whonix-Workstation is firewalled.
The [https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO/IrcSilc TorifyHOWTO/IrcSilc] contains general IRC safety techniques and other tips.

[https://forums.whonix.org/t/why-is-icq-considered-unsafe-through-tor/1096 Why prefer open protocols such as Jabber/XMPP over proprietary ones such as ICQ?]

{{PQCrypto}}

=Ricochet IM=
Ricochet IM<ref>https://ricochet.im/</ref> is a new successor of the unmaintained TorChat.

It is a portable P2P python chat application that does not save chat history. It relies on Tor onion services for creating identities. Its encryption and authentication properties are as strong as Tor's. No metadata is ever collected because it is server-less. An OTF sponsored audit in early 2016 shows that there were a few minor problems (fixed since).<ref>https://ricochet.im/files/ricochet-ncc-audit-2016-01.pdf</ref><ref>https://en.wikipedia.org/wiki/Ricochet_(software)</ref>

It is packaged in Debian backports. Whonix support is a WIP.

= Tor Messenger =
Installation instructions.

{{
TPO_Manual_Install
|website=https://trac.torproject.org/projects/tor/wiki/doc/TorMessenger#Downloads
|software=Tor Messenger
|store_where=/home/user/
|path_installed=/home/user/tor-messenger_en-US
|starter=start-tor-messenger
}}

For usage instructions refer to [https://archive.is/uDNvm this] guide.

Usage of Tor Messenger in Whonix should not differ from usage of Tor Messenger outside of Whonix.

[https://forums.whonix.org/t/tor-messenger-on-whonix/1565/3 Forum discussion]

= RetroShare =
[http://retroshare.sourceforge.net RetroShare] is not an [https://en.wikipedia.org/wiki/Anonymizer anonymizing network], it is a [https://en.wikipedia.org/wiki/Friend-to-friend friend-to-friend] (F2F) network, or optionally a [https://en.wikipedia.org/wiki/Darknet darknet]. RetroShare has a very different audience and threat model.

RetroShare is in active development. Users can operate servers for themselves, but the architecture doesn't depend on them. Communications are encrypted end-to-end and provide for messaging, mail, forums, pubsub, file exchange and even telephony. The problems with RetroShare are the confused user interface, the necessity to have it run most of the time and contribute to the distributed hashtable (DHT, causing continuous CPU usage) and three relevant privacy aspects: You expose your social graph to a global passive adversary because friends connect to friends directly. Your public IP is available in the DHT, allowing to track your physical locations. And your visible user name is exposed in the TLS certificate when somebody connects to your RetroShare node.

Several of these problems can be solved by disabling the built-in DHT and hiding RetroShare behind a Tor hidden service. People who scan Tor hidden services will however still be able to connect the service and see the RetroShare user name in the self-signed certificate. This can be prevented by setting up [[Hidden_Services#Hidden_Service_Authentication|Authenticated Hidden Services]] and limiting connections only to trusted people.

On November 4, 2014, RetroShare scored 6 out of 7 points on the Electronic Frontier Foundation's secure messaging scorecard. It lost a point because there has not been an independent code audit.<ref>https://www.eff.org/secure-messaging-scorecard</ref> A recent audit by the pen-testing group Elttam uncovered many bugs in the code (some remotely exploitable) that were promptly fixed. The auditor's opinion was that RetroShare's codebase lacked secure coding practice.<ref>https://www.elttam.com.au/blog/a-review-of-the-eff-secure-messaging-scorecard-pt1/</ref>

Running RetroShare through Tor enables you, to do things, which are normally potentially dangerous, such as adding random people (from a forum), while staying anonymous. (For example, to join a RetroShare forum.) This is '''not''' a recommendation, just stating a possibility. You can exchange your key on dedicated chat servers at: https://retroshare.rocks/

After adding tons of random "friends" from a public forum, connection to a very few people over TCP. <ref>Chance of working better ('''untested'''): [[Tunnel UDP over Tor]].</ref> <ref>Note, in case you are using the previous footnote, [[Security_Guide#Other_Anonymizing_Networks_over_Tor_UDP_Tunnel|Other Anonymizing Networks over Tor UDP Tunnel]] applies.</ref> Approximately only 5% were online. Although probably only a very small portion of the network could be seen, the content of the network looked pretty interesting.

RetroShare reports Right click -> DHT Details: NET WARNING No DHT; Behind NAT UNKNOWN NAT STATE MANUAL FORWARD

There still may be some privacy caveats left with RetroShare trying to communicate outside of Tor, but that doesn't matter if Whonix makes any non-Tor traffic impossible.


== Installation and Setup ==

{{Third_Party_Repository}}



''RetroShare is currently available on Debian 7.0 Wheezy and 6.0 Squeeze for armel, armhf, i386 and amd64 architectures and for 8.0 Jessie.''


Before adding the repo<ref>http://retroshare.sourceforge.net/downloads.html</ref>, fetch the key and verify<ref>http://download.opensuse.org/repositories/home:/AsamK:/RetroShare/Debian_8.0/Release.gpg</ref> fingerprints. Always check the fingerprint for yourself. The output at the moment is:

<pre>
pub  1024D/0x9418A47921691F91 2011-08-16 home:AsamK OBS Project <home:AsamK@build.opensuse.org>
      Key fingerprint = E2CE 3677 C801 5772 D097  B0AA 9418 A479 2169 1F91
</pre>

Download key with curl to home folder.

{{CodeSelect|code=
curl -o retroshare-pubkey.asc http://download.opensuse.org/repositories/home:/AsamK:/RetroShare/Debian_8.0/Release.key
}}

Check fingerprints/owners without importing anything.

{{CodeSelect|code=
gpg --with-fingerprint retroshare-pubkey.asc
}}

If it looks good import into trusted.gpg.d.<ref>To import asc key files into trusted.gpg.d they must be converted into a .gpg keychain file first.</ref>

{{CodeSelect|code=
gpg --no-default-keyring --keyring ./retroshare-pubkey.gpg --import retroshare-pubkey.asc
sudo cp retroshare-pubkey.gpg /etc/apt/trusted.gpg.d/retroshare-pubkey.gpg
}}

For stable builds:

{{CodeSelect|code=
sudo su -c "echo -e 'deb http://download.opensuse.org/repositories/home:/AsamK:/RetroShare/Debian_8.0/ /' > /etc/apt/sources.list.d/retroshare06.list"
}}

For nightly builds:

{{CodeSelect|code=
sudo su -c "echo -e 'deb http://download.opensuse.org/repositories/home:/AsamK:/RetroShare/Debian_8.0/ /' > /etc/apt/retroshare06-git.list"
}}


[[Update]] your package lists.

{{CodeSelect|code=
sudo apt-get update
}}

Install Retroshare.

{{CodeSelect|code=
sudo apt-get install retroshare06
}}


For the latest nightly package name install <code>retroshare06-git</code> instead.

<ref>
[http://retroshare.sourceforge.net/downloads.html RetroShare .deb Packages installation instructions from RetroShare's third party repository]
</ref>

RetroShare setup:

** Pick a pseudonym and password. Don't use real name or location obviously. Move your mouse to generate enough entropy.

** Check ''Advanced Options'' -> ''Create a hidden node''

** Change key-length to 4096 bits for adequate security then generate the new profile.

== Configure ==

=== I2P ===

{{Template:I2P_Retroshare}}

=== Tor ===

'''INCOMPLETE - Depends on unimplemented features for Whonix'''<ref>https://github.com/RetroShare/RetroShare/issues/356</ref>

<u>On your Whonix-Gateway.</u>

If you want to read an introduction about hidden services and to learn about about hidden service security, see [[Hidden Services]].

If you also want to run a hidden web server on the same .onion domain (nice for testing and learning Hidden Services basics), see [[Hidden Services]].

{{Open /etc/tor/torrc}}

Add. <ref>Arbitrary choice of port to avoid conflicts with custom RetroShare setups.</ref>

{{CodeSelect|code=
HiddenServiceDir /var/lib/tor/retroshare/
HiddenServicePort 7812 10.152.152.11:<Local Address port>
}}

Save.

{{Reload Tor}}

Reminder: To get your hidden service url.

{{CodeSelect|code=
sudo cat /var/lib/tor/retroshare/hostname
}}

{{
Backups_Tor_Hidden_Service_private_key
|private_key_file=/var/lib/tor/retroshare/private_key
}}

=Tox=
{{Template:Tox}}

= Pidgin =
Pidgin supports most protocols. However do not use it. It has a very bad security track record with many remotely exploitable bugs -  a result of being written in C and containing many legacy protocols. There is no reason to use it when Tor Messenger is now available.

= IRC Client HexChat =

See [[HexChat]].

= TorChat =
The concept of having a serverless and fully encrypted instant messenger based on Tor hidden services is marvelous. 

Unfortunately, since time of writing (September 2015) TorChat can not be recommended. This is because the TorChat developer currently does not respond to other people, see [https://github.com/prof7bit/TorChat/issues TorChat issues]. Communication and support is crucial for anonymity related projects. TorChat is an unofficial project. Unaffiliated with The Tor Project. A modern and maintained alternative is Ricochet IM.

In 2015 security analysis<ref>[http://kodu.ut.ee/~arnis/torchat_thesis.pdf Security Analysis of Instant Messenger TorChat]</ref> of TorChat protocol and it's Python implementation was conducted. It was found that although the design of TorChat is sound, its implementation has several flaws, which make TorChat users vulnerable to impersonation, communication confirmation and denial-of-service attacks.<ref>https://en.wikipedia.org/wiki/TorChat#Security</ref>

= Footnotes / References =

<references/>

= License =

<pre>
Whonix Chat wiki page Copyright (C) Amnesia <amnesia at boum dot org>
Whonix Chat wiki page Copyright (C) 2012 -2014 Patrick Schleizer <adrelanos@riseup.net>

This program comes with ABSOLUTELY NO WARRANTY; for details see the wiki source code.
This is free software, and you are welcome to redistribute it
under certain conditions; see the wiki source code for details.
</pre>

{{Footer}}

[[Category:Documentation]]
