{{DISPLAYTITLE:Uninstall Qubes-Whonix TemplateVMs}}
{{Header}}
{{#seo:
|description=How to uninstall Qubes-Whonix.
|image=https://www.whonix.org/w/images/5/55/Qubes-logo-icon.png
}}

= Introduction =
{{mbox
| image   = [[File:Ambox_warning_pn.svg.png|40px]]
| text    = These instructions completely remove the Qubes-Whonix TemplateVMs. 
}}


This procedure is useful before a complete re-installation of Qubes-Whonix. <ref>Or if deciding not to use Whonix at all.</ref> Note that removal or recreation of Whonix ProxyVMs (<code>sys-whonix</code>) and AppVMs (<code>anon-whonix</code>) is a separate issue. 

== Unset or Remove Whonix TemplateVM Dependencies ==

If the Whonix TemplateVM is set as the underlying template for any VMs, it cannot be uninstalled. Either:
* '''A)''' Delete the VMs that depend on the Whonix template(s): <code>Qube Manager</code> -> <code>right-click Whonix TemplateVM</code> -> <code><u>D</u>elete qube</code> ; or
* '''B)''' Unset the TemplateVM dependency using Qube Manager: 
** Create a <code>dummy template</code>. <ref>
* https://www.qubes-os.org/doc/reinstall-template/
* https://github.com/QubesOS/qubes-issues/issues/4437
</ref>

{{Qubes_Terminal}}

{{CodeSelect|code=
mkdir /var/lib/qubes/vm-templates/dummy
}}
{{CodeSelect|code=
touch /var/lib/qubes/vm-templates/dummy/{root.img,private.img}
}}
{{CodeSelect|code=
qvm-add-template dummy
}}

** Shut down the Whonix TemplateVM if currently running: <code>Qube Manager</code> -> <code>right-click Whonix TemplateVM</code> -> <code><u>S</u>hutdown qube</code>
** Set the dummy template as TemplateVM: <code>right-click VM</code> -> <code>Qube s<u>e</u>ttings</code> -> <code>Template: <dummy template></code>

The advantage of setting a dummy template as TemplateVM is being able to keep any VMs, along with the user storage contents. Note that the root storage will still be lost when uninstalling the TemplateVM, so it is safest to backup anything important first.

== Uninstall Whonix TemplateVMs ==

If the TemplateVM was customized, any changes will obviously be lost when uninstalling it; so consider backups of anything important first.

=== Whonix-Gateway ===

# Open a dom0 terminal: <code>Qubes App Launcher (blue/grey "Q")</code> -> <code>System Tools</code> -> <code>Xfce Terminal</code>
# Uninstall <u>all</u> Qubes-Whonix-Gateway template packages matching <code>qubes-template-whonix-gw*</code> <ref name=matching>
Below matching syntax such as <code>qubes-template-whonix-gw'''*'''</code> or <code>qubes-template-whonix-ws<u>*</u></code> is being used. Note the asterisk <code>*</code> at the end. This would result in uninstalling multiple template packages if they are installed such as:

* <code>qubes-template-whonix-gw</code> (Whonix 13)
* <code>qubes-template-whonix-ws</code> (Whonix 13)
* <code>qubes-template-whonix-gw-14</code> (current version of Whonix)
* <code>qubes-template-whonix-ws-14</code> (current version of Whonix)
* <code>qubes-template-whonix-gw-15</code> (future version of Whonix)
* <code>qubes-template-whonix-ws-15</code> (future version of Whonix)

This is so these instructions can have one word but still be valid for all old and future versions of Whonix. Alternatively one could avoid the matching syntax with the asterisk <code>*</code> at the end and instead choose a specific template package name from above.
</ref>: 

{{CodeSelect|code=
sudo dnf remove qubes-template-whonix-gw*
}}

Review the <code>dnf</code> confirmation output before proceeding.

=== Whonix-Workstation ===

# Open a dom0 terminal: <code>Qubes App Launcher (blue/grey "Q")</code> -> <code>System Tools</code> -> <code>Xfce Terminal</code>
# Uninstall <u>all</u> Qubes-Whonix-Workstation template packages matching <code>qubes-template-whonix-ws*</code> <ref name=matching />:
{{CodeSelect|code=
sudo dnf remove qubes-template-whonix-ws*
}}

Review the <code>dnf</code> confirmation output before proceeding.

== Remove the Whonix-Workstation DisposableVM Template ==

The <code>{{whonix-ws}}-dvm</code> domain must be manually removed.

Open a dom0 terminal.

{{CodeSelect|code=
qvm-prefs {{whonix-ws}}-dvm default_dispvm ""
}}

{{CodeSelect|code=
qvm-remove {{whonix-ws}}-dvm
}}

= Footnotes =
{{reflist|close=1}}

{{Footer}}

[[Category:Documentation]]
