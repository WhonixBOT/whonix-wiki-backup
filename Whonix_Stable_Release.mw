{{Header}}
{{#seo:
|description={{project_name}} Release Notes, {{project_name}} 15 Stable Release, {{project_name}} 15
|image=https://www.whonix.org/w/images/b/b5/Releasenots.png
}}
{{Contributor|
|status=stable
|about=About this {{Code2|{{PAGENAME}}}} Page
|difficulty=easy
|contributor=[https://forums.whonix.org/users/torjunkie torjunkie]
|support=[[Support]]
}}

= {{project_name}} 15 Changelog =

{{project_name}} 15 was released on July 1, 2019. <ref>Some fixes/changes were implemented in both {{project_name}} 14 and 15.</ref> Significantly, {{project_name}} 15 is based on the Debian buster (Debian 10) distribution which was officially released on July 6, 2019 instead of Debian stretch (Debian 9). The buster release has nearly 60,000 packages and over 62 per cent of them were updated <ref>https://www.debian.org/News/2019/20190706</ref> <ref>More than 91 per cent of the source packages included in Debian 10 are reproducible (will build bit-for-bit identical binary packages).</ref>  -- see the [https://www.debian.org/releases/stable/releasenotes official Debian 10 release notes] to learn more. 

== All Platforms ==

=== Bug Fixes ===

* Fixed file saving issues in scurl wrappers. <ref>https://phabricator.whonix.org/T899</ref> <ref>https://github.com/Whonix/scurl/pull/1</ref> <ref>A few fixes were needed, such as:
* Remove <code>--remote-name</code> and replace it with <code>--remote-name-all</code>.
* Improve download wrappers and add <code>--remote-header-name</code>.</ref>
* Fixed the partial truncation of text in Whonix Connection Wizard. <ref>https://phabricator.whonix.org/T923</ref>
* Installed cryptsetup by default so errors do not appear when using a GUI and interacting with encrypted containers. <ref>https://phabricator.whonix.org/T890</ref> <ref>For instance, an error would otherwise appear when using XFCE file manager with encrypted USBs.</ref> <ref>https://forums.whonix.org/t/have-cryptsetup-installed-by-default-in-whonix/6684/5</ref>

=== Builds ===

* Ported the build script to cowbuilder; build packages in chroot and use mmdebstrap for better security. <ref>https://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715</ref>

=== Code ===

* Modified whonixcheck so it suggests to start networking / onion-grater if it is not running. <ref>https://phabricator.whonix.org/T853</ref>
* Improved the /usr/share/sdwdate/unit_test <ref>https://phabricator.whonix.org/T712</ref> <ref>Specifically:
* Make it simpler (to split urls into chunks of 3).
* Generate average, total etc. for each pool.
* Add curl command for the failures (timeouts).</ref>
* Improved the sdwdate message Tor consensus message. <ref>https://phabricator.whonix.org/T850</ref>
* Confirmed the sanity of systemd DNS after porting to Debian buster. <ref>https://phabricator.whonix.org/T866</ref>
* Established sane built-in defaults even if configuration files are non-existing. <ref>https://phabricator.whonix.org/T503</ref> <ref>This was completed for whonix-gw-firewall, whonix-ws-firewall,  whonixcheck, sdwdate, uwt, onion-grater (Control Port Filter Proxy),  rads, open-link-confirmation, tb-starter, tb-updater and anon-ws-disable-stacked-tor.</ref>
* Updated the onion list time sources for sdwdate so that offline and unwanted onions were removed. <ref>https://github.com/TNTBOMBOM/sdwdate/commit/2985fc70625ae13aed45225b8c83592575c21a78</ref>

=== Improved Functionality and Usability ===

* Ported {{project_name}} from Debian stretch to Debian buster. <ref>https://forums.whonix.org/t/port-whonix-from-debian-stretch-to-debian-buster/7101</ref>
* Added the [https://packages.debian.org/buster/qtox qTox instant messaging application] by default. <ref>https://phabricator.whonix.org/T889</ref>
* Install [https://packages.debian.org/buster/firejail Firejail] and [https://packages.debian.org/buster/firetools Firetools] by default inside {{project_name}}. <ref>https://phabricator.whonix.org/T869</ref> <ref>https://forums.whonix.org/t/install-firejail-firetools-by-default/5363/3</ref>
* Added the [https://packages.debian.org/buster/mat2 Metadata anonymisation toolkit v2 (MAT2)] by default. <ref><blockquote>MAT2 only removes metadata from your files, it does not anonymise their content, nor can it handle watermarking, steganography, or any too custom metadata field/system.</blockquote></ref> <ref>https://phabricator.whonix.org/T885</ref> <ref>https://forums.whonix.org/t/add-mat2-to-whonix-15/6489</ref>
* Added a LUKS container GUI ([https://packages.debian.org/buster/zulucrypt-gui zulucrypt-gui]) <ref>[https://packages.debian.org/buster/zulumount-gui zulumount-gui] is also installed.</ref> by default to make management and creation of containers easy. <ref>https://phabricator.whonix.org/T769</ref> <ref>https://forums.whonix.org/t/zulucrypt-in-whonix-14/4876</ref>
* [[OnionShare]] is now installed by default for easier, anonymous sharing of files. <ref>https://phabricator.whonix.org/T595</ref> <ref>https://forums.whonix.org/t/feature-request-onionshare-support/300/7?u=patrick</ref>
* Added [https://packages.debian.org/buster/keepassxc KeePassXC] as the default Password Manager in Whonix-Workstation. <ref>https://github.com/Whonix/anon-meta-packages/commit/8d5e892d3b603bb1390d3c152f70f8b8e8bfefef</ref>
* Removed the [https://packages.debian.org/buster/ricochet-im Richochet instant messaging application] since it is no longer working in {{project_name}} 15. <ref>Primarily due to incompatibility with v3 onions.</ref> <ref>https://forums.whonix.org/t/remove-ricochet-from-whonix/5009</ref>
* [https://packages.debian.org/buster/nyx Nyx] has replaced tor-arm as the Tor controller, providing (slightly) better functionality and usability. <ref>https://forums.whonix.org/t/what-about-nyx/6380</ref> <ref>nyx is actually the same project; just the name has changed and the presentation is very similar.</ref>
* Set VLC X11 video decoding by default so it works more reliably and avoids known problems. <ref>http://phabricator.whonix.org/T798</ref>

=== Security Enhancements ===

* The [https://packages.debian.org/buster/jitterentropy-rngd Jitter RNG Daemon (jitterentropy)] is now installed by default to improve randomness if entropy on the system runs low. <ref>https://phabricator.whonix.org/T817</ref> <ref><blockquote> Using the Jitter RNG core, the rngd provides an entropy source that feeds into the Linux /dev/random device if its entropy runs low. ... Especially during boot time, when the entropy of Linux is low, the Jitter RNGd provides a source of sufficient entropy.</blockquote></ref>

== {{non_q_project_name_short}} ==

=== Bug Fixes ===

* Corrected a VirtualBox error related to guest utils not starting. <ref>https://phabricator.whonix.org/T848</ref> <ref>https://forums.whonix.org/t/failed-failed-to-start-virtualbox-guest-utils/5975/4</ref>

=== Builds ===

* Significantly reduced the size of {{non_q_project_name_short}} images using zerofree. <ref>https://forums.whonix.org/t/reducing-size-of-ova-images/5095</ref>

=== Improved Functionality and Usability ===

* Added grub-live [[Whonix_Live|{{project_name}} Live-mode]] as a default package. <ref>https://phabricator.whonix.org/T886</ref> <ref>https://github.com/Whonix/grub-default-live</ref> <ref>https://github.com/Whonix/anon-meta-packages/pull/18</ref> <ref>https://forums.whonix.org/t/installing-whonix-live-mode-in-all-distributed-images/6467</ref> <ref>This means {{non_q_project_name_short}} users can boot into live-mode out of the box, without needing to install it.</ref>
* Added a description to whonix-vbox images. <ref>https://phabricator.whonix.org/T825</ref> <ref>Such as the root password, {{project_name}} home page and so on.</ref> <ref>https://forums.whonix.org/t/add-description-to-whonix-vbox-images/5828/1</ref>
* Implemented Whonix KVM serial console support. <ref>https://forums.whonix.org/t/how-do-i-enter-the-whonix-shell-from-cli/7271</ref>

=== Security Enhancements ===

* Disabled boot devices and modified audio settings in VirtualBox Workstation and Gateway to improve security. <ref>https://phabricator.whonix.org/T782</ref> <ref>The floppy and optical settings were disabled in both the Gateway and Workstation, while the Gateway audio was also disabled.</ref>
* [https://github.com/Whonix/kloak Forked] the [https://github.com/vmonaco/kloak kloak - Keystroke Anonymization Tool] and installed it by default in {{non_q_project_name_short}}. <ref><blockquote>kloak is a privacy tool that makes keystroke biometrics less effective. This is accomplished by obfuscating the time intervals between key press and release events, which are typically used for identification. This project is experimental.</blockquote></ref> <ref>https://forums.whonix.org/t/kloak-keystroke-anonymization-tool/7089</ref>
* Improved the default kernel hardening options for better security. <ref>See recent pull requests [https://github.com/Whonix/security-misc here].</ref> <ref>https://forums.whonix.org/t/kernel-hardening/7296/9</ref> <ref>The specific changes include: <blockquote>
Kernel symbols in /proc/kallsyms are hidden to prevent malware from reading them and using them to learn more about what to attack on your system.

Kexec is disabled as it can be used for live patching of the running kernel.

The BPF JIT compiler is restricted to the root user and is hardened.

ASLR effectiveness for mmap is increased.

The ptrace system call is restricted to the root user only.

The TCP/IP stack is hardened.

This package makes some data spoofing attacks harder.

SACK is disabled as it is commonly exploited and is rarely used.

This package disables the merging of slabs of similar sizes to prevent an attacker from exploiting them.

Sanity checks, redzoning, and memory poisoning are enabled.

The kernel now panics on uncorrectable errors in ECC memory which could be exploited.

Kernel Page Table Isolation is enabled to mitigate Meltdown and increase KASLR effectiveness.

SMT is disabled as it can be used to exploit the MDS vulnerability.

All mitigations for the MDS vulnerability are enabled.

DCCP, SCTP, TIPC and RDS are blacklisted as they are rarely used and may have unknown vulnerabilities.</blockquote></ref>

== {{q_project_name}} ==

=== Bug Fixes ===

* Correctly configured {{q_project_name}} XFCE default start menu entries (whitelisted appmenus). <ref>https://phabricator.whonix.org/T883</ref>

=== Builds ===

* Created Qubes-Whonix 15 template configuration files. <ref>https://github.com/QubesOS/qubes-template-configs/pull/6/commits/d4f429669b849fc73973e2e557a24cceab47c45e</ref> <ref>https://github.com/QubesOS/qubes-builder/pull/82/commits/64a661241430c6a22ca98bb11370b2a3e3cf0e12</ref>
* Confirmed the Whonix-15-gateway template builds. <ref>https://github.com/QubesOS/qubes-issues/issues/4957</ref>

=== Improved Functionality and Usability ===

* Simplified instructions for [https://www.qubes-os.org/doc/managing-vm-kernel/#using-kernel-installed-in-the-vm VM kernel] in {{q_project_name}} by installing the same recommended Qubes packages as Qubes Debian packages. <ref>https://github.com/Whonix/qubes-whonix/commit/8d8ab41bbf9c7fa63f3e79b8511d439efe33caeb</ref> <ref>https://github.com/Whonix/qubes-whonix/commit/c08dfed97cfba369ff753b4d96755b47240fffb2</ref>
* In DisposableVMs, tb-updater / tb-starter was modified to no longer copy Tor Browser to the user home directory at first boot -- /var/cache/tb-binary is now directly used to improve startup performance. <ref>https://github.com/QubesOS/qubes-issues/issues/4918</ref> <ref>Neither are backups of Tor Browser maintained anymore; previously three backups were stored.</ref>

=== Security Enhancements ===

* Confirmed {{q_project_name}} TemplateMVs cannot upgrade in timesync-fail-closed mode. <ref>https://phabricator.whonix.org/T858</ref> <ref>timesync-fail-closed means sdwdate did not succeed yet. Networking for all but Tor and sdwdate should still be locked in this scenario.</ref>

= {{project_name}} 15 Updates = 

As {{project_name}} is now a rolling distribution, users will benefit from regular small security and usability improvements, features and bug fixes as they enter the {{project_name}} stable repository. Those will be announced here.

{{mbox
| type    = notice
| image   = [[File:Ambox_notice.png|40px|alt=Info]]
| text    = The majority of the enhancements below also also apply to {{q_project_name}}. Exceptions include: 
* [[Keystroke_Deanonymization#Kloak|kloak]]
* [[Linux_Kernel_Runtime_Guard_LKRG|Linux Kernel Runtime Guard (LKRG)]]
* [https://github.com/0xsirus/tirdad tirdad] (TCP ISN CPU Information Leak Protection)
* [https://github.com/Whonix/security-misc/blob/master/etc/default/grub.d/40_kernel_hardening.cfg Kernel Hardening through Kernel Boot Parameters]
* [https://github.com/Whonix/security-misc Strong Linux User Account Separation] / [[Dev/Permissions#Bruteforcing_Linux_User_Account_Passwords|Protection against Bruteforcing Linux User Account Passwords]]
* [[apparmor-profile-everything]] <ref>https://github.com/Whonix/apparmor-profile-everything</ref> (AppArmor for everything: APT, systemd, init, all systemd units, all applications)
* [[Hardened-kernel|hardened-kernel patch]] and [https://github.com/Whonix/hardened-kernel/blob/master/usr/share/hardened-kernel/hardened-vm-kernel configuration]

Many of these will be possible once the use of in-VM kernels is simplified and promoted in Qubes OS. <ref>https://github.com/QubesOS/qubes-issues/issues/5212</ref> <ref>https://forums.whonix.org/t/qubes-whonix-security-disadvantages-help-wanted/8581</ref>
}}

== All Platforms ==

In 2019, [[Point_Release|point releases]] were announced on 10 September, 22 and 23 November. <ref>https://forums.whonix.org/t/whonix-virtualbox-15-0-0-4-9-point-release/8076</ref> <ref>https://forums.whonix.org/t/whonix-kvm-15-0-0-4-9-point-release/8096</ref> <ref>https://forums.whonix.org/t/whonix-virtualbox-15-0-0-6-6-point-release/8524</ref> <ref>https://forums.whonix.org/t/whonix-kvm-15-0-0-7-1-point-release/8540</ref> In 2020, point releases were announced on 16 February, 27 February, 19 and 21 March. <ref>https://forums.whonix.org/t/whonix-kvm-kicksecure-15-0-0-8-7-released-a-qunatum-leap-forward/8921</ref> <ref>https://forums.whonix.org/t/whonix-virtualbox-15-0-0-8-9-point-release-vanguards-tcp-isn-leak-protection-extensive-hardening/8994</ref> <ref>https://forums.whonix.org/t/whonix-virtualbox-15-0-0-9-4-point-release/9157</ref> <ref>https://forums.whonix.org/t/qubes-whonix-15-templatevms-4-0-1-202003070901-point-release/9159</ref>

Notable changes are listed below. Note that an in-place upgrade is <u>not</u> recommended for KVM -- significant changes have been made to the host settings that require the current machines and virtual networks to be replaced with updated ones. Refer to the [[KVM]] wiki for detailed installation instructions.

=== AppArmor ===

* Implemented apparmor-profile-torbrowser improvements, see: [https://forums.whonix.org/t/why-does-the-tor-browser-apparmor-profile-have-sys-admin-sys-chroot-and-ptrace-capabilties/7409 Why does the Tor Browser AppArmor profile have sys_admin, sys_chroot and ptrace capabilities?]
* Implemented AppArmor Live Mode fixes and various enhancements. <ref>https://forums.whonix.org/t/whonix-apparmor-profiles-development-discussion/108</ref> <ref>https://forums.whonix.org/t/live-mode-etc-apparmor-d-tunables-home-d-live-mode-breaks-aa-enforce/5868</ref>
* Further development of [https://github.com/Whonix/apparmor-profile-everything apparmor-profile-everything] -- AppArmor for everything. APT, systemd, init, all systemd units, all applications. <ref>https://github.com/Whonix/apparmor-profile-everything/compare/f3140ea2153fcee68a901ef0c86d552d6fa0ec3e...ffbe4873836b7bc364f3bfee1fef56ba8fd9b0be</ref> <ref>https://github.com/Whonix/apparmor-profile-everything/compare/ffbe4873836b7bc364f3bfee1fef56ba8fd9b0be...63fdd0312a81f878d266ae9197803ccbd6bc18df</ref> <ref>More work is required such as [https://forums.whonix.org/t/multiple-boot-modes-for-better-security-persistent-user-live-user-persistent-admin-persistent-superadmin-persistent-recovery-mode/7708 multiple boot modes for better security: persistent user | live user | persistent admin | persistent superadmin | persistent recovery mode] before it is installed by default.</ref>
* Numerous apparmor profile enhancements were added.

=== Bug Fixes ===

* Fixed anon-connection-wizard truncated text.
* Fixed whonixcheck msgcollector permission errors.
* Corrected authentication failures related to Anon Connection Wizard and Whonix repository. <ref>https://github.com/Whonix/Whonix/commit/5067d7eca6cfb36b71fe62ff7f3461f87bcdb3f6</ref>
* Fixed a tb-starter bug.
* Resolved the apt-get error relating to Debian's suite value changing from 'testing' to 'stable'. <ref>https://forums.whonix.org/t/apt-get-error-e-repository-tor-https-cdn-aws-deb-debian-org-debian-security-buster-updates-inrelease-changed-its-suite-value-from-testing-to-stable/7704</ref>
* Fixed starting pkexec-based applications from start menu, such as gdebi, synaptic and gparted. <ref>https://forums.whonix.org/t/cannot-use-pkexec/8129</ref>
* Added an encrypted swap file to the system to avoid Whonix-Gateway freezing (for systems with low RAM) during the <code>apt-get dist-upgrade</code> procedure. <ref>This also creates a new encrypted swapfile with a random password on every boot.</ref> <ref>https://github.com/Whonix/swap-file-creator</ref> <ref>https://forums.whonix.org/t/swap-swap-file-whonix-gateway-freezing-during-apt-get-dist-upgrade-encrypted-swap-file-creator/8317</ref>
* Worked around a NoScript race condition that permitted JavaScript on around 30 sites in Tor Browser when the Security Slider was set to Safest. <ref>https://forums.whonix.org/t/noscript-with-security-slider-at-safest-permits-around-30-sites/8160</ref> <ref>https://github.com/Whonix/Whonix/commit/9fa062aafe9d3d8ad94aa6850225664f914174f0</ref>
* Prevented the keyboard-configuration debconf popup during <code>apt-get dist-upgrade</code>. <ref>https://forums.whonix.org/t/keyboard-configuration-debconf-popup-during-apt-get-dist-upgrade/8318</ref> <ref>https://github.com/Whonix/whonix-legacy/commit/4bb3f9a93cef7a2076a70b986aa2c34d28ae1acf</ref>
* Implemented a <code>command-not-found</code> permission fix to avoid the ''WARNING:root:could not open file '/etc/apt/sources.list''' message. <ref>https://github.com/Whonix/whonix-legacy/commit/4202681132b1f0307cc95ceb3a1ca231fe6d9b3d</ref> <ref>https://forums.whonix.org/t/command-not-found-warningcould-not-open-file-etc-apt-sources-list/7903</ref>
* Fixed the bug parsing <code>torrc.d</code> twice.
* Fixed a bug in Whonix 15.0.0.8.9 where anon-connection-wizard added %include /etc/torrc.d/95_whonix.conf to <code>/etc/tor/torrc</code> configuration file even though Whonix was already ported to %include /etc/torrc.d/
* Added <code>x11-xserver-utils</code> to <code>kicksecure-desktop-environment-essential-gui</code> to fix XFCE logout button. <ref>[https://forums.whonix.org/t/whonix-host-operating-system/3931/109 Whonix host operating system]</ref>
* Disabled <code>vm.unprivileged_userfaultfd=0</code> because it is currently broken. <ref>[https://forums.whonix.org/t/kernel-hardening/7296/406 Kernel Hardening]</ref> <ref>Reverts “Restrict the userfaultfd() syscall to root as it can make heap sprays easier.”</ref> <ref>[https://duasynt.com/blog/linux-kernel-heap-spray]</ref>
* pkexec wrapper: fixed gdebi / synaptic but at the cost of checking for passwordless sudo /etc/suders /etc/sudoers.d exceptions. <ref>[https://forums.whonix.org/t/cannot-use-pkexec/8129/53 cannot use pkexec]</ref>
* SecBrowser / i2pbrowser: no longer use firejail by default even if installed since currently not maintained by anyone in Whonix / Kicksecure.
* Fixed the i2pbrowser local browser homepage.
* Fixed an onioncircuits error report related to user permissions. <ref><blockquote>disksd[572]: failed to load module crypto: libbd_crypto.so.2: cannot open shared object file: No such file or directory</blockquote></ref> <ref>[https://forums.whonix.org/t/onion-circuits-does-not-appear-in-the-tor-control-panel/8838 onioncircuits started from tor-control-panel by running it under user debian-tor rather than root].</ref>
* Added an ENOUGH_RAM setting to swap-file-creator (1950 MB RAM default), so if there is enough RAM a swap file is not created (improving boot time). <ref>[https://forums.whonix.org/t/swap-swap-file-whonix-gateway-freezing-during-apt-get-dist-upgrade-encrypted-swap-file-creator/8317 Fix Non-Qubes-Whonix Whonix-Gateway slow boot].</ref>
* Miscellenous whonix-firewall improvements. <ref>[https://github.com/Whonix/whonix-firewall/compare/a8ceb10498b48b70110593c41dab95f11cb9c4fb...16932a004befd1b2c175648f29e6eb77c42f2cc5  fix, don’t lock down network if IPv6 isn’t available and thereby no need to firewall, apparmor profile added in complain mode].</ref>
* Various fixes for i2p inside Whonix-Workstation: <ref>https://forums.whonix.org/t/i2p-inside-whonix-workstation-broken/8610/83</ref> <ref>i2p is not yet installed by default because of this [https://forums.whonix.org/t/installation-and-fix-of-i2p-inside-whonix-workstation-by-default/8610/106 reason].</ref>
** Preparation for installation of i2p by default.
** Do not autostart <code>i2p.service</code> if installed.
** Do not autostart <code>privoxy.service</code> if installed.
** Do not autostart <code>i2p.service</code> in Qubes TemplateVM.
** Do not autostart <code>privoxy.service</code> in Qubes TemplateVM.
* first-boot-skel: fixed <code>/etc/skel/.bashrc</code> to <code>/home/user/.bashrc</code> handling if the home folder is completely empty.
* Disabled the Tor Browser security slider question at first start because it is [https://forums.whonix.org/t/broken-security-slider/8675 broken]. <ref>Also: check for noexec, remount exec and work on [https://github.com/Whonix/tb-updater/compare/224ab0e448e5c3c349e6f2518aea7d1f4ccf9c08...52933f4b607ca2e724c9f39e59576ac731bbf4a7 Qubes DispVM exec / noexec].</ref>

=== Builds ===

* Bumped base Debian packages to 10.1
* Work on [https://github.com/Whonix/hardened-kernel hardened Linux kernel for VMs and hosts]. <ref>[https://github.com/Whonix/hardened-kernel/compare/84824c97b26181a65893d7a4580bd025d4b48eaf...e21751758d643dbdb2e0a3f7b0e2407f3172dc34 Build CI builds on Travis CI]</ref> <ref>[https://forums.whonix.org/t/kernel-recompilation-for-better-hardening/7598/292 Integration with APT and packaging] is not yet complete. Help welcome!</ref>
* [https://forums.dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/t/whonix-for-arm64-raspberry-pi-rpi/1788/126 Work on fixing arm64 / RPi builds -- incomplete]. <ref>Help is welcome to finish this work.</ref>

=== Contentious Changes ===

* Tor Browser Updater (by Whonix developers): reduced old versions being kept to <code>0</code> in ''/var/cache/tb-binary''

=== Developer Notes ===

* Added anon-base-files to whonix-host-xfce-kvm-freedom.
* Added hardened-malloc to hardened-packages-dependencies-cli.
* Removed unneeded dependency live-config-systemd.
* anon-base-files:
** Do not create a home folder during postinst.
** Leave user <code>user</code> creation to Qubes.
** Fixed and actually use <code>--no-create-home</code>.

=== Documentation ===

* Documented how to use [[Recovery|recovery mode]].
* Created detailed [[Dev/Whonix_Networking|Whonix Networking Implementation Documentation]] which documents the differences with Debian networking. <ref>https://forums.whonix.org/t/whonix-networking-implementation-developer-documentation-feedback-wanted/8274</ref>
* Wrote [[Dev/VirtualBox#VirtualBox_Guest_Additions_Bugs|research notes on how to write good VirtualBox bug reports that actually have a chance of getting fixed]].
* Wrote [[Dev/VirtualBox|VirtualBox developer documentation]] on VirtualBox Licensing Issues, unavailable in Debian main and Debian backports, missing features, VirtualBox security and arguments for keeping VirtualBox Support.
* Documented [[Onion_Services#Step_3:_Configure_Onion_Services_Authentication|Onion Services Authentication]] for v3 onions.
* Researched and documented [[Dev/Entropy|entropy / randomness generation]].
* Rebranded Whonix as a research project. <ref>https://forums.whonix.org/t/whonix-experimental-for-how-long/5206/6</ref> <ref>Old: “Whonix is experimental software. Do not rely on it for strong anonymity.” New: “Whonix is a research project.”</ref>
* Added [[Vanguards|vanguards documentation]]. <ref>[https://forums.whonix.org/t/vanguards-additional-protections-for-tor-onion-services/8064/11 vanguards - Additional protections for Tor Onion Services]</ref>
* Added [[Security-misc|security-misc documentation]] of [https://github.com/Whonix/security-misc#enhances-misc-security-settings stable security features], testing security features and experimental security features.

=== Improved Functionality and Usability ===

* Disabled whonixcheck “Connecting to Tor…” and “Connected to Tor.” messages. <ref>In favor of sdwdate-gui. whonixcheck connectivity check code checks Tor as well as sdwdate. Due to slow Tor/onion speed it often times out. Improving that code is difficult, so sdwdate-gui is used instead as a solution that provides better visual feedback to users.</ref>
* Added support for OnionShare “bundled Tor”.
* Packaged str_replace for literal search and replace functions.
* Display the pulseaudio plugin by default.
* Added arc-theme, gnome-themes-extra, gnome-themes-extra-data and gtk2-engines-murrine for better visual presentation and a more modern look.
* Set SUDO_EDITOR="mousepad" if: mousepad is installed and the environment variable SUDO_EDITOR has not already been set.
* Updated Tor Browser to version 9 and later versions of this series.
* Updated Tor to version 0.4.2.6-1. <ref>tor_0.4.2.6-1~d10.buster+1_amd64.deb from deb.torproject.org</ref> <ref>[https://forums.whonix.org/t/tor-0-4-25-release-how-can-we-upgrade/8614 Tor 0.4.25 release how can we upgrade]</ref> <ref>[https://forums.whonix.org/t/onion-services-ddos-defense-tor-0-4-2-5/8644 Onion Services DDOS Defense Tor 0.4.2.5]</ref>
* Full <code>/etc/torrc.d/*.conf</code> configuration snippet drop-in folder support. <ref>[https://forums.whonix.org/t/torrc-d-is-comming/4041/72 torrc.d cleaner]</ref>
* [[Tor#Configuration_Check|anon-verify]]:
** Report extraneous Tor configuration files (files that do not end with file extension .conf).
** Ignore file names starting with dot (.) <ref>Quote Tor manual: ‘Files starting with a dot are ignored.’</ref>
** Ignore subfolders when using %include /path/to/folder <ref>Quote Tor manual: ‘Files on subfolders are ignored.’</ref>
** Fix checking of all files in <code>torrc.d</code> folders for issues.
* The Whonix build script now optionally supports installing packages from the Whonix remote repository, rather than building packages locally. <ref>https://forums.whonix.org/t/whonix-build-script-now-optionally-supports-installing-packages-from-whonix-remote-repository-rather-than-building-packages-locally/8107</ref> 
* Simplified the default sudo lecture (presenting text upon first run) so it only shows the default password for Whonix. <ref>https://forums.whonix.org/t/disable-or-change-sudo-lecture-at-frist-run-we-trust-you-have-received-the-usual-lecture-from-the-local-system-administrator-it-usually-boils-down-to-these-three-things/8323</ref> <ref>https://github.com/Whonix/anon-base-files/commit/a929f1c438a9ac2a7cc01926e30b8d210debe442</ref> <ref>https://github.com/Whonix/anon-base-files/blob/master/usr/share/derivative-base-files/sudo-default-password-lecture</ref>
* Removed the deprecated obfs3 bridges option from Anon Connection Wizard.
* Enabled serial console functionality in VirtualBox, see: [[Recovery#Serial_Console|Serial Console]]. <ref>https://forums.whonix.org/t/serial-console-in-virtualbox/8021</ref> <ref>This helps for recovery efforts and simplifies setting up the kernel boot parameters inside the VM.</ref>
* From the VirtualBox host, simplify the sending of SysRq commands to VirtualBox VMs using the <code>vboxmanage</code> command. <ref>https://forums.whonix.org/t/send-sysrq-commands-to-virtualbox-usability-helper-virtualbox-send-sysrq/8369</ref>
* [https://forums.whonix.org/t/whonix-host-operating-system/3931/88 Work towards Whonix Host operating system].
* Install gvfs by default: <ref>[https://phabricator.whonix.org/T965]</ref> <ref>[https://forums.whonix.org/t/cannot-access-encrypted-usb-drive-with-thunar-in-whonix-15/8131/10 Cannot access encrypted USB drive with Thunar in Whonix 15]</ref> <ref>[https://forums.whonix.org/t/whonix-host-operating-system/3931/109 Whonix host operating system]</ref> <ref>[https://forums.whonix.org/t/whonix-xfce-development/6213/99 Whonix XFCE Development]</ref> <ref>[https://forums.whonix.org/t/use-sudoedit-in-whonix-documentation-and-whonix-software/7599/22 Use sudoedit in Whonix documentation and Whonix software]</ref>
** Fixed access to LUKS encrypted USB drive with Thunar.
** Added gvfs to <code>kicksecure-desktop-applications-xfce</code>.
* Renamed package <code>non-qubes-vm-audio</code> to <code>non-qubes-audio</code>.
* Onion services authentication: <ref>[https://forums.whonix.org/t/onion-services-authentication/975 Onion Services Authentication]</ref>
** Created a [https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/man/anon-auth-autogen.8.ronn anon-auth-autogen(8) Tor Authenticated Onion Service Configuration Generator].
** Created a [https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/man/anon-server-to-client-install.8.ronn anon-server-to-client-install(8) Tor Authenticated Onion Service “.auth_private” file (private key) Server to Client Installer].
* No longer install [https://github.com/Whonix/serial-console-enable serial-console-enable] by default due to [https://forums.whonix.org/t/serial-console-in-virtualbox/8021/13 issues]. <ref>See also: [[Recovery#Serial_Console|Serial Console]].</ref>
* [[corridor]] -- Tor traffic whitelisting gateway and leak tester -- merged upstream changes and improved Debian host support. <ref>[https://github.com/Whonix/corridor/compare/f175fa0023801bb3101a9cb2b4a48cc3391dea24...a1e43fc0fe247685f475402ea14cdfea6536cc5e Merge upstream changes].</ref> <ref>[https://github.com/Whonix/corridor/compare/d7aee8d362bb6a4929d8faa61cc4c79985ac88fe...f175fa0023801bb3101a9cb2b4a48cc3391dea24 Improved Debian host support].</ref>
* Added usability and output enhancements to grub-live, and improved the live mode indicator systray. <ref>[https://github.com/Whonix/grub-live/compare/870da602532ae80f2049e927edbae2883fcd7270...65948f2efeddd95dc689490aabf2cd393fc63b00 Usability, output enhancements].</ref> <ref>[https://github.com/Whonix/whonix-xfce-desktop-config/compare/c6f8413c1e968a6d00e783f01f9b5d6c2d6664c1...ae1b168f48f67044a85fbbe8cf88220524856fca Added compatibility] with [[https://www.whonix.org/wiki/Security-misc#Restrict_Hardware_Information_to_Root|restrict hardware information to root]] for Live Mode Indicator Systray.</ref> <ref>[https://github.com/Whonix/whonix-xfce-desktop-config/compare/ae1b168f48f67044a85fbbe8cf88220524856fca...a6c3787381a362ddc92c1ab6a98894e28724e139 Fixed Live Mode Indicator Systray] to detect [[Whonix_Live/ro-mode-init|ro-mode-init]].</ref>
* Added packaging and other improvements to [[Hardened_Malloc|Hardened Malloc]] <ref>[https://github.com/Whonix/hardened_malloc/compare/01a64a9a899d2c32f03d55cb5a4016f7435f1794...a361a56f4d726d182c34d9e17db1c4d54650e281 Packaging enhancements, no longer depend on genmkfile, fix, use same version number as upstream (2.0)].</ref>
* Removed Whonix specificity from onion-grater. <ref>[https://github.com/Whonix/onion-grater/compare/2711bdde4d8530e4184d8a412b1905164c4bd7e3...ca0fe4bc85c436e1877e7dd43e645c5d63e667019 Remove Whonix specificity] (default config file) from onion-grater (Whitelisting filter for dangerous Tor control protocol commands).</ref>
* Added a sudo askpass wrapper for automated testing. <ref>[https://forums.whoninx.org/t/dsudo-default-password-sudo/8766 dsudo - add sudo askpass wrapper for automated testing].</ref> <ref>This means as long as the password is set to <code>changeme</code>, it is possible to use dsudo and not be asked to enter the default password.</ref>
* Added packaging and other enhancements for [[kloak]]. <ref>[https://github.com/Whonix/kloak/compare/f19cee00fd8c0851d103309096c9063c20103bb9...ad4288a320da42c74649dc352b8b93c55bfec9be Packaging enhancements, no longer depend on genmkfile, can be build using standard Debian packaging tools, apparmor enhancements].</ref>
* Refactored Qubes-Whonix network proxy setup. <ref>[https://github.com/Whonix/qubes-whonix/compare/bdf2b22394439443cba2656dec3f092846848d67...381a11cb005b1f646c90e25af3a256f19bb06e7c Refactoring /usr/lib/qubes-whonix/init/network-proxy-setup].</ref>
* Created [https://github.com/Whonix/debug-misc debug-misc]: opt-in package which enables miscellaneous debug settings for easier debugging. <ref>This replaces grub-output-verbose.</ref>
* usability-misc: 
** Added a [https://github.com/Whonix/usability-misc/compare/bd68a636e96fed2183468fa2dff11aa41077506e...b2906d2ff19252aa133bb28ae025c5e011e17a50#diff-6c843b512a028989c8d03bfca584de4c dpkg-noninteractive] wrapper script.
** Improved the speed of "apt update" processes. <ref>[https://forums.whonix.org/t/speeding-up-apt-update-with-acquire-languages-none-and-contents-deb-defaultenabled-false-its-so-much-faster/8894/2 Speeding up "apt update" with Acquire::Languages=none and Contents-deb::DefaultEnabled=false - It's so much faster!].</ref>

=== Kernel and Related Hardening ===

Significant [https://forums.whonix.org/t/kernel-hardening/7296/140 kernel] and other security hardening has been implemented; numerous enhancements have been made to [https://github.com/Whonix/security-misc security-misc]: <ref>https://github.com/Whonix/security-misc/compare/a99dfd067ac8a43bdcd779cf57b3533bdaa404fb...163e20b886f298cb9d3aca54c14f66991001b396</ref>
* Enabled kernel panic on kernel oops after boot, see: [https://forums.whonix.org/t/set-oops-panic-kernel-parameter-or-kernel-panic-on-oops-1-sysctl-for-better-security/7713 set oops=panic kernel parameter or kernel.panic_on_oops=1 sysctl for better security].
* Enabled pam_umask.so usergroups, so group permissions are the same as user permissions. <ref>By default, Debian utilizes [https://wiki.debian.org/UserPrivateGroups User Private Groups (UPG)]. Also see: /usr/share/pam-configs/usergroups-security-misc</ref>
* Removed read, write and execute access for others for all users who have home folders under folder /home. <ref>For example, this affects those running “chmod o-rwx /home/user” during package installation or an upgrade.</ref> <ref>This is only performed once for each folder in the parent /home folder, so users who wish to relax file permissions can do so. This action protects files in the user's home folder which were previously created with lax file permissions prior to the installation of this package.</ref>
* Group sudo membership is required to use <code>su</code>.
* [[Root#Passwordless_Recovery_Mode_Security_Discussion|Passwordless]], [[Recovery|recovery / emergency mode]] has been implemented.
* Lock user accounts with pam_tally2 after five failed authentication attempts are detected. <ref>See: [[Recovery#Unlock_User_Account:_Excessive_Wrong_Password_Entry_Attempts|unlock instructions]]. This means it is possible to have short, easy-to-remember, "weak" passwords for the user <code>user</code> account, while still preventing compromised non-root users from bruteforcing it.</ref>
* Fix pam_tally2 check when read-only disk boots without ro-mode-init or grub-live.
* The thunderbolt and firewire modules were blacklisted, since they can be used for Direct Memory Access (DMA) attacks.
* Every module must now be signed before being loaded; any module that is unsigned or signed with an invalid key cannot be loaded. <ref>This makes it harder to load a malicious module.</ref>
* Uncommon network protocols were blacklisted: these are rarely used and may have unknown vulnerabilities. <ref>See: /etc/modprobe.d/uncommon-network-protocols.conf</ref>
* Enabled [https://en.wikipedia.org/wiki/Input-output_memory_management_unit IOMMU].
* The SysRq key is restricted to only allow shutdowns/reboots.
* [https://forums.whonix.org/t/sysrq-magic-sysrq-key/8079 Restrict] the [[SysRq]] key so it can only be used for shutdowns and the Secure Attention Key.
* A systemd service mounts /proc with <code>hidepid=2</code> at boot, thereby preventing users from seeing each other’s processes.
* A systemd service clears System.map on boot as these contain kernel symbols that could be useful to an attacker. <ref>[https://forums.whonix.org/t/kernel-hardening/7296/130 Forum discussion].</ref>
* Remove System.map after a kernel upgrade.
* remove-system-map: use shred instead of rm.
* The kernel logs are restricted to root only.
* The BPF JIT compiler is restricted to the root user and is hardened.
* The ptrace system call is restricted to the root user only.
* Added user <code>root</code> to group sudo. This is necessary so it is still possible to login as a user in a virtual console. <ref>See: debian/security-misc.postinst</ref>
* Kernel symbols in ''/proc/kallsyms'' are hidden. This prevents malware from reading and using them to learn more about system vulnerabilities that can be attacked.
* Kexec is disabled because it can be used for live patching of the running kernel.
* Bluetooth is blacklisted to reduce the attack surface.
* Added experimental [[Security-misc#SUID_Disabling_and_Permission_Hardening|SUID Disabling and Permission Hardening]]: <ref>[https://forums.whonix.org/t/disable-suid-binaries/7706 Disable SUID Binaries]</ref> <ref>https://github.com/Whonix/anon-apps-config/compare/a6a6c2ed3c58ef5b023866a8aed4ae1996d93420...9cbfad0aa30ce2014b65d997007baa3bf26005ca#diff-44b21d78d2546f10b7f1ba806e28e1f1</ref>
** A systemd service removes SUID / GUID from non-essential binaries as these are often used in privilege escalation attacks. <ref>It is disabled by default for now during testing and can optionally be enabled by running <code>systemctl enable permission-hardening.service</code> as root.</ref>
* Enables mitigations for the L1TF (L1 Terminal Fault) vulnerability. <ref>This is interesting when using security-misc or [[Kicksecure]].</ref>
* Unconditionally enable all kernel patches for CPU bugs (spectre, meltdown, L1TF and so on) -- this might reduce performance: <ref>This is interesting when using security-misc on the host or using Kicksecure as the host operating system.</ref> <ref>[https://forums.whonix.org/t/should-all-kernel-patches-for-cpu-bugs-be-unconditionally-enabled-vs-performance-vs-applicability/7647 Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability]</ref>
** <code>spectre_v2=on</code>
** <code>spec_store_bypass_disable=on</code>
** <code>tsx=off</code>
** <code>tsx_async_abort=full,nosmt</code>
* The MSR kernel module is blacklisted to prevent CPU MSRs from being abused to write to arbitrary memory.
* Vsyscalls are disabled as they are obsolete, are at fixed addresses and are a target for ROP.
* Page allocator freelist randomization is enabled.
* The vivid kernel module is blacklisted as it is only required for testing and has been the cause of multiple vulnerabilities.
* An initramfs hook sets the sysctl values in <code>/etc/sysctl.conf</code> and <code>/etc/sysctl.d</code> before init is executed so sysctl hardening is enabled as early as possible.
* The kernel panics on oopses to prevent it from continuing to run a flawed process and to deter brute forcing.
* Improve entropy collection: <ref>[https://en.wikipedia.org/wiki/RDRAND#Reception]</ref> <ref>https://twitter.com/pid_eins/status/1149649806056280069</ref>
** Load jitterentropy_rng kernel module.
** Distrust the CPU for initial entropy at boot as it is not possible to audit, may contain weaknesses or a backdoor.
** Disable trusting RDRAND.
** <code>random.trust_cpu=off</code>
* Experimental: remount <code>/home</code>, <code>/tmp</code>, <code>/dev/shm</code> and <code>/run</code> with nosuid,nodev (default) and noexec (opt-in). To disable this, see footnote. <ref>Run “sudo touch /etc/remount-disable”. To opt-in noexec, run “sudo touch /etc/noexec” and reboot (easiest). Alternatively file <code>/usr/local/etc/remount-disable</code> or file <code>/usr/local/etc/noexec</code> could be used.</ref> <ref>[https://forums.whonix.org/t/re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707/1 (re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?]</ref> <ref>[https://forums.whonix.org/t/re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707/27 More work needed]. Help welcome!</ref>
* [https://forums.whonix.org/t/xfce4-power-manager-xfpm-power-backlight-helper-pkexec-lxsudo-popup/8764 Fix xfce4-power-manager xfpm-power-backlight-helper pkexec lxsudo popup].
* Do show lxqt-sudo password prompt if there is a sudoers exception.
* Improved pkexec wrapper logging.
* Installation fix in the case when user <code>user</code> does not exist.
* Better output if trying to login with a non-existing user.
* Add user <code>user</code> to group <code>console</code> in Whonix and Kicksecure.
* [https://forums.whonix.org/t/how-strong-do-linux-user-account-passwords-have-to-be-when-using-full-disk-encryption-fde-too/7698/19 Lock user accounts after 50 rather than 100 failed login attempts].
* Disable the busmaster bit on all PCI bridges during very early boot to avoid holes in IOMMU. <ref>GRUB_CMDLINE_LINUX="$GRUB_CMDLINE_LINUX efi=disable_early_pci_dma"</ref> <ref>https://mjg59.dreamwidth.org/54433.html</ref> <ref>https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=4444f8541dad16fefd9b8807ad1451e806ef1d94</ref>
* Only allow symlinks to be followed when outside of a world-writable sticky directory, or when the owner of the symlink and follower match, or when the directory owner matches the symlink’s owner. Prevent hardlinks from being created by users that do not have read/write access to the source file. These prevent many TOCTOU races:
** <code>fs.protected_symlinks=1</code>
** <code>fs.protected_hardlinks=1</code>
* Restrict loading TTY line disciplines to CAP_SYS_MODULE to prevent unprivileged attackers from loading vulnerable line disciplines with the TIOCSETD ioctl which has been used in exploits before. <ref>Such as [https://a13xp0p0v.github.io/2017/03/24/CVE-2017-2636.html CVE-2017-2636].</ref> <ref>https://lkml.org/lkml/2019/4/15/890</ref> <ref>Sets <code>dev.tty.ldisc_autoload=0</code></ref>
* For a full list of changes, see: https://github.com/Whonix/security-misc

=== KVM ===

* Command line control of KVM VMs is now supported. <ref>See: [[KVM#Command_Line_Interface_.28CLI.29|KVM Command Line Interface (CLI)]]</ref>
* The microphone is disabled by default.
* Switched RNG to ''/dev/urandom''
* pvspinlock is enabled.
* Fixed Whonix-Gateway firewall desktop shortcuts.
* No longer install <code>pulseaudio</code> by default on Whonix-Gateway.
* Various apparmor fixes.
* Created new apparmor profiles for bootclockrandomization, permission lockdown, and pam tally2 information.
* Ensured future compatibility for apparmor-profile-everything.
* Improved the output of remove system.map
* Fixed the KVM prepare_release script.
* Fixed the GPU tag in libvirt XML.
* Updated Tor Browser to version 9.0.1

=== Security Enhancements ===

Much stronger Linux user account isolation has been enforced in non-Qubes-Whonix: <ref>This does not yet apply to Qubes-Whonix.</ref>
* Locked and expired the root account in new Whonix builds. Existing users who upgraded are [[Root|advised]] to lock their root account. <ref>[https://github.com/QubesOS/qubes-issues/issues/2695 Qubes issue].</ref>
* Disabled root login in [[Desktop#Virtual_Consoles|virtual consoles]] by default. <ref>This is a purposeful security feature and there are no user freedom restrictions; read more [[Root|here]].</ref>
* Added a [https://forums.whonix.org/t/add-tor-browser-first-startup-popup-to-ask-whether-security-slider-should-be-set-to-safest/7591 Tor Browser first startup popup] to ask whether the security slider should be set to safest -- this was disabled in a later release due to broken functionality.
* [https://forums.whonix.org/t/anonymize-etc-machine-id/7721 Anonymized /etc/machine-id].
* anon-gpg-tweaks: disabled keyservers for improved security. <ref>See: [https://forums.whonix.org/t/gpg-recv-keys-fails-no-longer-use-keyservers-for-anything/5607 gpg --recv-keys fails / no longer use keyservers for anything].</ref>
* Enabled [https://www.debian.org/releases/buster/amd64/release-notes/ch-whats-new.en.html#apt-sandboxing APT seccomp sandboxing].
* Added more seccomp hardening.
* Enforced [https://forums.whonix.org/t/msgcollector-security-hardening/7625 msgcollector security (mount option) hardening].
* Implemented systemd unit file hardening of services maintained by Whonix.
* Tor Browser Starter (tb-starter Whonix package) hardening: implemented optional <code>--hardening / tb_hardening="true"</code> which utilizes Firejail and/or Hardened Malloc, see: [[Tor_Browser#Hardening|Tor Browser Hardening documentation]].
* Installed [https://forums.whonix.org/t/hardened-malloc/7474 Hardened Malloc] by default to ease usage (although it is not enabled by default to avoid breakage).
* Upgraded Hardened Malloc to version 2 and switched to compile with clang rather than gcc as per upstream preference.
* <code>sudoedit</code> is now used in Whonix software and documentation (rather than the <code>lxqtsudo</code> editor) for better security. <ref>https://forums.whonix.org/t/use-sudoedit-in-whonix-documentation-and-whonix-software/7599</ref> <ref>Running any editor as root is insecure. <code>sudoedit</code> copies the file to a temporary location, edits it as a normal user and then overwrites the original using <code>sudo</code>.</ref>
* Created an opt-in feature to restrict hardware information to root, see: [[Whonix-Workstation_Security_Hardening#Restrict_Hardware_Information_to_Root|Restrict Hardware Information to Root]]. <ref>https://forums.whonix.org/t/restrict-hardware-information-to-root/7329/2</ref>

Added [https://github.com/mikeperry-tor/vanguards vanguards] to protect against guard discovery and related traffic analysis attacks: <ref>[https://nvd.nist.gov/vuln/detail/CVE-2020-8516 CVE-2020-8516 Hidden Service deanonymization]</ref> <ref>[https://github.com/Whonix/anon-gw-anonymizer-config/compare/0858b072659ce4a375ba9b08b84da3d45300336a...40c48fc0414828f48c5ff9465d839458c8b35b25 enable vanguards by default]</ref> <ref>[https://github.com/Whonix/anon-meta-packages/compare/a69156fc964e0410443b89430b48c255cefc652d...7ae0f0e054f9cac9496978658fcb97b035f48ee0 install by default]</ref>
* The daemon in Tor through 0.4.1.8 and 0.4.2.x through 0.4.2.6 does not verify that a rendezvous node is known before attempting to connect to it, which might make it easier for remote attackers to discover circuit information -- [https://lists.torproject.org/pipermail/tor-dev/2020-February/014157.html vanguards fixes this].
* Use [https://packages.debian.org/buster/vanguards vanguards from packages.debian.org]

Eased installation of [[Linux_Kernel_Runtime_Guard_LKRG|Linux Kernel Runtime Guard (LKRG)]] for users of non-Qubes-Whonix, Kicksecure and Debian hosts -- <code>sudo apt install lkrg</code>: <ref>Also available in Qubes OS Debian templates and Qubes-Whonix with use of an in-VM kernel.</ref> <ref>LKRG will likely be installed by default in Whonix and Kicksecure in one of the next stable releases.</ref>
* Improves overall system security and is compatible with tirdad.
* Hardens kernel security by killing whole classes of exploits, detecting exploits and performing Linux kernel runtime integrity checking.
* Worked with LKRG upstream to fix LKRG VirtualBox host support.
* Packaging enhancements were incorporated, so any standard Debian build tool can be used. <ref>This is quick and easy. For example: “dpkg-buildpackage -b”</ref>
* Disabled the “System is clean!” message to avoid spamming dmesg and tty1.
* [https://forums.whonix.org/t/dkms-kernel-modules-lkrg-and-tirdad-fail-to-properly-recompile-on-kernel-upgrade/8931 Fixed] compilation using DKMS on kernel upgrade by adding support for make variable KERNELRELEASE (DKMS sets it).
* Auto-load LKRG after installation. <ref>Since LKRG now supports module parameters and [https://www.openwall.com/lists/lkrg-users/2020/01/25/2 VirtualBox host support], it can be automatically started after installation since it would no longer kill VirtualBox VMs running on a host.</ref>
* Upgraded LKRG to the latest upstream version (although not yet installed by default).

Other security enhancements:
* Implemented [https://forums.whonix.org/t/tcp-isn-cpu-information-leak-protection-tirdad/8552 TCP ISN CPU Information Leak Protection] to prevent [https://dl.acm.org/citation.cfm?id=1180410 de-anonymization of Tor onion services] and installed [https://github.com/Whonix/tirdad Tirdad kernel module for random ISN generation] by default. <ref>TCP ISN CPU Information Leaks can be used de-anonymize Tor onion services. tirdad fixes that.</ref> <ref>[https://bitguard.wordpress.com/2019/09/03/an-analysis-of-tcp-secure-sn-generation-in-linux-and-its-privacy-issues/ An analysis of TCP secure SN generation in Linux and its privacy issues]</ref> <ref>[https://github.com/Whonix/tirdad Tirdad kernel module for random ISN generation]</ref> <ref>Tor Project bug report: [https://trac.torproject.org/projects/tor/ticket/16659 Add research idea for Linux TCP Initial Sequence Numbers may aid correlation]</ref> <ref>Research paper: [https://dl.acm.org/citation.cfm?id=1180410 Hot or not: revealing hidden services by their clock skew]</ref> <ref>[https://phabricator.whonix.org/T543 Whonix ticket]</ref>
* [https://forums.whonix.org/t/dkms-kernel-modules-lkrg-and-tirdad-fail-to-properly-recompile-on-kernel-upgrade/8931 Fixed compilation] using DKMS on kernel upgrade by adding support for make variable KERNELRELEASE (DKMS sets it).
* [https://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592 Console lockdown]: allow members of group <code>console</code> to use console. Everyone else except members of group <code>console-unrestricted</code> are restricted from using console using ancient, unpopular login methods such as using /bin/login over networks, which might be exploitable. <ref>See CVE-2001-0797, using pam_access.</ref>
* Protect Linux user accounts against brute force attacks -- lock user accounts after 50 failed login attempts using pam_tally2.
* No longer install firejail by default because of [https://forums.whonix.org/t/tor-browser-hardening-hardened-malloc-firejail-apparmor-vs-web-fingerprint/7851/54 fingerprinting reasons].
* Prevented verbose output during boot to prevent kernel info leaks.
* Extensive security hardening and updated packages.

=== VirtualBox ===

* Upgraded VirtualBox to <code>6.1.2</code> <ref>[https://forums.whonix.org/t/please-update-whonix-vbox-guest-addition-modules/8798/3 Get VirtualBox from Debian sid and recompile for Debian buster]</ref>
* Reverted to <code>vmsvga</code> grapics controller settings due to [https://forums.whonix.org/t/black-screen-on-15-0-0-6-6-and-15-0-0-7-1/8554 issues].
* [https://forums.whonix.org/t/whonix-virtualbox-15-0-0-8-7-testers-wanted-vanguards-tcp-isn-leak-protection-extensive-hardening/8914/4 Increased] Whonix-Gateway default RAM to 1280 MB. Otherwise, VirtualBox guest additions kernel modules fail to compile.
* Current [[VirtualBox/Troubleshooting#VirtualBox_Screen_Resolution_Bug Improve|VirtualBox screen resolution situation]]:
** Functional VirtualBox VM Window → View → Virtual Screen 1 → resize to resolution
** Functional VirtualBox VM Window → View → Adjust Window Size
** A workaround to improve this situation is still required.
** Added <code>xserver-xorg-video-vmware</code> to <code>kicksecure-desktop-environment-essential-gui</code> because it is required by VirtualBox Graphics Controller VMSVGA for auto resize and resize through VirtualBox settings menu.
** Again set the VirtualBox Graphics Controller to VMSVGA (equivalent to “VirtualBox → click a VM → Settings → Display → Graphics Controller → VMSVGA → OK”). <ref>Quote [https://www.virtualbox.org/manual/ch03.html VirtualBox manual]: <blockquote>VMSVGA: Use this graphics controller to emulate a VMware SVGA graphics device. This is the default graphics controller for Linux guests.</blockquote></ref> <ref>This has better desktop resolution in CLI (virtual terminal) mode. When it was previously disabled, this led to a [https://forums.whonix.org/t/black-screen-on-15-0-0-6-6-and-15-0-0-7-1/8554 black screen] on <code>15.0.0.6.6</code> and <code>15.0.0.7.1</code>.</ref>
** Increased Whonix VirtualBox Whonix-Gateway video RAM to 128 MB since the previous assignment of only 16 MB RAM can cause resize issues.
** Updated VirtualBox and VirtualBox guest addition to <code>6.1.4</code>.

= Footnotes =
{{reflist|close=1}}

{{Footer}}

[[Category:Documentation]]
