{{Header}}
{{#seo:
|description=Development Notes about existing and new Virtualizers supported by Whonix... VirtualBox, Qemu, KVM, VMware etc...
|image=https://www.whonix.org/w/images/a/aa/Background-1126047640.jpg
}}
{{forkme}}

= Introduction =
Whonix is available for:

* [[Qubes]]
* [[KVM]]
* [[VirtualBox]]

In an ideal world, Whonix would support all Virtualization Platforms. Theoretically it could be done using [http://libvirt.org/ libvirt]. Practically libvirt is out of question. [https://www.redhat.com/archives/libvirt-users/2012-August/msg00150.html libvirt-users Does libvirt abstract each and any vm specific command?] Libvirt does not (yet) abstract some commands Whonix depends on.

= Other Virtualization Platforms =
== Introduction ==
In theory, Whonix could run inside any virtualizer, because its build scripts are very modular and extensible. In reality, Whonix has no man power to test other virtualizers. As soon as contributors join the project and maintain support for other virtualizers, support for them can most likely be easily added.

== Support Plan ==
Whonix would need a [[Contribute#Maintainer|maintainer]] to support the other virtualization platform.

Important:

* Someone who runs those [[Test]], [[LeakTests]] and tests from [[Protocol-Leak-Protection_and_Fingerprinting-Protection]].
* Someone who otherwise looks around if everything is sane.

Ideal:

* Someone who creates, signs, uploads .ova images for the other virtualization platform (such as VMware, KVM, etc.).

== Partially Finished Attempts ==
* [[QEMU]] (deprecated)
* [[VMware]] (proof of concept, no maintainer)

= VirtualBox =
== VirtualBox missing features ==
The following is non-ideal for [[Comparison_with_Others#Verifiable_Builds|verifiable builds]], because we have to convert to vdi first:

* [https://forums.virtualbox.org/viewtopic.php?f=1&t=58460 export VM using VDI instead of VMDK?]: seems not possible.
* [https://forums.virtualbox.org/viewtopic.php?f=7&t=58461 Mount VMDK on Debian jessie?]: seems not possible.

The following is non-ideal, because we can not warn when host operating systems are being used we don't think are the right tool for hosting Whonix VMs:

* [https://forums.virtualbox.org/viewtopic.php?f=1&t=58498 Can a guest find out its host operating system?]: seems not possible.

* VirtualBox uses VMDK version 3. This is non-ideal, because working with these images is difficult.
** Converting these images is difficult.
*** <s>qemu-img version 1.6.1 ({{Code|qemu-img convert "vmdk_file" -O RAW "vdi_file"}}) fails with: {{Code2|qemu-img: 'image' uses a vmdk feature which is not supported by this qemu version: VMDK version 3}}, which is a [https://bugs.launchpad.net/qemu/+bug/1253465 known issue in qemu].</s> As per [https://bugs.launchpad.net/bugs/1253465 this], QEMU version equal or bigger than {{Code2|2.8}} should be capable to work with VMDK version 3 disks. TODO: try
*** Therefore it is required to convert them with VBoxManage to .vdi first. ({{Code|VBoxManage clonehd --format VDI "vmdk_file" "vdi_file"}})
** <s>Therefore the Free guestmount doesn't support mounting VMDK version 3 as well (because it internally uses qemu-img).</s> (Still true?)
** <s>It requires proprietary software to mount them, such as the proprietary nbdkit plugin [https://github.com/libguestfs/nbdkit/blob/master/plugins/vddk/README.VDDK vddk]. We're not aware of a Free Software alternative yet.</s> (Still true?)

== VirtualBox no longer in Debian main ==
* http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=709899
* http://lists.debian.org/debian-devel/2013/08/msg00057.html
* "Virtualbox ships a BIOS that requires Watcom to compile from real sources,precompiled copy they ship as well is free but is not the preferred form for modification." http://lists.debian.org/debian-devel/2013/08/msg00106.html
* https://www.virtualbox.org/ticket/12011
* https://lists.torproject.org/pipermail/tor-talk/2013-September/029978.html

* This is unrelated to <code>VirtualBox Oracle VM VirtualBox Extension Pack</code>, which is proprietary, and which was never in Debian.

== Arguments for keeping VirtualBox Support ==
* [[KVM]] is not available to Windows users.
* Simplicity, as in: [[VirtualBox]] has a VM import GUI feature.
* <s>We have a [[Windows|Whonix Windows Installer]].</s> (Unmaintained.)
* Available to users not owning computer providing hardware virtualization. ([[KVM]] requires that. [[QEMU]] may or may not but is [[unsupported]].)
* Due to Windows users and simplicity it leads to greater popularity, which in theory attracts more users, developers, auditors, [[payments]], etc and is therefore good for the overall health of the project.
* Some Windows/[[VirtualBox]] users experimenting with their first Linux (Whonix) will one day become users who mainly use Linux as their host operating system.

== Why Use KVM Over VirtualBox? ==
See [[KVM#Why_Use_KVM_Over_VirtualBox.3F|Why Use KVM Over VirtualBox?]]

== See Also ==

* [[Advanced_Security_Guide#About_VirtualBox]]

== Misc ==
<pre>
tb.postinst as user will fail vs anon-ws maintainer script calling
bash -x /var/lib/dpkg/info/anon-ws-dns-conf
bash -x /var/lib/dpkg/info/anon-ws-dns-conf.postinst configure
use sudo and sudoers.d



whonixcheck:
sudo --non-interactive "/usr/lib/security-misc/apt-get-update" >/dev/null &
when verbose: 
sudo --non-interactive "/usr/lib/security-misc/apt-get-update" &

whonixcheck:
old: sudo --non-interactive "/usr/lib/security-misc/apt-get-update" >/dev/null &
when verbose: sudo --non-interactive "/usr/lib/security-misc/apt-get-update" &


non-persistent (lost after reboot), graphical user interface only
setxkbmap de


https://www.whonix.org/wiki/Special:Captcha/help


whonix-xfce-desktop-config package description


whonixcheck metapackage check


OK
The following packages were automatically installed and are no longer required:
  hardened-packages-recommended-cli non-qubes-vm-enhancements-gui whonix-workstation-default-applications-gui whonix-ws-desktop-shortcuts


KDE deprecated. Upgrade to XFCE supported.


timesanitycheck poinstinst error, tmpfiles.d obsolete?


whonix-repository:
cat /etc/debian_version
buster/sid


onscreen keyboard
florence at-spi2-core


onion-grater

    STATUS_SERVER:
      suppress: true


bridges


arm -> nyx pkg
arm -> nyx desktop shortcut


open gateway firewall config fails


in XFCE
touch test.txt
works: exo-open test.txt
works: sudo --set-home exo-open test.txt
fails: lxsu exo-open test.txt
fails in Qubes Debian buster (?) as well as real Debian buster


kloak resets keyboard layout in xfce gui


kloak: firewall reload results in dysfunctional keyboard?


reprepro contrib non-free

dummy-contrib / dummy-nonfree - useful for testing vrms
</pre>

<pre>
user@debian:~$ lxsu exo-open test.txt ; echo $?

0
user@debian:~$ 
</pre>

<pre>
sudo --set-home env
COLORTERM=truecolor
XAUTHORITY=/home/user/.Xauthority
LANG=en_US.utf8
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
TERM=xterm-256color
DISPLAY=:0.0
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
MAIL=/var/mail/root
LOGNAME=root
USER=root
HOME=/root
SHELL=/bin/bash
SUDO_COMMAND=/usr/bin/env
SUDO_USER=user
SUDO_UID=1000
SUDO_GID=1000
</pre>

<pre>
lxsu env

SHELL=/bin/bash
PWD=/home/user
XAUTHORITY=/home/user/.Xauthority
HOME=/root
LANG=en_US.UTF-8
DISPLAY=:0.0
SHLVL=0
PATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
MAIL=/var/mail/root
</pre>

== Misc 2 ==
VBoxManage modifyvm Whonix-Workstation-XFCE --nested-hw-virt on


https://wiki.debian.org/Wine#Installation_on_Debian_Jessie_and_newer

wine msiexec /i wine-mono-4.7.4.msi 

wine BlueStacks-Installer901001_amd64_BS4_native_84877a59e1a82e59326726fab7a7051b.exe

The entry point method could not be loaded due to Could not load file or assembly 'PresentationFramework, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. assembly:PresentationFramework, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 type:<unknown type> member:<none>


WINEARCH=win32 winecfg
wineboot --init
winetricks --unattended dotnet40 corefonts

{{Footer}}

[[Category: Design]]
