{{Header}}
{{#seo:
|description=Development Notes about existing and new Virtualizers supported by Whonix... VirtualBox, Qemu, KVM, VMware etc...
|image=https://www.whonix.org/w/images/a/aa/Background-1126047640.jpg
}}
{{forkme}}

= Introduction =
Whonix is available for:

* [[Qubes]]
* [[KVM]]
* [[VirtualBox]]

In an ideal world, Whonix would support all Virtualization Platforms. Theoretically it could be done using [http://libvirt.org/ libvirt]. Practically libvirt is out of question. [https://www.redhat.com/archives/libvirt-users/2012-August/msg00150.html libvirt-users Does libvirt abstract each and any vm specific command?] Libvirt does not (yet) abstract some commands Whonix depends on.

= Other Virtualization Platforms =
== Introduction ==
In theory, Whonix could run inside any virtualizer, because its build scripts are very modular and extensible. In reality, Whonix has no man power to test other virtualizers. As soon as contributors join the project and maintain support for other virtualizers, support for them can most likely be easily added.

== Support Plan ==
Whonix would need a [[Contribute#Maintainer|maintainer]] to support the other virtualization platform.

Important:

* Someone who runs those [[Test]], [[LeakTests]] and tests from [[Protocol-Leak-Protection_and_Fingerprinting-Protection]].
* Someone who otherwise looks around if everything is sane.

Ideal:

* Someone who creates, signs, uploads .ova images for the other virtualization platform (such as VMware, KVM, etc.).

== Partially Finished Attempts ==
* [[QEMU]] (deprecated)
* [[VMware]] (proof of concept, no maintainer)

= VirtualBox =
== VirtualBox missing features ==
The following is non-ideal for [[Comparison_with_Others#Verifiable_Builds|verifiable builds]], because we have to convert to vdi first:

* [https://forums.virtualbox.org/viewtopic.php?f=1&t=58460 export VM using VDI instead of VMDK?]: seems not possible.
* [https://forums.virtualbox.org/viewtopic.php?f=7&t=58461 Mount VMDK on Debian jessie?]: seems not possible.

The following is non-ideal, because we can not warn when host operating systems are being used we don't think are the right tool for hosting Whonix VMs:

* [https://forums.virtualbox.org/viewtopic.php?f=1&t=58498 Can a guest find out its host operating system?]: seems not possible.

* VirtualBox uses VMDK version 3. This is non-ideal, because working with these images is difficult.
** Converting these images is difficult.
*** <s>qemu-img version 1.6.1 ({{Code|qemu-img convert "vmdk_file" -O RAW "vdi_file"}}) fails with: {{Code2|qemu-img: 'image' uses a vmdk feature which is not supported by this qemu version: VMDK version 3}}, which is a [https://bugs.launchpad.net/qemu/+bug/1253465 known issue in qemu].</s> As per [https://bugs.launchpad.net/bugs/1253465 this], QEMU version equal or bigger than {{Code2|2.8}} should be capable to work with VMDK version 3 disks. TODO: try
*** Therefore it is required to convert them with VBoxManage to .vdi first. ({{Code|VBoxManage clonehd --format VDI "vmdk_file" "vdi_file"}})
** <s>Therefore the Free guestmount doesn't support mounting VMDK version 3 as well (because it internally uses qemu-img).</s> (Still true?)
** <s>It requires proprietary software to mount them, such as the proprietary nbdkit plugin [https://github.com/libguestfs/nbdkit/blob/master/plugins/vddk/README.VDDK vddk]. We're not aware of a Free Software alternative yet.</s> (Still true?)

== VirtualBox no longer in Debian main ==
* http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=709899
* http://lists.debian.org/debian-devel/2013/08/msg00057.html
* "Virtualbox ships a BIOS that requires Watcom to compile from real sources,precompiled copy they ship as well is free but is not the preferred form for modification." http://lists.debian.org/debian-devel/2013/08/msg00106.html
* https://www.virtualbox.org/ticket/12011
* https://lists.torproject.org/pipermail/tor-talk/2013-September/029978.html

* This is unrelated to <code>VirtualBox Oracle VM VirtualBox Extension Pack</code>, which is proprietary, and which was never in Debian.

== Arguments for keeping VirtualBox Support ==
* [[KVM]] is not available to Windows users.
* Simplicity, as in: [[VirtualBox]] has a VM import GUI feature.
* <s>We have a [[Windows|Whonix Windows Installer]].</s> (Unmaintained.)
* Available to users not owning computer providing hardware virtualization. ([[KVM]] requires that. [[QEMU]] may or may not but is [[unsupported]].)
* Due to Windows users and simplicity it leads to greater popularity, which in theory attracts more users, developers, auditors, [[payments]], etc and is therefore good for the overall health of the project.
* Some Windows/[[VirtualBox]] users experimenting with their first Linux (Whonix) will one day become users who mainly use Linux as their host operating system.

== Why Use KVM Over VirtualBox? ==
See [[KVM#Why_Use_KVM_Over_VirtualBox.3F|Why Use KVM Over VirtualBox?]]

== See Also ==

* [[Advanced_Security_Guide#About_VirtualBox]]

== Misc ==
<pre>
/usr/lib/gateway-shortcuts/tordata
results in

pkexec env DISPLAY=:0.0 XAUTHORITY=/home/user/.Xauthority thunar /var/lib/tor
which results in

Authentication required to run `/usr/bin/env' as the super user

An application is attempting to perform an action that requires privileges,
Authentication is required to perform this action.

Bad since it does not show the real application to be run. Therefore rather use lxsu.
</pre>

<pre>
pkexec depends on policykit-1-gnome for gui

whonixcheck::
bug: Start Menu -> Applications -> System -> Whonix Setup
fix: Start Menu -> Applications -> System -> Anon Connection Wizard

bug: or manually (If you know about the public Tor network!) and open /usr/local/etc/torrc.d/50_user.conf with root rights (Start Menu -> Applications -> System -> Torrc) and set: 
fix: or manually (If you know about the public Tor network!) and open /usr/local/etc/torrc.d/50_user.conf with root rights (Start Menu -> System -> Tor User Config) and set:


grep -r "Start Menu"



/usr/lib/anon-connection-wizard/anon-connection-wizard
sudo --non-interactive --set-home /usr/bin/anon-connection-wizard


/usr/lib/whonix-setup-wizard/whonix-setup-wizard-setup
sudo --non-interactive --set-home /usr/bin/whonix-setup-wizard setup


/usr/lib/tor-control-panel/tor-control-panel


sudoers

/usr/bin/whonix-setup-wizard setup
add: /usr/bin/whonix-setup-wizard


whonixcheck apparmor

## sudo
	/etc/shadow r,

## systemd-detect-virt
	@{PROC}/[0-9]/sched r,


/usr/bin/sdwdate-gui
xhost +


/usr/lib/gateway-shortcuts/tordata/
has no sudoers exception by default
therefore use lxsu
gui looks much saner


replace all pkexec with lxsu


sdwdate-gui and sdwdate-gui-qubes
bug:        show_konsole = ('sudo --non-interactive --set-home /usr/lib/sdwdate-gui/log-viewer')
fix:        show_konsole = ('/usr/lib/sdwdate-gui/log-viewer &')


access rights of /var/log/sdwdate.log ?
</pre>


<pre>
# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

source /etc/network/interfaces.d/*

# The loopback network interface
auto lo
iface lo inet loopback
</pre>

<pre>
	/usr/bin/bash rix,
	/usr/bin/dash rix,
	/usr/bin/rm rix,
	/usr/bin/cat rix,
	/usr/bin/mktemp rix,
	/usr/bin/ps rix,
	/usr/bin/sleep rix,
	/usr/bin/touch rix,
	/usr/bin/tee rix,
	/usr/bin/date rix,
	/usr/bin/sync rix,
	/usr/bin/tty rix,
	/usr/bin/tail rix,
	/usr/bin/mkdir rix,
	/usr/bin/chmod rix,
	/usr/bin/uname rix,
	/usr/bin/grep rix,
	/usr/bin/run-parts rix,
	/usr/bin/chown rix,
	/usr/bin/date rix,
	/usr/bin/echo rix,
	/usr/bin/touch rix,
	/usr/bin/which rix,
	/usr/bin/sed rix,
	/usr/bin/hostname rix,
	/usr/bin/tar rix,
	/usr/bin/cp rix,
	/usr/bin/dmesg rix,
	/usr/bin/systemctl rix,
	/usr/bin/journalctl rix,
	/usr/bin/readlink rix,
	/usr/bin/fuser rix,
</pre>


VBoxManage modifyvm Whonix-Workstation-XFCE --nested-hw-virt on


https://wiki.debian.org/Wine#Installation_on_Debian_Jessie_and_newer

wine msiexec /i wine-mono-4.7.4.msi 

wine BlueStacks-Installer901001_amd64_BS4_native_84877a59e1a82e59326726fab7a7051b.exe

The entry point method could not be loaded due to Could not load file or assembly 'PresentationFramework, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. assembly:PresentationFramework, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 type:<unknown type> member:<none>


WINEARCH=win32 winecfg
wineboot --init
winetricks --unattended dotnet40 corefonts

{{Footer}}

[[Category: Design]]
