{{Header}}
{{#seo:
|description=AppArmor profiles (Security Hardening) for Whonix and other Linux. TBB, Pidgin, more soon.
}}
__FORCETOC__
{{AppArmorProfileWarning}}


Credit for this AppArmor profile goes to [http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=676849 intrigeri].

Create a file /etc/apparmor.d/usr.bin.pidgin.

<pre>
kdesudo kwrite /etc/apparmor.d/usr.bin.pidgin
</pre>

Paste the following content.

<pre>
# Last Modified: Mon Apr 14 19:14:10 UTC 2014
#include <tunables/global>

/usr/bin/pidgin {
	#include <abstractions/audio>
	#include <abstractions/aspell>
	#include <abstractions/base>
	#include <abstractions/bash>
	#include <abstractions/consoles>
#	#include <abstractions/dbus>
#	#include <abstractions/dbus-session>
	#include <abstractions/fonts>
	#include <abstractions/freedesktop.org>
	#include <abstractions/gnome>
	#include <abstractions/kde>
#	#include <abstractions/nameservice>
	#include <abstractions/private-files-strict>
	#include <abstractions/user-download>
#	#include <abstractions/user-tmp>
#	#include <abstractions/ibus>
	#include <abstractions/whonix>

	capability sys_ptrace,
	
	deny / r,	
	deny /etc/fstab r,
	deny /etc/host.conf r,
	deny /etc/hosts r,
	deny /etc/nsswitch.conf r,
	deny /etc/resolv.conf r,
	deny /etc/passwd r,
	deny /etc/group r,

	deny @{HOME}/.bash* rw,
	deny @{HOME}/.cshrc rw,
	deny @{HOME}/.profile rw,
	deny @{HOME}/.zshrc rw,
	deny @{HOME}/Documents/** r,

	deny @{PROC}** r,
 
	/etc/gai.conf r,

	@{HOME}/.cache/dconf/user rw,
	@{HOME}/.config/dconf/user r,
	@{HOME}/.config/enchant/ rw,
	@{HOME}/.config/enchant/* rwk,
	@{HOME}/.local/share/icons/ r,
	@{HOME}/.local/share/mime/* r,
	@{HOME}/.gstreamer*/ rw,
	@{HOME}/.gstreamer*/** rw,
	@{HOME}/.pulse/ rw,
	@{HOME}/.pulse/** rw,
	@{HOME}/.pulse-cookie rwk,
	@{HOME}/.purple/ rw,
	@{HOME}/.purple/** rwk,
	@{HOME}/.kde/share/config/* r,
	# @{HOME}/.whonix/* rwk,

	/bin/grep rix,
	/bin/dash rix,
	/bin/uname rix,
	/bin/mkdir rix,
	/bin/rm rix,
	/{dev,run}/shm/ r,
	/{dev,run}/shm/* rw,

	/etc/ r,
	/etc/pulse/client.conf r,
	/etc/ssl/certs/ r,
	/etc/ssl/certs/** r,
	/etc/ssl/certs/ssl-cert-snakeoil.pem r,
	/etc/purple/prefs.xml r,
	# /etc/whonix.d/* r,
	 
	## Added here instead of local profile ##
	#  /etc/resolv.conf.whonix r,
	#  /etc/hosts.whonix r,
	#########################################

	owner /tmp/orbit-*/* w,
	owner /tmp/pulse-*/* w,

	/usr/bin/pidgin r,
	/usr/bin/xdg-open rmix,
	/bin/which rix,
	/usr/bin/sensible-browser rix,
	/usr/bin/zenity rix,
	/usr/bin/torbrowser rix,
	/usr/bin/basename rix,
	/usr/bin/tty rix,

	/usr/share/glib-2.0/schemas/gschemas.compiled r,

	/usr/lib/ r,
	/usr/lib/frei0r-1/*.so rm,
	/usr/lib/libvisual-*/**.so rm,
	/usr/lib/pidgin/*.so rm,
	/usr/lib/purple*/*.so rm,
	# /usr/lib/whonix/confirm_open rix,

	/usr/share/ca-certificates/*/** r,
	/usr/share/enchant/enchant.ordering r,
	/usr/share/locale-langpack/** rm,
	/usr/share/purple/ca-certs/ r,
	/usr/share/purple/ca-certs/** r,
	/usr/share/myspell/dicts/ r,
	/usr/share/myspell/dicts/** r,
	/usr/share/tcltk/** r,
	/usr/share/zenity/* r,
	/usr/share/themes/ r,
	/usr/share/themes/** r,
	/usr/share/hunspell/ r,
	/usr/share/hunspell/** r,

	# Site-specific additions and overrides. See local/README for details.
	#  #include <local/TBB.Pidgin>
}
</pre>

Run.
<pre>
sudo apparmor_parser -r /etc/apparmor.d/usr.bin.pidgin
</pre>

[https://www.whonix.org/forum/index.php?action=profile;u=24 troubadour] created this profile. You can discuss it in this [http://kkkkkkkkkk63ava6.onion/forum/index.php/topic,97.0.html forum thread].

{{Footer}}

[[Category:Documentation]]
