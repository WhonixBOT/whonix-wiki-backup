{{Header}}
{{#seo:
|description=Overview of Advanced Deanonymization Attacks and their development status in Whonix
}}

= Introduction =

This page aims to track and document advanced attacks <ref>https://phabricator.whonix.org/T540</ref> that also affect virtualized and anonymous systems like Whonix. Attacks discussed below tend to have a very high accuracy rate and can easily have devastating impacts upon anonymity. The common thread to these attacks is abuse of the underlying hardware design to undermine isolation barriers imposed by the software stack operating above it. <ref>See [http://cs.sru.edu/~mullins/cpsc100book/module02_introduction/module02-03_introduction.html Introduction to Computers: Hardware and Software] for a basic description of the difference between hardware, firmware and software.</ref> Exploiting buggy software remains the lowest hanging fruit for network adversaries. It is expected they will further expand their toolbox and more regularly utilize these vectors, since the chances of discovery are minimal to none.

= Attack Definitions = 

'''Table:''' ''Common Attack Vectors causing Data Leakage''

{| class="wikitable"
|-
! scope="col"| '''Attack Vector'''
! scope="col"| '''Description'''
|-
! scope="row"| Side Channels
| [https://en.wikipedia.org/wiki/Side_channel_attack Side channel attacks] allow a malicious process to spy on events/data outside the VM.
|-
! scope="row"| Local Covert Channels
| [https://www.techopedia.com/definition/10255/covert-channel Local covert channels] require collaboration between a malicious VM and an infected victim VM to leak confidential data.
|-
! scope="row"| Network Covert Channels
| [https://en.wikipedia.org/wiki/Covert_channel#Data_hiding_in_OSI_model Network] [https://en.wikipedia.org/wiki/Covert_channel#Data_hiding_in_LAN_environment_by_covert_channels covert] [https://en.wikipedia.org/wiki/Covert_channel#Data_hiding_in_TCP/IP_Protocol_suite_by_covert_channels channels] only require that a compromised VM induce identifiable changes in network traffic that are immediately visible to adversaries that surveil the network.
|-
! scope="row"| Biometric Tracking
| Behavioral tracking (also called biometric tracking) relies on spying on how users interact with their devices, <ref>https://www.whonix.org/blog/biometric-fingerprinting</ref> rather than looking at the unique identifiers of the device, protocol or application levels.
|}

=Attacks=
{| class="wikitable" style="text-align: center; background-color: #fff"
|- style="background-color: #f9f9f9"
| style="height: 35px;width: 170px"|
| '''CPU-induced network latency'''<ref>https://phabricator.whonix.org/T530</ref>
| '''TCP ISNs and temperature induced clock skews'''<ref>https://phabricator.whonix.org/T543</ref>
| '''DRAMA Cross-CPU attacks'''<ref>https://phabricator.whonix.org/T541</ref>
| '''Cross-VM CPU cache attacks'''<ref>https://phabricator.whonix.org/T539</ref><ref>[https://cmaurice.fr/pdf/ndss17_maurice.pdf Hello from the Other Side: SSH over Robust Cache Covert Channels in the Cloud] newer covert channel attack that needs same conditions of shared CPU cache</ref>
| '''Keyboard/Mouse input fingerprinting'''<ref>https://phabricator.whonix.org/T542</ref>
|-
| style="height: 27px;background-color: #f9f9f9"| Attack Type
| Covert Channel (network)
| Covert Channel (network)
| Covert (local) and Side Channel
| Covert (local) and Side Channel 
| Behavioral Tracking
|-
| style="height: 27px;background-color: #f9f9f9"| requires local compromise
| No
| No
| Yes
| Yes
| No
|-
| style="height: 27px;background-color: #f9f9f9"| Attack Summary
| CPU load induces notice-able latency in network packets.
| CPU load skews clock crystal frequency. Changes detectable in TCP ISN field.
| Timing shared memory bank accesses allows data leaks also snooping on keystrokes.
| Shared CPU cache access latency leaks timing data of crypto processes.
| Timing of/between keystrokes and mouse movement speed/angles create individually unique patterns.
|-
| style="height: 27px;background-color: #f9f9f9"| Mitigation
| Queue and release packets randomly with Netfilter.
| Rewrite TCP ISNs to conceal timer skews.
| Block clflush and tsc instructions. Remove all timers. Avoid multi-threading VMs. Alternatively use non-interleaved NUMA with pinned vCPUs.
| Pin vCPUs to separate pCPUs. Block tsc instructions. Remove all timers.
| Abstract keyboard/mouse input into a network layer and inject random delays.<ref>Removing fine-grained timers helps here too.</ref>
|-
| style="height: 27px;background-color: #f9f9f9"| Fix Stage - Whonix [[KVM]]
| style="background-color: {{Green}}"| Near Production
| style="background-color: {{BlueBackground}} Planning
| style="background-color: {{Green}}"| Production
| style="background-color: {{Green}}"| Production
| style="background-color: {{BlueBackground}} Planning
|-
| style="height: 27px;background-color: #f9f9f9"| Fix Stage - Whonix [[VirtualBox]]
| style="background-color: {{Green}}"| Near Production
| style="background-color: {{BlueBackground}} Planning
| style="background-color: {{Red}}"| -
| style="background-color: {{Red}}"| -
| style="background-color: {{BlueBackground}} Planning
|-
| style="height: 27px;background-color: #f9f9f9"| Fix Stage - [[Qubes-Whonix]]
| style="background-color: {{Green}}"| Near Production
| style="background-color: {{BlueBackground}} Planning
| style="background-color: {{Red}}"| -
| style="background-color: {{Red}}"| -
| style="background-color: {{BlueBackground}} Planning
|}

[[Time_Attacks|Time related attacks]] are a large class of their own, documented separately with some overlap here.

There are other advanced attacks not included in the table above but have had easy fixes such as avoiding some [[KVM#Unsafe_Features|features]] of the hypervisor.

= Development =
* [[Dev/Advanced Deanonymization Attacks]]
* ticket: [https://phabricator.whonix.org/T540 Covert Channels Meta Ticket]

= Footnotes =
{{reflist|close=1}}
{{Footer}}
[[Category:Documentation]]
