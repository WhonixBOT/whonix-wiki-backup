{{Title|title=Computer Security Mental Model}}
{{Header}}
{{#seo:
|description=Critically Important Mental Models for Computer Security, Threat Modeling
|image=https://www.whonix.org/w/images/d/d2/Mentalcomputer4801544640.png
}}
[[image:Mentalcomputer4801544640.png|thumb]]

= Threat Modeling = 

== Definition ==

Various wiki chapters reference the concept of threat modelling. Statements like "Conduct a personal threat assessment before proceeding" often appear before instructions that install additional software or change specific system configurations. Despite this warning, many users are unfamiliar with the concept or unsure how to conduct a proper assessment in their circumstances. In simple terms, threat modeling refers to: <ref name=threat_modelling1>https://www.privacyguides.org/threat-modeling/</ref> <ref>https://csrc.nist.gov/CSRC/media/Publications/sp/800-154/draft/documents/sp800_154_draft.pdf</ref>
<blockquote>A threat model is a list of the most probable threats to your security/privacy endeavors. Since itâ€™s impossible to protect yourself against every attack(er), you should focus on the most probable threats. In computer security, a threat is a potential event that could undermine your efforts to stay private and secure.

By focusing on the threats that matter to you, this narrows down your thinking about the protection you need, so you can choose the tools that are right for the job.</blockquote>

<blockquote>Threat modeling is a form of risk assessment that models aspects of the attack and defense sides of a particular logical entity, such as a piece of data, an application, a host, a system, or an environment. The fundamental principle underlying threat modeling is that there are always limited resources for security and it is necessary to determine how to use those limited resources effectively.</blockquote>

== Threat Model Examples ==

Devising a threat model requires a ''realistic'' assessment of probable threats (adversaries) and the available mitigations that are feasible to apply. Adversaries will have varying motivations, skill and resources at their disposal. The Electronic Frontier Foundation (EFF) has noted proper security planning necessitates answering five key questions to determine what should be protected, from whom, and the potential consequences of a breach: <ref>https://ssd.eff.org/en/playlist/academic-researcher</ref>

# What do I want to protect?
# Who do I want to protect it from?
# How bad are the consequences if I fail?
# How likely is it that I will need to protect it?
# How much trouble am I willing to go through to try to prevent potential consequences?

To better understand these concepts, consider these questions in further detail below.

'''Table:''' ''Threat Modeling Concepts'' <ref name=threat_modelling1 />

{| class="wikitable"
|-
! scope="col"| '''Concept'''
! scope="col"| '''Description'''
|-

! scope="row"| What I want to protect
| In terms of computing and digital security, this refers to protecting "assets" which is a type of information like browsing history, files, messages, emails, personal contacts and so on. To determine your assets, take note of what data is stored and where, who potentially has access to it, and what protections are in place to prevent unwanted access.
|-

! scope="row"| Who I am protecting it from
| Consider who might target you or your information; this is your "adversary". Potential adversaries include: family, friends or ex-partners; employers; business competition; researchers; government entities; malicious hackers; advertisers; corporations; and the IC.
|-

! scope="row"| How likely protection is required
| A proper risk assessment is required. To determine the probability of threats being actualized, consider the capabilities of adversaries and their motivation, for example: <ref>This is admittedly a subjective process which is different for every individual. Even though some risks are low, they may be unacceptable to specific people. On the other hand, some people disregard probable threats, because the consequences are assessed as inconsequential.</ref>
* Family, friends and ex-partners are likely to be unskilled and unmotivated threats.
* Advertisers and employers are generally unskilled and motivated threats.
* Some corporations are skilled, but unmotivated threats (such as a mobile device provider).
* Security researchers, other corporations (like Google and Facebook), competent hackers and law enforcement are skilled and motivated threats. They also have access to limited global resources.
* The IC are highly skilled, highly motivated and have significant global resources.
|-

! scope="row"| Impact of an adversary breach
| Skilled adversaries have multiple opportunities to access, exfiltrate, delete or corrupt data, but the motives and tactics will differ depending on the specific adversary. For example, advertisers will remain focused on highly detailed profiling, government may focus on reading private communications of journalists, the IC may seek to establish full monitoring of systems associated with political activists and so on. Consider how harmful a successful breach by an adversary would be -- what they can do with private data -- and the probability of this occurring; the likelihood obviously increases with more skilled adversaries. <ref>For example, mobile phone providers can access all phone records, unencrypted communications are vulnerable to hackers on Wi-Fi networks, and government agencies can likely backdoor any Internet-connected device.</ref>
|-

! scope="row"| Effort exerted on improved security
| Security is a process and not an end product. Every individual has different priorities, threats, resources, and capabilities. This means the "right" strategy is a balance of personal time, convenience, privacy and cost. Threat models and mitigation strategies will be very different for:
* A journalist willing to disclose whistleblower secrets, since this requires protection from government entities.
* A member of the public who is simply seeking to thwart profiling by online advertisers/global technology companies. 
* Managers protecting themselves against potential hackers employed by competitors for the purpose of corporate espionage.
|-

|}

== Threat Model Guides ==

To better protect yourself against surveillance by adversaries, it is recommended to consult the following EFF "Security Scenarios". Detailed advice is provided for various user groups regarding appropriate resources, tools and tips to mitigate potential threats: <ref>https://ssd.eff.org/en/module-categories/security-scenarios</ref>
<div style="column-count:2;-moz-column-count:2;-webkit-column-count:2">
* [https://ssd.eff.org/en/playlist/lgbtq-youth LGBTQ Youth]
* [https://ssd.eff.org/en/playlist/academic-researcher Academic researcher]
* [https://ssd.eff.org/en/playlist/human-rights-defender Human rights defender]
* [https://ssd.eff.org/en/playlist/mac-user Mac user]
* [https://ssd.eff.org/en/playlist/journalism-student Journalism student]
* [https://ssd.eff.org/en/playlist/activist-or-protester Activist or protestor]
* [https://ssd.eff.org/en/playlist/journalist-move Journalist on the move]
* [https://ssd.eff.org/en/playlist/online-security-veteran Online security veteran]
* [https://ssd.eff.org/en/playlist/want-security-starter-pack Want a security starter pack?]
</div>

To learn more about the {{project_name}} threat model, see [[Dev/Threat_Model|here]].

= Mental Model Overview =

== Introduction ==

For computer security it is crucial to have a rough overview mental model on how the computer works on a technical level that approximates how the computer is really technically functioning.

A lot of program code from various sources runs on the computer. Some from necessarily trusted <ref name=trusted>
Trusted because one has to. No trusted because one wants to trust.
</ref> vendors. Other from less trusted or untrusted sources. This is required to provide useful functionality for general computing. <ref>
In comparison to a for example classic washing machine (without internet, sophisticated, remote controls) where only trusted program code by the washing machine vendor is used to draw information on the display.
</ref>

# When a computer is fully powered off, previously has had no battery and no power cord connected, when powering on the first thing that happens is the hardware initialization which is invisible to the user.
# The first visible thing the user can see during the boot process is the BIOS. It is an essential skill that the user can visually recognize the BIOS.
# The next thing the user can see is the bootloader such as for example grub on Linux.
# Skipping intermediary steps <ref>
On Linux such as kernel initialization, initramfs or dracut, systemd, single user mode.
</ref> the next thing the most users will usually see is the operating system desktop environment.
# The hardware, BIOS is ultimately trusted. <ref name=trusted />
# The operating system is highly trusted. <ref name=trusted /> <ref>
Unless there is hardware, firmware or BIOS level malware it is always possible to replace a compromised operating system with a clean operating system.
</ref>
# Less trusted are applications such as web browsers for example, Firefox, Chrome or Tor Browser.
# Least trusted are contents shows by applications such as a website in a web browser.

Therefore it is important to know which program code (application or program) usually<ref>
Aside of compromise by malware.
</ref> has which permission to draw windows in which place.

== Threat Assessment ==

The following image is legitimate.

'''Figure:''' ''Virtual Box Virtual Machine showing {{project name}} Xfce with Tor Browser showing the duckduckgo Website''

[[File:Tor_browser_duckduckgo2.png|1200px]]

The following image is an example of a '''scam'''. It is showing the Windows operating system running the Internet Explorer application viewing the <code>systembrowsing.com</code> website.

'''Figure:''' ''<code>systembrowsing.com</code> scam popup'' <ref>
https://malwaretips.com/blogs/systembrowsing-com-removal/
</ref>

[[File:Systembrowsing-com-popup.jpg]]

With the proper mental model the <code>systembrowsing.com</code> is easily detected. That is, because <code>systembrowsing.com</code> is just a website inside the browser window. In most cases

It is important to mentally box the different parts.

* operating system: <code>Windows</code>
* application: <code>Internet Explorer</code>
* website: <code>systembrowsing.com</code> ('''scam''')

The image must not be viewed as a unified whole. Just because it is written there it does not mean it is the truth. It is just text shown on a website. The source of the message is the website. The browser is just the messenger. And the operating system, computer display the final message destination. The message is not generated by a virus scanner.

When seeing messages on websites such as saying "Warning, your computer is infected with a virus." it is very most likely a lie. It might be the case for unrelated reasons (previous malware infection) but the website will be unaware of it. The website's only permission is to show text, images or audio in the web browser. A website cannot detect viruses. <ref>
Ignoring deprecated dangerous technologies such as Internet Explorer with ActiveX.
</ref> Web browsers are web browsers, not virus scanners. A web browser is neither designed, nor supposed to scan for viruses. If that was the case, that would be well documented.

On the contrary, scam websites resorting to such tactics usually do not posses the skill to exploit vulnerabilities in web browsers or operating systems. If an attackers has such skills, they could just compromise the victim's computer. In that case, the attacker does not need to instruct the user to compromise oneself. If the user remains skeptical about such messages, researches and possibly taking independent advice before proceeding, the user will very most likely stay safe from such attacks. Many security compromises happen only because users are following instructions by attackers.

While users must trust their operating system and less so their application, they must be absolutely skeptical about everything any website is saying.

Users who do not understand this concept remain highly vulnerable to all sorts of scams.

== Best Practices ==

When seeing any information, text, audio or image shown by the computer, the user should ask oneself the following questions:

* Which program code is likely generating this message?
* Which program code is likely drawing this (part of this) window?
* Does this application have access to this information?
* How does this application have access to this information? <ref>
For example nowadays browsers can ask for permission to use the Microphone or IP addresses can be used to determine the location of a user.
</ref>

This model is not only useful to avoid scams but also to diagnose, fix issues.

Learning about the concepts documented on related wiki pages [[Social_Engineering|Social Engineering and (Spear) Phishing]], [[Hardware Wallet Security|Cryptocurrency Hardware Wallet: Threat Model]] and [[login spoofing]] might also deepen understanding of this topic.

The following image is legitimate. It is a screenshot of the ClamTK Virus Scanner.

'''Figure:''' ''ClamTK Virus Scanner'' <ref>
* https://www.whonix.org/wiki/File:ClamTk_4.30.png
* https://en.wikipedia.org/wiki/ClamTk
</ref>

[[File:ClamTk_4.30.png]]

These are real windows. The window decoration (minimize to tray, maximize, close buttons) as well as the window itself is drawn by the operating system. Responsible for the window title and content of the window is the application, ClamTK.

= Exceptions =

Some URLs in Firefox, Chrome and Tor Browser are special such as <code>about:config</code> or <code>about:preferences</code>. Content of these is not generated by websites but by the browser itself.

[https://forums.whonix.org/t/very-hard-to-notice-phishing-scam-firefox-tor-browser-url-not-showing-real-domain-name-homograph-attack-punycode/8373 very hard to notice Phishing Scam - Firefox / Tor Browser URL not showing real Domain Name - Homograph attack (Punycode)]

= Advanced Topics =

When rebooting it is in theory not guaranteed that one will see the real BIOS. It is possible that the user is only presented a fake reboot, i.e. the real operating system keeps running normally but shows a graphical simulation of a full reboot sequence. There is no confirmation that this technique has ever been deployed in practice.

= See Also =

* [[Social_Engineering|Social Engineering and (Spear) Phishing]]
* [[Hardware Wallet Security|Cryptocurrency Hardware Wallet: Threat Model]]
* [[login spoofing|Login Spoofing]]
* [[Malware]]
* [[Dev/Threat_Model|{{project_name}} Threat Model]]

= External =

<div style="column-count:2;-moz-column-count:2;-webkit-column-count:2">
* [https://www.geeksforgeeks.org/threat-modelling/ GeeksforGeeks: Threat Modelling]
* [https://csrc.nist.gov/CSRC/media/Publications/sp/800-154/draft/documents/sp800_154_draft.pdf Guide to Data-Centric System Threat Modeling]
* [https://www.linddun.org/ Linddun: privacy threat modeling methodology]
* [https://web.archive.org/web/20210711215728/https://github.com/devbret/online-opsec Online Operations Security (OpSec)]
* [https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html OWASP Cheat Sheet Series: Threat Modeling Cheat Sheet]
* [https://versprite.com/tag/pasta-threat-modeling/ PASTA Threat Modeling]
* [https://www.privacyguides.org/threat-modeling/ Privacy Guides: What are threat models?]
* [https://insights.sei.cmu.edu/blog/threat-modeling-12-available-methods/ Software Engineering Institute: Threat Modeling: 12 Available Methods]
* [https://en.wikipedia.org/wiki/STRIDE_%28security%29 STRIDE threat modeling]
* [https://www.threatmodelingmanifesto.org/ Threat Modeling Manifesto]
* https://imgs.xkcd.com/comics/authorization.png
</div>

= Footnotes =
<references />

{{Footer}}

[[Category:Documentation]]
