{{Header}}
{{#seo:
|description=Cryptocurrency Threat Model
}}
{{Title|
title=Cryptocurrency Security Threats
}}

{{stub}}

= QR codes =
When scanning QR codes in context of an air gap wallet, use a QR code scanner or camera? Such as electrum running as watch-only wallet on an online computer while electrum offline

QR code scanner is supposedly working similar to a USB keyboard, i.e. technically implemented the same way a USB keyboard is implemented. What would be more trustworthy?

= Best Protection from Theft =
brain wallet + live system

Advantage: Access to spend funds stored in a brain wallet (a cryptocurrency recovery seed phrase memorized in human memory) combined with a live system (read-only) in theory cannot be stolen by stealing any storage devices (hard drives) or by offline forensics since data is never written to such devices in the first place.

Disadvantage: Higher risk of loss (forgotten seed phrase), difficult inheritance planning, no multisig.

Related: [[Host Live Mode]].

= multisig =
To be able to restore a multisig setup every cosigner MUST backup all <u>extended public keys (<code>xpub</code>s)</u> (also known as Master Public Keys (MPKs)) of all cosigners as well as the <u>derivation path</u>. <ref>
* https://bitcoin.stackexchange.com/questions/107450/is-there-a-multisignature-scheme-that-dont-need-xpub-backups
* https://bitcointalk.org/index.php?topic=2280898.msg23146497
* https://twitter.com/_benma_/status/1229414020391800833
</ref> For example, with a quorum of 2/4 setup:

<pre>
Location 1: wallet seed 1, master pub key 2, master pub key 3, master pub key 4
Location 2: master pub key 1, wallet seed 2, master pub key 3, master pub key 4
Location 3: master pub key 1, master pub key 2, wallet seed 3, master pub key 4
Location 4: master pub key 1, master pub key 2, master pub key 3, wallet seed 4
</pre>

It is highly recommended to exercise the multisig restoration process before relying on multisig for anything except test transactions.

<blockquote>Now let's talk some multisig...</blockquote>

<blockquote>Rule #4: Verify the xpub of each hardware wallet used in a multisig quorum on the device it belongs to.

This is not 100% mandatory - but if you're no expert - you really should do it.

If a hardware wallet doesn't support displaying the xpub, (like Trezor), it could be fine to just verify each address on it - so long as you verify consistency on all other devices as well, but I wouldn't recommend such a device for non-experts.</blockquote>

<blockquote>Rule #5: Verify "receive" addresses on EVERY device of the multisig quorum.

This is especially true for at least one address (see next rule) but recommended for all. If using a device that you haven't verified the xpub of on-screen, you should verify all receive addresses on it!</blockquote>

<blockquote>Rule #6: While it is best to verify each receive addresses on ALL devices in the multisig setup - you might choose to trust a specific one, verifying the xpub/ first address on all - then the rely only on the "trusted" device - ONLY IF YOU ALSO VERIFY XPUBS...
By that, I mean verify on the "trusted" hww used for general verification, that the xpubs are consistent for all cosigners.
This is needed only once with wallets like ColdCard, Cobo Vault, Bitbox02, and Specter DIY - since they allow saving the multisig xpubs on the device.
With Trezor T - you have to verify the xpubs of cosigners every time - which is why it's not recommended for that purpose - with Trezor One it's simply not possible...

So while you might use a Trezor in a multisig, I would not recommend it to non-experts.</blockquote>

<blockquote>Rule #7: Do NOT use Ledger in a multisig setup! (unless you are an expert or have a very good reason...)

Ledger currently does not allow verifying multisig addresses on the device - nor displaying the XPUB on its screen.
This means you have no way to verify it was not swapped by an attacker in your multisig setup - EVEN IF YOU DO A SUCCESSFUL TEST TRANSACTION!

It is still possible for a (very) sophisticated attacker to make you think it worked, while it was him signing for you...</blockquote>

<blockquote>Rule #8: For convenience, you may print out/ write down a large batch of your receiving addresses - verify all at the same time, and rely on that paper list for your day to day verification.
This is very useful for multisig! - where devices might be distributed in various places.</blockquote>

<blockquote>Rule #9: Multisig change verification should be the same as with Rule #3 - on the device at the time of signing.

Popular devices (besides Ledger as said), can verify that the address you send from and the change address used belong to the same multisig wallet (from same xpubs).
If they fail to verify the change address - they will show it as a standard, independent, recipient - in that case YOU SHOULD NOT MAKE THE TRANSACTION.
This is valid for both single sig and multisig! (although even more relevant for the latter).</blockquote>

<blockquote>Please note: Some things here might not be fully accurate for the expert user (especially around multisig address verification), but for the less advanced users' sake, I have tried to be on the safe side when things get tricky...
That said, if you see inaccuracies or mistakes (or just have questions), please comment!!

Also check out some more info on multisig setups over at:
https://btcguide.github.io  ( [https://twitter.com/mflaxman @mflaxman] guide)</blockquote>

= Other Institutional Level Security Features =

- spend timelocks
- spend limits
- spend whitelists

= Further Reading =
<div style="column-count:2;-moz-column-count:2;-webkit-column-count:2">

* [[Hardware_Wallet_Security|Cryptocurrency Hardware Wallet: Threat Model]]
* [[Social_Engineering|Social Engineering and (Spear) Phishing]]
* [[Bitcoin]]
* [[Electrum]]
* [[Monero]]
* [[Ethereum]]
* [[Money]]
</div>

= Footnotes =
{{reflist|close=1}}

{{Footer}}

[[Category:Documentation]]
