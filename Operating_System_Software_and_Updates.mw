{{Header}}
{{#seo:
|description=Operating System Software and Updates
|og:image=https://www.whonix.org/w/images/3/34/Operatingsystemupdated234234.jpg
}}

= End-of-life Software =
{{End of life software}}

= Installing Additional Software =

See [[Install Software]].

{{Anchor|Recommendation to install latest security updates on all systems}}
= Updates =
{{mbox
| image   = [[File:Ambox_warning_pn.svg.png|40px]]
| text       = '''All packages must stay up-to-date for security and anonymity purposes.'''
}}

* '''[[Qubes|Qubes Whonix]]:''' Follow the [[Qubes/Update|Qubes-Whonix Update Guide]].
* '''All other Whonix OS builds:''' Follow the update instructions below.

== Standard Upgrade vs Release Upgrade ==

This procedure is for every day upgrading of Non-Qubes-Whonix and will not perform a [[Release Upgrade]].

{{Release Upgrade}}

Before applying a release upgrade, it is useful to first complete a standard upgrade as documented below.

== Standard Upgrade Steps ==

{{Operating_System_Updates}}

= Non-functional Onion Services =

Often or even for extended periods the Debian, Whonix or Qubes onion servers are non-functional, meaning users cannot complete updates automatically. In that case, an error message like the following will appear.

<pre>
user@host:~$ sudo apt-get update
Hit:1 http://security.debian.org stretch/updates InRelease
Hit:2 tor+http://deb.dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion stretch InRelease
Ign:3 http://ftp.us.debian.org/debian stretch InRelease
Hit:4 http://deb.whonix.org stretch InRelease
Hit:5 http://ftp.us.debian.org/debian stretch Release
Err:7 tor+http://sgvtcaew4bxjd7ln.onion stretch/updates InRelease
SOCKS proxy socks5h://localhost:9050 could not connect to sgvtcaew4bxjd7ln.onion (0.0.0.0:0) due to: Host unreachable (6)
Err:8 tor+http://vwakviie2ienjx6t.onion/debian stretch InRelease
SOCKS proxy socks5h://localhost:9050 could not connect to vwakviie2ienjx6t.onion (0.0.0.0:0) due to: Host unreachable (6)
Reading package listsâ€¦ Done
W: Failed to fetch tor+http://sgvtcaew4bxjd7ln.onion/dists/stretch/updates/InRelease SOCKS proxy socks5h://localhost:9050 could not connect to sgvtcaew4bxjd7ln.onion (0.0.0.0:0) due to: Host unreachable (6)
W: Failed to fetch tor+http://vwakviie2ienjx6t.onion/debian/dists/stretch/InRelease SOCKS proxy socks5h://localhost:9050 could not connect to vwakviie2ienjx6t.onion (0.0.0.0:0) due to: Host unreachable (6)
W: Some index files failed to download. They have been ignored, or old ones used instead.
</pre>

To circumvent this issue until the onion service is re-established, complete the following steps in Whonix-Gateway (<code>whonix-gw-14</code>) and Whonix-Workstation (<code>whonix-ws-14</code>). <ref>If similar problems are experienced with Whonix or Qubes onion services then the same procedure can be used to modify the <code>whonix.list</code> and <code>qubes-r4.list</code> files, respectively.</ref> <ref>http://forums.dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/t/errors-updating-september-2018/6028</ref>

'''1.''' Open Debian sources.list in an editor.

{{Open with root rights|filename=
/etc/apt/sources.list.d/debian.list
}}

'''2.''' Comment (#) the lines with the .onion address and uncomment the lines with the clearnet address. 

The first two code blocks should look like this. Note: only blocks shown need to be edited.

<pre>
#deb tor+http://sgvtcaew4bxjd7ln.onion stretch/updates main contrib non-free
deb http://security.debian.org stretch/updates main contrib non-free

#deb tor+http://vwakviie2ienjx6t.onion/debian stretch main contrib non-free
deb http://ftp.us.debian.org/debian stretch main contrib non-free
</pre>

Save and exit.

'''3.''' Confirm the clearnet repositories are functional.

{{CodeSelect|code=
sudo apt-get update
}}

'''4.''' Revert and update the package lists.

It is recommended that these changes are reverted at a later time, so users benefit from the security advantages of onion repositories. Afterwards, apply [[#Updates|Updates]] to refresh the package lists.

= Updating with Extra Care =

See [[Install_Software#How-to:_Install_or_Update_with_Utmost_Caution|How-to: Install or Update with Utmost Caution]].

= Footnotes =
{{reflist|close=1}}

{{Footer}}

[[Category:Documentation]]
