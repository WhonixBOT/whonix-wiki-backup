{{Header}}
{{#seo:
|description=Operating System Software and Updates
|image=https://www.whonix.org/w/images/3/34/Operatingsystemupdated234234.jpg
}}

= apt security update - DSA 4371-1 =
{{mbox
| image   = [[File:Ambox_warning_pn.svg.png|40px]]
| text    = '''Special instructions required to update because of apt security update [DSA 4371-1]!'''
}}


Using [[Onionizing Repositories|onion sources]] may or may <u>not</u> protect from this vulnerability. <ref>
[https://lists.debian.org/debian-security-announce/2019/msg00010.html Debian's security announcement] does not mention [https://onion.torproject.org Debian onion sources]. Redirects might also be used by onion mirrors. Debian has to the knowledge of Whonix not released information where Debian onion sources are hosted. Onion sources are also just a mirror. And mirrors may also be in a position to attempt a [[Warning#Man-in-the-middle_Attacks|man-in-the-middle attack]].
</ref> The special instructions below should be safe.

'''1)''' Move <code>/etc/apt/sources.list.d/debian.list</code> to a temporary location.

{{CodeSelect|code=
sudo mv /etc/apt/sources.list.d/debian.list /etc/apt/debian.list
}}

'''2)''' Create the apt sources list that works without redirections.

{{CodeSelect|code=
echo "deb http://cdn-fastly.deb.debian.org/debian-security stable/updates main" {{!}} sudo tee /etc/apt/sources.list.d/debian.list
}}

'''3)''' Securely update the package lists using <code>-o Acquire::http::AllowRedirect=false</code> workaround.

{{CodeSelect|code=
sudo apt-get -o Acquire::http::AllowRedirect=false update
}}

'''4)''' Securely upgrade apt-get using <code>-o Acquire::http::AllowRedirect=false</code> workaround.

{{CodeSelect|code=
sudo apt-get -o Acquire::http::AllowRedirect=false upgrade
}}

'''5)''' Delete temporary <code>/etc/apt/sources.list.d/debian.list</code>.

{{CodeSelect|code=
sudo rm /etc/apt/sources.list.d/debian.list
}}

'''6)''' Restore original <code>/etc/apt/sources.list.d/debian.list</code>.

{{CodeSelect|code=
sudo mv /etc/apt/debian.list /etc/apt/sources.list.d/debian.list
}}

'''7)''' Continue with [[Operating_System_Software_and_Updates#Standard_Upgrade_Steps|Standard Upgrade Steps]].

'''8)''' The process is now complete.

Forum discussion:<br />
https://forums.whonix.org/t/special-instructions-required-to-securely-update-because-of-apt-security-update-dsa-4371-1/6721

= End-of-life Software =
{{End of life software}}

= Installing Additional Software =
See [[Install Software]].

{{Anchor|Recommendation to install latest security updates on all systems}}
= Updates =
{{mbox
| image   = [[File:Ambox_warning_pn.svg.png|40px]]
| text    = '''All packages must stay up-to-date for security and anonymity purposes.'''
}}

* '''[[Qubes|Qubes Whonix]]:''' Follow the [[Qubes/Update|Qubes-Whonix Update Guide]].
* '''All other Whonix OS builds:''' Follow the update instructions below.

== Standard Upgrade vs Release Upgrade ==

This procedure is for every day upgrading of Non-Qubes-Whonix and will not perform a [[Release Upgrade]].

{{Release Upgrade}}

Before applying a release upgrade, it is useful to first complete a standard upgrade as documented below.

== Standard Upgrade Steps ==

{{Operating_System_Updates}}

= Non-functional Onion Services =
{{Non-functional Onion Services}}

= Updating with Extra Care =
See [[Install_Software#How-to:_Install_or_Update_with_Utmost_Caution|How-to: Install or Update with Utmost Caution]].

= Footnotes =
{{reflist|close=1}}

{{Footer}}

[[Category:Documentation]]
